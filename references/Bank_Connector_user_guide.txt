Bank Connector user guide
Trax

Exported on 05/15/2025

Trax – Bank Connector user guide

Table of Contents
1

Introduction .....................................................................................................20

2

Legal Notices ..................................................................................................21

2.1

Copyright Notice .............................................................................................21

2.2

Confidentiality Statement...............................................................................21

2.3

Disclaimer........................................................................................................21

2.4

Registered Trademarks and Proprietary names ...........................................21

3

Technical requirements..................................................................................22

3.1

General architecture .......................................................................................22

3.2

Definitions .......................................................................................................23

3.3

Disclaimer........................................................................................................23

3.4

Bank Connector server ...................................................................................23

3.4.1

Application Server (Mandatory) .....................................................................23

3.4.1.1 Software ..........................................................................................................23
3.4.1.2 Operating System ...........................................................................................24
3.4.1.3 Java .................................................................................................................24
3.4.1.4 Hardware .........................................................................................................25
3.4.1.5 Virtualized Server Environments....................................................................25
3.4.2

Database Server (Mandatory) ........................................................................25

3.4.2.1 Software ..........................................................................................................25
3.4.2.2 Hardware .........................................................................................................26
3.4.3

Supported deployments .................................................................................26

3.4.4

Sizing ...............................................................................................................26

3.4.4.1 Application server ...........................................................................................27
3.4.4.2 Database .........................................................................................................27
3.4.5

Applicability of the sizing recommendations................................................27

3.4.6

User authentication and authorization ..........................................................27

3.4.7

Firewall ............................................................................................................28

2

Trax – Bank Connector user guide

3.4.8

Communication partners (Optional) ..............................................................28

3.4.8.1 Queue based communication ........................................................................28
3.4.8.2 PGP cryptography ...........................................................................................29
3.4.9

Third-party software .......................................................................................29

3.4.10

Open Source Software in Bank Connector ....................................................30

3.5

Supported software ........................................................................................30

3.5.1

Support levels..................................................................................................30

3.5.2

Bank Connector server ...................................................................................31

3.5.2.1 Application server software ...........................................................................31
3.5.2.2 Application server operating system .............................................................32
3.5.2.3 Application server virtualized server environments......................................32
3.5.2.4 Database Server Software..............................................................................32
3.5.2.5 SAML 2.0 identity providers ...........................................................................33
3.5.2.6 Queue-based communication ........................................................................33
3.5.2.7 PGP encryption software................................................................................33
3.5.2.8 Trax ..................................................................................................................34
3.5.3

Bank Connector desktop client ......................................................................34

3.5.3.1 Web Browser ...................................................................................................34
4

Installation.......................................................................................................35

4.1

Installing Bank Connector ..............................................................................35

4.1.1

Prequisites.......................................................................................................35

4.1.1.1 Custom HTTPS keystore ................................................................................35
4.1.1.2 SQL server .......................................................................................................35
4.1.1.3 Artemis 2.17 ....................................................................................................35
4.1.2

Windows installer............................................................................................35

4.1.2.1 GUI interface installation ................................................................................36
4.1.2.2 Command line installation with Configuration File.......................................36
4.1.3

Linux installer ..................................................................................................37

4.1.3.1 GUI interface installation ................................................................................37

3

Trax – Bank Connector user guide

4.1.3.2 Command line installation with Configuration File.......................................37
4.2

Upgrading Bank Connector ............................................................................38

4.2.1

Which version? ................................................................................................38

4.2.2

Steps ................................................................................................................38

4.2.3

The upgrade process ......................................................................................39

4.3

Installation parameters ..................................................................................40

4.3.1

General parameters ........................................................................................40

4.3.2

HTTPS keystore settings................................................................................41

4.3.2.1 SSO SAML Configuration ...............................................................................41
4.3.3

Application Server (WildFly) ...........................................................................42

4.3.4

Database connection details..........................................................................45

4.3.5

FIS Payment Hub integration .........................................................................45

4.3.6

Bank Connector directories............................................................................46

4.3.7

Services ...........................................................................................................47

5

Single Sign-on (SSO).......................................................................................49

5.1

IDP and Bank Connector configuration .........................................................49

5.1.1

Profiles.............................................................................................................49

5.1.2

Identity Provider Configuration ......................................................................50

5.1.2.1 Set up a Bank Connector service provider ....................................................50
5.1.2.2 Add a custom user property "Profiles" ..........................................................52
5.1.3

Bank Connector configuration .......................................................................52

5.1.3.1 Download the Entity Descriptor metadata file from your Identity Provider.52
5.1.3.2 Modify the SAML.properties file ....................................................................53
5.1.4

Signatures, encryption, X509 certificates, and private keys.........................56

5.1.5

Identity provider-initiated SSO........................................................................56

5.1.6

SLO – LogoutRequest – Force authentication .............................................56

5.2

Configuring Azure AD .....................................................................................57

5.2.1

Add Bank Connector as an Enterprise application .......................................57

5.2.2

Assign Bank Connector profiles to users......................................................60

4

Trax – Bank Connector user guide

5.2.3

Set up SSO with SAML....................................................................................64

5.2.4

Add profiles to SAML response attributes ....................................................65

5.3

Configuring Okta .............................................................................................67

5.3.1

Add an application ..........................................................................................67

5.3.2

Edit General App Settings...............................................................................68

5.3.3

SAML Settings.................................................................................................69

5.3.4

Add a Custom Attribute and set it to user.Role ............................................70

5.3.5

Edit the user's Profile ......................................................................................70

5.3.6

Profile Editor....................................................................................................71

5.4

Configuring FIS Infinity IdP.............................................................................72

5.4.1

Add a custom property Profiles to the user definition .................................72

5.4.2

Link the custom field Profiles to a new assertion attribute profiles............73

5.4.3

Sample SAML 2.0 response ...........................................................................74

6

Channel management ....................................................................................76

6.1

Concepts .........................................................................................................76

6.2

Structure of the channel configuration..........................................................77

6.2.1

Structure of the Channel configuration .........................................................77

6.2.1.1 TEMPLATES folder .........................................................................................77
6.2.1.2 Channel configuration file structure ..............................................................79
6.2.1.3 Structure of the configuration file..................................................................80
6.2.2

Viewing the channel configuration details and history ................................80

6.3

Importing and exporting channel configuration ...........................................81

6.3.1

Importing and exporting channel configuration ...........................................81

6.3.1.1 Exporting channel configuration....................................................................82
6.3.1.2 Importing channel configuration....................................................................82
6.3.1.3 Troubleshooting..............................................................................................83
6.3.2

Importing certificates and keystores.............................................................84

6.4

Change approval on channel configuration ..................................................85

6.5

Stopping and starting channels .....................................................................86

5

Trax – Bank Connector user guide

6.6

Channel downtime ..........................................................................................88

6.6.1

Downtime of Swift and the two FIS Swift Service Bureaus..........................88

6.6.2

Configuration of channel downtime ..............................................................88

6.6.2.1 scheduler-config.yml ......................................................................................90
6.6.3

Monitoring the channel downtime activity ....................................................91

6.7

Validation of channel configuration ..............................................................91

6.7.1

FIN profile validation.......................................................................................92

6.7.2

FIN route config validation .............................................................................94

6.7.3

FileAct profile validation.................................................................................95

6.7.4

FileAct route config validation .......................................................................96

6.7.5

Sample file.......................................................................................................97

6.7.6

Troubleshooting errors ...................................................................................98

7

Trax connection ..............................................................................................99

7.1

Configuration in Bank Connector...................................................................99

7.1.1

trax-config.yml file ..........................................................................................99

7.1.1.1 sourceconnection - outgoing ...................................................................... 100
7.1.1.2 outgoingresponse - outgoing ...................................................................... 101
7.1.1.3 targetconnection - incoming ....................................................................... 103
7.1.1.4 List of target profiles ................................................................................... 104
7.1.2

Response subscriptions .............................................................................. 104

7.1.2.1 Default response subscriptions .................................................................. 104
7.1.2.2 Common examples of custom response subscriptions ........................... 107
7.2

Configuration in Trax ................................................................................... 113

7.2.1

The BankConnector integration channel .................................................... 113

7.2.1.1 Outgoing profiles ......................................................................................... 115
7.2.1.2 Incoming profiles ......................................................................................... 117
7.2.2

Additional routing parameters .................................................................... 120

8

ERP connections .......................................................................................... 122

8.1

Scope ............................................................................................................ 122

6

Trax – Bank Connector user guide

8.2

Supported message formats ...................................................................... 122

8.2.1

Swift FIN messaging service....................................................................... 122

8.2.2

Swift FileAct messaging service................................................................. 122

8.2.3

Swift FINplus messaging service................................................................ 122

8.2.4

Bank APIs ..................................................................................................... 123

8.2.5

Bank H2H connections ................................................................................ 123

8.3

ERP connection details................................................................................ 123

8.3.1

SFTP connection details.............................................................................. 123

8.3.1.1 Securing the AFT / SFTP connection ......................................................... 125
8.3.2

Shared drive connection details.................................................................. 126

8.3.2.1 Securing the shared drive connection ........................................................ 127
8.3.3

Setting the reception directory polling frequency...................................... 128

8.3.4

Assigning a targetprofile to an outgoing message based on the
filename........................................................................................................ 128

8.3.5

Defining the filename for incoming messages .......................................... 128

9

Swift connections ........................................................................................ 130

9.1

FileAct........................................................................................................... 130

9.1.1

Scope ............................................................................................................ 130

9.1.2

Supported message formats ...................................................................... 130

9.1.2.1 XMLv2 message format .............................................................................. 130
9.1.3

FileAct connections ..................................................................................... 133

9.1.3.1 FileAct general settings ............................................................................... 134
9.1.3.2 SFTP / AFT connection details ................................................................... 134
9.1.3.3 SOAP connection details............................................................................. 142
9.1.3.4 Automatic retry on outgoing messages ..................................................... 143
9.1.4

FileAct outgoing flow................................................................................... 144

9.1.4.1 Setting up outgoing routing......................................................................... 144
9.1.5

FileAct incoming flow .................................................................................. 149

9.1.5.1 Setting up incoming routing ........................................................................ 149

7

Trax – Bank Connector user guide

9.2

FIN................................................................................................................. 153

9.2.1

Scope ............................................................................................................ 153

9.2.2

Supported message formats ...................................................................... 153

9.2.2.1 MQ-MT message format ............................................................................. 153
9.2.2.2 RJE message format ................................................................................... 155
9.2.2.3 XMLv2 message format .............................................................................. 157
9.2.3

Supported connection methods ................................................................. 162

9.2.4

FIN connections ........................................................................................... 162

9.2.4.1 MQHA connection details ........................................................................... 162
9.2.4.2 SFTP / AFT connection details ................................................................... 165
9.2.4.3 SOAP connection details............................................................................. 168
9.2.4.4 Automatic retry on outgoing messages ..................................................... 170
9.2.5

FIN outgoing flow......................................................................................... 171

9.2.5.1 Setting up outgoing routing......................................................................... 171
9.2.6

FIN incoming flow........................................................................................ 176

9.2.6.1 Setting up incoming routing ........................................................................ 176
9.3

FINplus.......................................................................................................... 178

9.3.1

Scope ............................................................................................................ 178

9.3.2

Supported message formats ...................................................................... 178

9.3.3

FINplus connections .................................................................................... 182

9.3.3.1 FINplus general settings.............................................................................. 182
9.3.3.2 SFTP / AFT connection details ................................................................... 183
9.3.3.3 SOAP connection details............................................................................. 186
9.3.3.4 Automatic retry on outgoing messages ..................................................... 188
9.3.4

FINplus outgoing flow ................................................................................. 188

9.3.4.1 FINplus profiles ............................................................................................ 192
9.3.4.2 FINplus profile validation............................................................................. 196
9.3.5

FINplus incoming flow................................................................................. 198

9.3.5.1 Setting up incoming routing ........................................................................ 198

8

Trax – Bank Connector user guide

9.4

Local Authentication and LAU key .............................................................. 200

9.4.1

LAU key......................................................................................................... 200

9.4.1.1 LAU key settings .......................................................................................... 200
9.4.1.2 Configuration................................................................................................ 201
9.5

Routing Swift response messages to the backend application................ 207

9.5.1

Types of response messages ..................................................................... 208

9.5.2

Configuring subscriptions ........................................................................... 209

9.5.2.1 Default subscriptions................................................................................... 210
9.5.2.2 Defining custom subscriptions ................................................................... 211
9.5.2.3 Setting up more than 1 set of subscription................................................ 212
10

EBICS connection......................................................................................... 215

10.1

Managing bank servers and customers ..................................................... 215

10.1.1

Configure the bank server connection details ........................................... 215

10.1.2

Exchanging the bank's public certificates .................................................. 217

10.1.3

Configure the customer details................................................................... 218

10.2

Managing users ........................................................................................... 219

10.2.1

Setting up EBICS users ................................................................................ 219

10.2.2

Authenticating the EBICS user with the bank............................................. 220

10.2.3

Authenticating the EBICS user with the bank when using a 3SKey token.221

10.2.3.1 Bank Connector prerequisites..................................................................... 221
10.2.3.2 Trax prerequisites ........................................................................................ 222
10.2.3.3 Actions in Trax ............................................................................................. 223
10.2.3.4 Actions in Bank Connector.......................................................................... 225
10.2.4

Other actions on users ................................................................................ 226

10.2.5

Changing the key length and key password length ................................... 227

10.2.6

Troubleshooting........................................................................................... 227

10.3

Transaction upload ...................................................................................... 228

10.3.1

Unattended and attended signing............................................................... 229

10.3.1.1 Setting up unattended signing .................................................................... 229

9

Trax – Bank Connector user guide

10.3.1.2 Setting up attended signing ........................................................................ 230
10.3.1.3 Setting up 3SKey token signing .................................................................. 231
10.3.2

3SKey token signing .................................................................................... 233

10.3.2.1 Setting up 3SKey token signing .................................................................. 233
10.3.3

Submitting files with a technical user ........................................................ 235

10.3.3.1 Activating the technical user....................................................................... 235
10.3.4

Submitting files in test mode ...................................................................... 236

10.3.4.1 Activating the test mode ............................................................................. 236
10.3.5

Configuring EBICS outgoing profiles .......................................................... 237

10.3.5.1 BTF configuration ........................................................................................ 237
10.3.5.2 EBICS profile configuration in Bank Connector ......................................... 239
10.3.5.3 EBICS profile configuration in Trax............................................................. 240
10.3.5.4 Working with default profiles ...................................................................... 241
10.3.6

Configuring responses on uploaded transactions..................................... 243

10.3.6.1 Customer acknowledgement (HAC)........................................................... 243
10.3.6.2 Setting up response subscriptions ............................................................. 244
10.4

Transaction download................................................................................. 247

10.4.1

Defining a download user............................................................................ 247

10.4.2

Configuring EBICS incoming profiles ......................................................... 248

10.4.2.1 Configuring EBICS routing criteria .............................................................. 248
10.4.2.2 Marking incoming messages as confidential ............................................ 250
10.4.3

Configuring download jobs ......................................................................... 250

10.4.3.1 BTF configuration ........................................................................................ 251
10.4.3.2 Configuring the download jobs ................................................................... 255
10.4.3.3 Fetching the Customer acknowledgement HAC........................................ 256
10.4.3.4 Triggering a download job manually .......................................................... 257
10.4.3.5 Monitoring the scheduled job execution .................................................... 257
11

Bank APIs ..................................................................................................... 259

11.1

Bank of America........................................................................................... 259

10

Trax – Bank Connector user guide

11.1.1

Bank of America - Authentication ............................................................... 259

11.1.1.1 Authentication method ................................................................................ 259
11.1.2

Bank of America - Current and previous day balance inquiry ................... 261

11.1.2.1 Configuration................................................................................................ 261
11.1.2.2 Request message ........................................................................................ 262
11.1.2.3 Response message ..................................................................................... 263
11.1.3

Bank of America - Current and previous day transaction inquiry ............. 264

11.1.3.1 Configuration................................................................................................ 264
11.1.3.2 Request message ........................................................................................ 265
11.1.3.3 Response message ..................................................................................... 266
11.1.4

Bank of America - Payments V2 initiation ISO XML .................................. 267

11.1.4.1 Configuration................................................................................................ 267
11.1.4.2 Request message ........................................................................................ 269
11.1.4.3 Response message ..................................................................................... 269
11.1.5

Bank of America - Payments V2 status ISO XML ...................................... 269

11.1.5.1 Configuration................................................................................................ 269
11.1.5.2 Request message ........................................................................................ 270
11.1.5.3 Response message ..................................................................................... 271
11.2

Citibank......................................................................................................... 272

11.2.1

Which APIs are currently supported by Bank Connector .......................... 272

11.2.2

Citi onboarding procedure........................................................................... 272

11.2.3

Citibank - Authentication ............................................................................. 273

11.2.3.1 Authentication method ................................................................................ 273
11.2.4

Citibank - Balance Inquiry ............................................................................ 276

11.2.4.1 Bank Connector configuration .................................................................... 276
11.2.4.2 Request message ........................................................................................ 279
11.2.4.3 Response message ..................................................................................... 281
11.2.5

Citibank - Statement Initiation - Retrieval ................................................... 281

11.2.5.1 Bank Connector configuration .................................................................... 281

11

Trax – Bank Connector user guide

11.2.5.2 Statement initiation ..................................................................................... 285
11.2.5.3 Statement Retrieval ..................................................................................... 286
11.3

JPMorgan Chase ......................................................................................... 287

11.3.1

Which APIs are currently supported by Bank Connector .......................... 287

11.3.2

JPM Onboarding procedure ........................................................................ 287

11.3.3

Bank Connector configuration .................................................................... 288

11.3.4

Request message ........................................................................................ 290

11.4

Necto ............................................................................................................ 290

11.4.1

Which APIs are currently supported by Bank Connector .......................... 290

11.4.2

Bank Connector configuration .................................................................... 290

11.4.2.1 Account Balances API ................................................................................. 291
11.4.2.2 Account Transactions API........................................................................... 292
11.5

US Bank ........................................................................................................ 293

11.5.1

Which APIs are currently supported by Bank Connector .......................... 293

11.5.2

US Bank Onboarding procedure.................................................................. 294

11.5.3

Bank Connector configuration .................................................................... 294

11.5.3.1 Authentication.............................................................................................. 294
11.5.3.2 Account balances - Current day and Previous day balance inquiry API... 295
11.5.3.3 Transactions - Current day transaction inquiry API ................................... 296
11.6

Routing API response messages to the backend application .................. 298

11.6.1

Bank Connector configuration .................................................................... 298

11.6.1.1 API channel configuration ........................................................................... 298
11.6.1.2 Backend channel configuration .................................................................. 299
12

H2H connections ......................................................................................... 302

12.1

Scope ............................................................................................................ 302

12.2

H2H connection details ............................................................................... 302

12.2.1

Defining the channel name.......................................................................... 302

12.2.2

SFTP connection details.............................................................................. 302

12.2.2.1 Connection details from Bank Connector to bank..................................... 303

12

Trax – Bank Connector user guide

12.2.2.2 Connection details from bank to Bank Connector..................................... 304
12.2.3

Securing the H2H connection ..................................................................... 305

12.2.3.1 SSH public key authentication .................................................................... 305
12.2.3.2 Username/password authentication .......................................................... 306
12.2.4

Setting the reception directory polling frequency...................................... 307

12.3

H2H outgoing flow....................................................................................... 307

12.3.1

Configuring outgoing profiles ..................................................................... 307

12.3.2

Defining the outgoing filename................................................................... 308

12.4

H2H incoming flow ...................................................................................... 309

12.4.1

Setting up incoming routing ........................................................................ 309

12.4.1.1 Assigning a profile based on SFTP folder .................................................. 309
12.4.1.2 Assigning a profile based on filename ....................................................... 310
12.5

Routing H2H response messages to the backend application................. 310

12.5.1

Configuring the subscription....................................................................... 311

12.5.1.1 H2H channel configuration ......................................................................... 311
12.5.1.2 Originating backend channel configuration ............................................... 311
13

Message management................................................................................ 313

13.1

Message monitoring.................................................................................... 313

13.1.1

Expanding the message list ........................................................................ 313

13.1.2

Searching the message list ......................................................................... 313

13.1.2.1 Search on message data............................................................................. 313
13.1.2.2 Search on reference..................................................................................... 316
13.1.2.3 Search on date and time.............................................................................. 317
13.1.3

Setting the source and target reference for incoming messages ............ 318

13.1.4

Exporting the message search results ....................................................... 318

13.2

Retrying failed messages ............................................................................ 319

13.3

Confidential profile and confidential messages ........................................ 320

13.3.1

Outgoing messages..................................................................................... 321

13.3.2

Incoming messages .................................................................................... 322

13

Trax – Bank Connector user guide

13.4

Duplicate detection ...................................................................................... 322

13.4.1

Duplicate check in Bank Connector ............................................................ 322

13.4.1.1 Application wide configuration via the application properties ................. 323
13.4.1.2 Channel specific configuration ................................................................... 323
13.4.2

Possible duplicate flag from Trax............................................................... 324

13.4.3

PDE (Possible duplicate Emission) for Swift FIN, FileAct and FINplus .... 324

13.5

Channel timeout........................................................................................... 324

13.5.1

Application wide configuration via the application properties ................. 325

13.5.2

Channel timeout channel specific configuration ....................................... 325

13.5.3

Fail after channel timeout configuration in targetconnection - outgoing. 326

13.6

Data purging ................................................................................................. 326

13.7

Message encryption and decryption .......................................................... 327

13.7.1

Configuration of PGP encryption and decryption ...................................... 327

13.7.2

Configuration of CMS encryption and decryption ..................................... 330

14

Securing Bank Connector............................................................................ 333

14.1

Network and ports overview ....................................................................... 333

14.2

Password encryption ................................................................................... 333

14.3

Encryption tool ............................................................................................. 334

14.4

Securing connections .................................................................................. 335

14.4.1

A few things about passwords ................................................................... 335

14.4.1.1 Password vault............................................................................................. 335
14.4.1.2 Password encryption (configuration files) ................................................. 335
14.4.2

Database and file system (data at rest) ..................................................... 336

14.4.3

WildFly (GUI)................................................................................................. 336

14.4.4

IdP/Identity Provider (SAML 2.0-based SSO)............................................. 336

14.4.5

Artemis (Trax) .............................................................................................. 337

14.4.5.1 Bank Connector............................................................................................ 337
14.4.5.2 Artemis ......................................................................................................... 337
14.4.6

IBM MQ (typically Swift FIN) ....................................................................... 337

14

Trax – Bank Connector user guide

14.4.7

SFTP (typically Swift FileAct) ...................................................................... 338

14.4.8

SOAP............................................................................................................. 338

14.5

Managing your own JKS keystores ............................................................ 338

14.5.1

Add a keypair................................................................................................ 338

14.5.2

Add a public certificate................................................................................ 351

14.5.3

Add a TLS/SSL certificate ........................................................................... 354

14.5.4

Create a private key and generate certificate signing request (csr)......... 361

15

System Monitoring....................................................................................... 362

15.1

Logging......................................................................................................... 362

15.2

Event alerting................................................................................................ 363

15.2.1

Configuration of e-mail alerting .................................................................. 363

15.2.2

alert-subscriptions.yml ................................................................................ 365

15.2.3

targetconnection-outgoing.yml................................................................... 365

16

Audit logs...................................................................................................... 367

17

Application Properties ................................................................................. 368

18

Bank Connector change log ........................................................................ 370

18.1

Summary v2.52.0 ......................................................................................... 370

18.2

Summary v2.51.0 ......................................................................................... 370

18.3

Summary v2.50.0 ......................................................................................... 370

18.4

Summary v2.49.0 ......................................................................................... 371

18.5

Summary v2.48.1 ......................................................................................... 371

18.6

Summary v2.48.0 ......................................................................................... 372

18.7

Summary v2.47.0 ......................................................................................... 372

18.8

Summary v2.46.0 ......................................................................................... 372

18.9

Summary v2.45.0 ......................................................................................... 373

18.10

Summary v2.44.0 ......................................................................................... 373

18.11

Summary v2.43.0 ......................................................................................... 374

18.12

Summary v2.42.0 ......................................................................................... 374

18.13

Summary v2.41.0 ......................................................................................... 374

15

Trax – Bank Connector user guide

18.14

Summary v2.40.0 ......................................................................................... 375

18.15

Summary v2.39.0 ......................................................................................... 375

18.16

Summary v2.38.0 ......................................................................................... 376

18.17

Summary v2.37.0 ......................................................................................... 376

18.18

Summary v2.36.0 ......................................................................................... 377

18.19

Summary v2.35.0 ......................................................................................... 377

18.20

Summary v2.34.0 ......................................................................................... 377

18.21

Summary v2.33.0 ......................................................................................... 377

18.22

Summary v2.32.0 ......................................................................................... 378

18.23

Summary v2.31.2 ......................................................................................... 379

18.24

Summary v2.31.1 ......................................................................................... 379

18.25

Summary v2.31.0 ......................................................................................... 379

18.26

Summary v2.30.0 ......................................................................................... 379

18.27

Summary v2.29.0 ......................................................................................... 380

18.28

Summary v2.28.0 ......................................................................................... 380

18.29

Summary v2.27.0 ......................................................................................... 381

18.30

Summary v2.26.0 ......................................................................................... 381

18.31

Summary v2.25.0 ......................................................................................... 382

18.32

Summary v2.24.0 ......................................................................................... 382

18.33

Summary v2.23.0 ......................................................................................... 383

18.34

Summary v2.22.0 ......................................................................................... 383

18.35

Summary v2.21.0 ......................................................................................... 384

18.36

Summary v2.20.0 ......................................................................................... 384

18.37

Summary v2.19.0 ......................................................................................... 384

18.38

Summary v2.18.0 ......................................................................................... 384

18.39

Summary v2.17.0 ......................................................................................... 385

18.40

Summary v2.16.0 ......................................................................................... 385

18.41

Summary v2.15.0 ......................................................................................... 385

18.42

Summary v2.14.0 ......................................................................................... 385

16

Trax – Bank Connector user guide

18.43

Summary v2.13.0 ......................................................................................... 386

18.44

Summary v2.12.1 ......................................................................................... 386

18.45

Summary v2.12.0 ......................................................................................... 386

18.46

Summary v2.11.2 ......................................................................................... 387

18.47

Summary v2.11.0 ......................................................................................... 387

18.48

Summary v2.10.0 ......................................................................................... 387

18.49

Summary v2.9.0 ........................................................................................... 387

18.50

Summary v2.8.0 ........................................................................................... 387

18.51

Summary v2.7.0 ........................................................................................... 388

18.52

Summary v2.6.1 ........................................................................................... 388

18.53

Summary v2.6.0 ........................................................................................... 388

18.54

Summary v2.5.0 ........................................................................................... 388

18.55

Summary v2.4.0 ........................................................................................... 388

18.56

Summary v2.3.1 ........................................................................................... 388

18.57

Summary v2.3.0 ........................................................................................... 389

18.58

Summary v2.2.0 ........................................................................................... 389

18.59

Summary v2.1.0 ........................................................................................... 389

18.60

Summary v2.0.0 ........................................................................................... 389

17

Trax – Bank Connector user guide

• Introduction (see page 20)
• Legal Notices (see page 21)
• Technical requirements (see page 22)
• Bank Connector server (see page 23)
• Supported software (see page 30)
• Installation (see page 35)
• Installing Bank Connector (see page 35)
• Upgrading Bank Connector (see page 38)
• Installation parameters (see page 40)
• Single Sign-on (SSO) (see page 49)
• IDP and Bank Connector configuration (see page 49)
• Configuring Azure AD (see page 57)
• Configuring Okta (see page 67)
• Configuring FIS Infinity IdP (see page 72)
• Channel management (see page 76)
• Concepts (see page 76)
• Structure of the channel configuration (see page 77)
• Importing and exporting channel configuration (see page 81)
• Change approval on channel configuration (see page 85)
• Stopping and starting channels (see page 86)
• Channel downtime (see page 88)
• Validation of channel configuration (see page 91)
• Trax connection (see page 99)
• Configuration in Bank Connector (see page 99)
• Configuration in Trax (see page 113)
• ERP connections (see page 122)
• ERP connection details (see page 123)
• Swift connections (see page 130)
• FileAct (see page 130)
• FIN (see page 153)
• FINplus (see page 178)
• Local Authentication and LAU key (see page 200)
• Routing Swift response messages to the backend application (see page 207)
• EBICS connection (see page 215)
• Managing bank servers and customers (see page 215)
• Managing users (see page 219)
• Transaction upload (see page 228)
• Transaction download (see page 247)
• Bank APIs (see page 259)

– 18

Trax – Bank Connector user guide

• Bank of America (see page 259)
• Citibank (see page 272)
• JPMorgan Chase (see page 287)
• Necto (see page 290)
• US Bank (see page 293)
• Routing API response messages to the backend application (see page 298)
• H2H connections (see page 302)
• H2H connection details (see page 302)
• H2H outgoing flow (see page 307)
• H2H incoming flow (see page 309)
• Routing H2H response messages to the backend application (see page 310)
• Message management (see page 313)
• Message monitoring (see page 313)
• Retrying failed messages (see page 319)
• Confidential profile and confidential messages (see page 320)
• Duplicate detection (see page 322)
• Channel timeout (see page 324)
• Data purging (see page 326)
• Message encryption and decryption (see page 327)
• Securing Bank Connector (see page 333)
• Network and ports overview (see page 333)
• Password encryption (see page 333)
• Encryption tool (see page 334)
• Securing connections (see page 335)
•
•
•
•

• Managing your own JKS keystores (see page 338)
System Monitoring (see page 362)
Audit logs (see page 367)
Application Properties (see page 368)
Bank Connector change log (see page 370)

– 19

Trax – Bank Connector user guide

1 Introduction
This document describes the necessary procedures and steps required to install and configure Bank
Connector.
The objective of this user guide is to describe all the system requirements, prerequisites and procedures
required to install an out-of-the-box version of a Bank Connector environment, which will be ready for first
use.
Following this initial installation and configuration, further configuration is mandatory to elevate the Bank
Connector software from its out-of-the-box status to fully operational, ready for Go Live. Configuration and
user acceptance testing of the Bank Connector software to reach full operational readiness are very clientspecific, and are carried out during the implementation phase of the client project. They are therefore not in
the scope of this guide.

Introduction – 20

Trax – Bank Connector user guide

2 Legal Notices
2.1 Copyright Notice
© 2001 - 2025 FIS. This document and the software described within are copyrighted with all rights reserved.
No part of this document may be reproduced, transcribed, transmitted, stored in an electronic retrieval
system, or translated into any language in any form by any means without prior written permission of FIS. FIS
makes no warranties, express or implied, in this document. In no event shall FIS be liable for damages of any
kind arising out of the use of this document or the information contained within.

2.2 Confidentiality Statement
This document contains information that is confidential or proprietary to FIS (or its direct or indirect
subsidiaries). By accepting this document, you agree that: (1) if there is any pre- existing contract containing
disclosure and use restrictions between your company and FIS, you and your company will use this
information in reliance on and submit to the terms of any such pre-existing context; or (2) if there is no
contractual relationship between you or your company and FIS, you and your Company agree to protect this
information and not reproduce, disclose or use the information in any way, except as may be required by law.

2.3 Disclaimer
The screens and illustrations in this document are representative of those created by the software and are
not always exact copies of what appears on the computer monitor. Companies, names and data used in
examples herein are fictitious unless otherwise noted. The material in this document is for information only,
and is subject to change without notice. FIS reserves the right to make changes in the product design and
installation software without reservation and without notice to users.

2.4 Registered Trademarks and Proprietary names
FIS, the FIS logo, FIS, and Trax are trademarks or registered trademarks of FIS Data Systems, Inc., or its
subsidiaries in the U.S. and other countries. All other trade names are trademarks or registered trademarks
of their respective holders.
Written and designed by: FIS, De Kleetlaan 6A, 1831 Machelen Belgium

Legal Notices – 21

Trax – Bank Connector user guide

3 Technical requirements
3.1 General architecture
The following minimum hardware and software requirements must be met to install and use Bank
Connector.
Hardware, memory, and storage requirements can vary greatly, depending on volumes (peak loads),
expected processing times, and other elements. Your organization should regularly review company
hardware and software resources compared to current requirements.
Bank Connector is a Java application, requiring an application server, as well as a database server and a
queue server.
On the client side, Bank Connector uses thin client architecture, only requiring a compatible browser.

Technical requirements – 22

Trax – Bank Connector user guide

3.2 Definitions
The pre-requisites identified in the

boxes
below are supported by FIS.

3.3 Disclaimer
These hardware and software recommendations are for the use of Bank Connector as available at the time
of this publication. As newer versions are introduced, FIS reserves the right to update and modify these
recommendations.
System requirements presented herein are accurate and reliable to the best of FIS’s knowledge and belief but
are not guaranteed. These requirements are subject to change without notice. Nothing herein is to be
construed as recommending any practice or any product in violation of any patent or in violation of any law
or regulation. It is the user's responsibility to determine the suitability of any equipment and/or procedure for
a specific purpose and to use such equipment and/or procedure as may be necessary and pertinent to the
user’s organization and business practices.

3.4 Bank Connector server
3.4.1 Application Server (Mandatory)
Bank Connector ships with an embedded Java EE 6-compliant application server.

3.4.1.1 Software

FIS-provided embedded application server (based on WildFly 18)
Bank Connector uses the standard version of each application server installation. For extended options like
automatic failover, load-balancing and clustering, please request a custom quote and feasibility study. The
desired architecture must be validated by a FIS consultant.

Technical requirements – 23

Trax – Bank Connector user guide

3.4.1.2 Operating System

Microsoft Windows Server 2019 (64-bit) Standard edition
Red Hat Enterprise Linux 8 (x86_64)
The latest recommended software updates and service packs should be installed.
It is highly recommended to install libaio on Linux systems to improve asynchronous I/O. This is usually
provided by your Linux package manager.
Since Java 11, asynchronous I/O is used more intensively on Linux kernels by the Artemis middleware.
Depending on your system, the maximum number of allowed concurrent requests for AIO on the host kernel
might need to be changed to a higher value (e.g. 65536 -> 131072).
When WildFly encounters this resource limit, the following exception will be available in the server logs:
Caused by: java.lang.RuntimeException: Cannot initialize queue:Resource temporarily unavailable
at org.apache.activemq.artemis.journal//
org.apache.activemq.artemis.nativo.jlibaio.LibaioContext.newContext(Native Method)
Useful commands to inspect the kernel settings on RedHat Enterprise Linux:
• Read the maximum number of allowed concurrent requests for AIO
$ cat /proc/sys/fs/aio-max-nr
• Read the current number of concurrent requests for AIO
$ cat /proc/sys/fs/aio-nr
• Modify the maximum number of allowed concurrent requests for AIO and apply
$ sudo –s
$ echo fs.aio-max-nr=131072 >> /etc/sysctl.conf
$ sysctl –p /etc/sysctl.conf

3.4.1.3 Java

Azul Zulu OpenJDK 11 (64-bit)
Red Hat OpenJDK 11, version 11.0.10 or higher (64-bit)
Bank Connector requires Java 11 (higher versions are not supported) to be installed on the application
server.

Technical requirements – 24

Trax – Bank Connector user guide

3.4.1.4 Hardware
Bank Connector requires at least a dedicated multi-core 64 bits Intel/AMD server running at 3 GHz, with 8 GB
of memory available for the application.
Free hard disk space: 40 GB available after installation of the operating system, using a RAID 5 or RAID 1+0
configuration.
See later in “Sizing”, for more precise recommendations.
FIS recommends the use of backup and security components for hardware, data, and application
redundancy. This includes backup servers for database, file, and application servers. In case of server failure,
backup servers allow users to work with minimal interruptions in database and application services. Good
security practices also require the use of standard security hardware and software, such as corporate
firewalls and utilities for protection against computer viruses and spyware. Configuration of hardware and
application security is the responsibility of the client.

3.4.1.5 Virtualized Server Environments

VMWare ESX virtualization technology
The Bank Connector application is supported on virtualized servers if the Operating System and Third-Party
Software prerequisites are met.
FIS relies on the virtualization vendor claim that the use of their products is transparent. Please note that FIS
does neither fully qualify the Bank Connector application on all virtualization technologies, nor has formal
support arrangements in place with the related providers. As such, FIS does not take responsibility for 3rd
party infrastructure running within a VM, nor any potential effect on the Bank Connector application.

3.4.2 Database Server (Mandatory)
3.4.2.1 Software

Microsoft SQL Server 2019
There is no prerequisite for the operating system of the database server.
Bank Connector uses the standard version of each database server installation. For extended options like
automatic failover, load-balancing and clustering, please request a custom quote and feasibility study. The
desired architecture must be validated by a FIS consultant.

Technical requirements – 25

Trax – Bank Connector user guide

3.4.2.2 Hardware
FIS strongly recommends the use of a dedicated, physical database server. If the server will be running
additional applications, the recommended specifications should be increased accordingly.
The database server used by Trax can often be shared with Bank Connector.

3.4.3 Supported deployments
Bank Connector supports a flexible and scalable application architecture. Scaling up and out is supported to
meet the needs from small to large deployments.

3.4.4 Sizing
Key sizing factors are:
• number of messages/files
• message/file sizes (number of megabytes)
The Memory and Disk allocations in the images below are minimum requirements for the application, not
the entire system. In other words, when 4-8 GB RAM is mentioned below, it must entirely be available for the
application. The system must have more RAM available for the operating system and tooling where
applicable.

Technical requirements – 26

Trax – Bank Connector user guide

3.4.4.1 Application server
Application server: 4 cores; 10 GB RAM; 40 GB disk

3.4.4.2 Database
The database server used by Trax can often be shared with Bank Connector.

3.4.5 Applicability of the sizing recommendations
FIS provides these recommendations on hardware sizing, based on its experience and that of its customers.
FIS could commit on performance levels on its own infrastructure (hardware, software, network), but not on
performance on the customer’s infrastructure stack. To come to a point where we could commit on a
performance target, tests would have to be run:
• On the real target infrastructure (hardware, software, network),
• Under a realistic load (users, traffic, historical data),
• With an application configured as closely as possible to what it will be later in production

3.4.6 User authentication and authorization
Bank Connector implements Single Sign On (SSO) and requires a SAML 2.0 compliant identity provider.

The client’s compliant identity provider can be configured as the primary identity provider. Additional identity
providers can be added for users that have no access to this primary identity provider.

Technical requirements – 27

Trax – Bank Connector user guide

When Bank Connector is FIS hosted, the FIS internal identity provider can be used for internal FIS users for
supporting, monitoring and operating the application.

3.4.7 Firewall
These ports need to be open to be able to let all components communicate with each other. The TCP ports
below are default values and can be customized.

From

To

Protoc
ol

Port

Purpose

Client / load balancer

Bank Connector Web
GUI

HTTPS

8643

GUI

Bank Connector

DB

JDBC

1433

Database connection

Bank Connector

External systems

...

...

Interfaces

From

To

Protoc
ol

Port

Purpose

Client

Bank Connector

HTTPS

11093

WildFly management/
monitoring

Optional TCP ports:

3.4.8 Communication partners (Optional)
Bank Connector features a communication layer that can be used to communicate with other applications.
Please let your FIS Consultant verify that the communication works as intended on your system and that
there are no inter-operability problems, as this may be dependent on configuration.

3.4.8.1 Queue based communication
Bank Connector can communicate with other applications or middleware over JMS.

Artemis 2.17.0
ActiveMQ 5.13.0

Technical requirements – 28

Trax – Bank Connector user guide

IBM MQ 9.1.0

3.4.8.2 PGP cryptography
The Bank Connector communications layer supports PGP to secure communications with applications.

GPG 1.x
GPG 2.x

3.4.9 Third-party software
Other third-party tools and infrastructure software can have an impact on the behavior and functioning of
certain Bank Connector features. Please advise your FIS consultant on your third-party software
requirements.
For specific interfaces, additional third-party libraries may have to be obtained and linked in (for instance IBM
WebSphere MQ resource adapter, database drivers, EBICS connectivity libraries, cryptographic middleware,
or cryptographic token drivers). Their licensing is not included as part of the default contract. The following
table lists these libraries, the way they are distributed, as well as whether there is an associated cost (nonfree libraries). The non-free libraries distributed by FIS are normally included in your license price.

Vendor

Library

Required when using

Distributed by

License
type/cost

Microsoft

JDBC Driver

Microsoft SQL Server database

Download from
Microsoft website

Proprietary/
Free

RedHat

Java

OpenJDK 11

Download from RedHat
website, optional

Proprietary/
Free

Azul

Java

Zulu OpenJDK 11

Download from Azul
website, optional

Proprietary/
Free

BusinessLogics

BLEBICS

EBICS bank connectivity

FIS

Proprietary/
Non-free

BusinessLogics

BLPTK

German PTK file processing

FIS

Proprietary/
Non-free

Technical requirements – 29

Trax – Bank Connector user guide

BusinessLogics

BLPTK

EBICS PKI certificate library

FIS

Proprietary/
Non-free

IAIK

PKCS#11
Provider

All cryptographic tokens

FIS

Proprietary/
Non-free

IAIK

PKCS#11
Wrapper

All cryptographic tokens

FIS

Open
source/Free

IAIK

JCE

Whenever any other IAIK library
is used

FIS

Proprietary/
Non-free

IAIK

CMS

Sending attached digital
signature to your bank

FIS

Proprietary/
Non-free

3.4.10 Open Source Software in Bank Connector
Like most Java applications, Bank Connector embeds many open source components. The licenses of these
components are compatible with commercial use.
A list of open source libraries can be provided upon request.

3.5 Supported software
This section provides additional details:
• on the level of tests performed by FIS for each release
• on the level of compatibility of Bank Connector with other technologies

3.5.1 Support levels
The technical prerequisites required to be installed in order for Bank Connector to operate are labeled as
“Certified”, “Supported”, “Compatible”, or “Incompatible”.
The table below clarifies what level of confidence and support can be expected from FIS with respect to the
Bank Connector software when it is installed in an environment including each of these pre-requisites. The
support and maintenance obligations of FIS are as set out in the support and maintenance agreement in
place with FIS, subject to the following limitations.

Certified

Fully tested by our QA team as part of each Bank Connector release.
Bank Connector will be fully supported in accordance with the support
and maintenance agreement in place with FIS.

Technical requirements – 30

Trax – Bank Connector user guide

Supported

The design of Bank Connector is theoretically compatible with these,
and FIS has the intent to support Bank Connector as installed on these
but does not test it thoroughly for each release.
Specific tests must be foreseen during the implementation project.
In case issues are reported later on, FIS will investigate the problem as
part of its maintenance obligation and do its best to produce a timely
fix.

Compatible

While the design of Bank Connector is theoretically compatible with
these, FIS has no intent to support Bank Connector as installed on
them fully in the future.
Specific tests must be foreseen during the implementation project.
In case issues are reported, FIS could investigate the problem, but at
the customer’s cost[1]. In case severe issues arise, FIS reserves the
right to require that Bank Connector is installed on a platform that
means Bank Connector is “Supported” or “Certified”.

Incompatible

The design of Bank Connector is not compatible with these. Bank
Connector cannot be expected to work in these environments.
FIS will not investigate problems arising when one of these
components is used.
Any component not listed in one of the categories above should also
be considered as “Incompatible”.

3.5.2 Bank Connector server
3.5.2.1 Application server software

Certified

FIS-provided embedded application server (based on WildFly
18.0.1.Final )
with Red Hat OpenJDK 11 or Azul Zulu OpenJDK 11, version
11.0.10 or higher (64-bit)

Supported

FIS-provided embedded application server (based on WildFly
18.0.1.Final )
with any other TCK-certified OpenJDK 11, version 11.0.10 or
higher (64-bit)

Compatible

Technical requirements – 31

Trax – Bank Connector user guide

Incompatible

3.5.2.2 Application server operating system

Certified

Microsoft Windows Server 2019 (64-bit)
Red Hat Enterprise Linux 8 (x86_64)

Supported
Compatible
Incompatible

3.5.2.3 Application server virtualized server environments

Certified
Supported

VMWare ESX virtualization technology

Compatible

Other Java-compatible virtualization techniques

Incompatible

3.5.2.4 Database Server Software

Certified

Microsoft SQL Server 2019 (Standard edition)
Azure SQL Managed Instance

Supported

PostgreSQL 16

Compatible

Technical requirements – 32

Trax – Bank Connector user guide

Incompatible

Any other database server

3.5.2.5 SAML 2.0 identity providers

Certified

FIS

Supported

Okta, Ping Identity, Azure AD

Compatible

Other SAML 2 identity providers

Incompatible

3.5.2.6 Queue-based communication

Certified

Artemis 2.27.1
IBM WebSphere MQ 9.1.0

Supported

IBM WebSphere MQ 8.5.0

Compatible
Incompatible

3.5.2.7 PGP encryption software

Certified

GPG 1.x

Supported

GPG 2.x

Compatible

Other openPGP compatible software

Incompatible

Technical requirements – 33

Trax – Bank Connector user guide

3.5.2.8 Trax

Certified

Trax 6.8.2 or higher

Supported

Trax 6.0 or higher

Compatible
Incompatible

3.5.3 Bank Connector desktop client
3.5.3.1 Web Browser

Certified

Google Chrome

Supported

Mozilla Firefox
Microsoft Internet Explorer 11

Compatible

Microsoft Edge (based on Chromium)
Apple Safari

Incompatible

Microsoft Internet Explorer 8 or older

[1] Customer cost could be involved:
• Software or hardware costs if FIS must make such purchases to investigate the problem
• Travel costs if FIS must travel onsite to reproduce issues on the customer’s software or hardware
• Hourly Professional Services costs to pursue investigations and fix the problem once it is established
that the problem is linked to the specific software or hardware being used

Technical requirements – 34

Trax – Bank Connector user guide

4 Installation
4.1 Installing Bank Connector
4.1.1 Prequisites
4.1.1.1 Custom HTTPS keystore
Bank Connector uses a default HTTPS keystore for the HTTPS connections between the Bank Connector GUI
and WildFly. In case a non-default HTTPS keystore is required, it needs to be available before running the
installer.
The following information will be requested during installation:
• Keystore directory: full path to the keystore
• Keystore password: password of the keystore
• Keystore alias: alias name of the key

4.1.1.2 SQL server
A SQL server database has to be created before running the installer, as the installer will only create the
necessary tables.
The following information will be requested during installation:
• database hostname: ip address of the host on which the database resides
• database port: port the SQL server is listening on
• database username: username of the database ( currently only a SQL Server username is
supported)
• database password: password of the database user

4.1.1.3 Artemis 2.17
Artemis is only required for the communication with Payment Hub (formerly Trax), and can be installed with
the Bank Connector installer.
The Artemis installer on Window needs the .NET Framework v3.5.

4.1.2 Windows installer
Download the latest official Bank Connector release, and extract the zipped archive to a convenient location.
We will refer to this location as the <release-dir>.

Installation – 35

Trax – Bank Connector user guide

The installation can be executed in two different ways.

4.1.2.1 GUI interface installation
Locate the install.bat file and run the installer with an administrator-level operating system account.
The GUI installer will guide you through the installation process.
Most properties are self-explanatory, for more detailed information see Installation parameters (see page 40).

4.1.2.2 Command line installation with Configuration File
Locate the auto-install.xml. By default the file will be in the <release-dir>/resources .
Edit the installation parameters12 in the auto-install.xml file and save.
Open the Windows command prompt and change the current directory to where the install.bat file is located.
Type install install.
This will start the installation process with the predefined parameters in the auto-install.xml file.
1 https://wiki.fisglobal.com/display/trax/Install+-+Installation+parameters+-+current
2 https://wiki.fisglobal.com/display/trax/Install+-+Installation+parameters+-+current

Installation – 36

Trax – Bank Connector user guide

4.1.3 Linux installer
Download the latest official Bank Connector release, and extract the zipped archive to a convenient location.
We will refer to this location as the <release-dir>.
The installation can be executed in two different ways.

4.1.3.1 GUI interface installation
Locate the install.sh file and run the installer.
$ ./install.sh
The GUI installer will guide you through the installation process.
Most properties are self-explanatory, for more detailed information see Installation parameters (see page 40).

4.1.3.2 Command line installation with Configuration File
Locate the auto-install.xml. By default the file will be in the <release-dir>/resources .
Edit the installation parameters (see page 40) in the auto-install.xml file and save.
$ ./install.sh install
This will start the installation process with the predefined parameters in the auto-install.xml file.

Installation – 37

Trax – Bank Connector user guide

4.2 Upgrading Bank Connector
4.2.1 Which version?
Which version are you looking at now?
Just edit the navigation bar in your browser: .../bankconnector/version will show you the installed version
(the GUI is stuck on v2.5.0 for now).

4.2.2 Steps
Upgrading Bank Connector cannot be done without an interruption of the incoming and outgoing flows (even
if it is brief). Here is how you should proceed:
1. Trax: (try to) prevent people from sending payments. (See step 2.)
2. Trax: stop the BankConnector Integration Channel.
This will only stop the incoming flow. It will not prevent payments being sent to Bank Connector
over Artemis ActiveMQ.
3. Bank Connector: stop the TRAX channel.
Outgoing payments will no longer be picked up from Artemis ActiveMQ, but incoming messages over
the FIN and FILEACT channels will still be posted on Artemis ActiveMQ, to be picked up by Trax when
the Integration Channel is started again.
4. Bank Connector: stop the FIN and FILEACT channels.
From this point, no transmissions will happen.
5. Perform the upgrade process described below.
6. Bank Connector: start the TRAX channel.
There is a possibility that outgoing payments are waiting on Artemis ActiveMQ (see step 1 and 2).
After this step, Bank Connector will start consuming those, and they will fail immediately until the FIN
and/or FILEACT channels are started. These will have to be rescheduled in Trax.
7. Bank Connector: start the FIN and FILEACT channels.
Incoming messages that have been buffered on the SSB side (MQ, SFTP, SOAP) will now be
consumed, and sent to the TRAX channel, which posts them on Artemis ActiveMQ.
8. Trax: start the BankConnector Integration Channel.
Trax starts consuming incoming messages and responses from Artemis ActiveMQ again.
9. Trax: situation normal, payments can be sent again.
Do not switch step 6 and 7, because you will have to manually Retry all incoming messages that have been
consumed and could not be sent to Trax because the channel was not started yet.

Installation – 38

Trax – Bank Connector user guide

4.2.3 The upgrade process
Since v2.19.0 we have been testing upgrades from v2.12.0 and upwards. Upgrading from any version
released prior to 2023 needs to be discussed with the development team. If well prepared, a Bank Connector
upgrade typically takes about half an hour lead time and a few minutes processing time.
1. If you decompress an installer .zip file, you will find a "resources" directory in it, with both autoinstall.xml and auto-upgrade.xml.

Default auto-upgrade.xml with dummy values...

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<AutomatedInstallation langpack="eng">
<com.izforge.izpack.panels.hello.HelloPanel id="welcome"/>
<com.izforge.izpack.panels.userinput.UserInputPanel id="InstallOrUpgrade">
<entry key="InstallOrUpgrade" value="UPGRADE"/>
</com.izforge.izpack.panels.userinput.UserInputPanel>
<com.izforge.izpack.panels.target.TargetPanel id="install_dir">
<installpath>/opt/FIS/BankConnector</installpath>
</com.izforge.izpack.panels.target.TargetPanel>
<com.izforge.izpack.panels.userinput.UserInputPanel id="DatabasePanel">
<entry key="databaseSelection" value="SQLServer"/>
<entry key="database.hostname" value="10.253.175.45"/>
<entry key="databasePort" value="1433"/>
<entry key="databaseUsername" value="SCOTTY"/>
<entry key="databasePassword" value=""/>
<entry key="databaseName" value="scotty"/>
<entry key="upgradeDatabase" value="ENABLE"/>
</com.izforge.izpack.panels.userinput.UserInputPanel>
<com.izforge.izpack.panels.install.InstallPanel id="install"/>
<com.izforge.izpack.panels.process.ProcessPanel id="ProcessPanel.Spec.xml"/
>
<com.izforge.izpack.panels.finish.FinishPanel id="finish"/>
</AutomatedInstallation>

2. During an installation with the GUI you are asked to provide a number of values. The installer allows
you to save those values to the auto-install.xml so you do not have to provide them again if you have
to run the installer again. When this checkbox is ticked, this will also write the relevant values to autoupgrade.xml. (Alternatively, you can also provide these values with the auto-install.xml for the first
installation immediately.)
3. Once you have the correct values in <installer-dir>\resources\auto-upgrade.xml, just stop the
bankconnector process (the bcartemis process does not have to be stopped), and then:
> cd <installer-dir>
> install upgrade
4. After two minutes or so, the upgrade is finished, and the bankconnector process can be started
again.

Installation – 39

Trax – Bank Connector user guide

4.3 Installation parameters
4.3.1 General parameters
Parameter

Description

Mandat
ory /
Optional

Default values

Install or Upgrade

For a new installation the install option
has to be selected.

Mandato
ry

Install

Installation path

Installation directory

Mandato
ry

Windows : C:
\FIS\BankConnector
Linux: opt/FIS/
BankConnector

Service User

Local user with which the Bank
Connector services will be installed. If
left blank, the default LocalSystem
account will be used.

Optional

No default value

Service user
password

Password of the service user. If the
Service User is left blank, the Service
user password should be blank as well.

Optional

No default value

Admin User
password

The Windows admin user password or
Linux sudo password for creating the
service on Linux.

Mandato
ry

No default value

HTTPS KeyStore

When you flag this option, you can
provide your own keystore to secure
the HTTPS connection between the
browser and WildFly. If left blank, the
default HTTPS keystore will be used.

Optional

Unflagged

WildFly

When you flag this option, a WildFly
application server will be installed. Only
unflag this option, if you already have a
Bank Connector service installed and
running.

Optional

Flagged

Installation – 40

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default values

FIS Bank
Connector GUI

When you flag this option, a GUI server
will be installed. Only unflag this option
if you already have a GUI server
installed and running.

Optional

Flagged

4.3.2 HTTPS keystore settings
(These only need to be provided if you do not want to use the default HTTPS keystore.)

Parameter

Description

Mandat
ory /
Optional

Default value

Keystore directory

The absolute path to a KeyStore to
be used for HTTPS connections.

Mandato
ry

No default value

KeyStore password

The password for the KeyStore.

Mandato
ry

No default value

KeyStore alias

The alias used for the secret key as
mentioned in the KeyStore.

Mandato
ry

No default value

4.3.2.1 SSO SAML Configuration
Parameter

Description

Mandat
ory /
Optional

Default value

KeyStore directory

The absolute path to a KeyStore to
be used for SAML connections with
the IDP.

Mandato
ry

No default value

KeyStore Password

The password for the KeyStore.

Mandato
ry

No default value

Installation – 41

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default value

KeyStore Type

KeyStore type as mentioned in the
KeyStore.

Mandato
ry

No default value

SecretKey Alias

The alias used for the secret key as
mentioned in the KeyStore.

Mandato
ry

No default value

SecretKey Password

The password for the secret key in
the KeyStore.

Mandato
ry

No default value

Properties File

The relative or absolute path to a
SAML properties file. The filename
has to be saml.properties.

Mandato
ry

No default value

Metadata File

The relative or absolute path to a
metadata file. The filename has to
be the one referenced in the
idpMetaData property in the
saml.properties file. This filename
would normally be metadata.xml.

Mandato
ry

No default value

Bank Connector URL

Bank Connector URL

Mandato
ry

https://localhost:8643/.

4.3.3 Application Server (WildFly)
Parameter

Description

Mandat
ory /
Optional

Default value

Environment

Name of the environment on which
WildFly application server is
installed

Optional

Development

WildFly service
name

Bank Connector service name

Mandato
ry

bankconnector

Installation – 42

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default value

Hostname

Unique name to identify the WildFly
server. This can be relevant when
running Bank Connector in a
clustered setup to uniquely identify
each WildFly server in the logs

Optional

localhost

WildFly port (HTTP)

The HTTP port WildFly listens on.

Mandato
ry

8280

WildFly port
(HTTPS)

The HTTPS port WildFly listens on.

Mandato
ry

8643

WildFly user
management port
(HTTP)

The management HTTP port
WildFly listens on.

Mandato
ry

11090

WildFly user
management port
(HTTPS)

The management HTTPS port
WildFly listens on.

Mandato
ry

11093

WildFly Xmx

Maximum heap space for Wildfly.

Mandato
ry

2g

WildFly
maxmetaspacesize

Maximum size of the metadata
space for WildFly.

Mandato
ry

512m

WildFly log directory

Path to the WildFly logs.

Mandato
ry

Windows: C:
\FIS\BankConnector\wildfly\st
andalone\log
Linux: opt/FIS/BankConnector/
wildfly/standalone/log

Disable HTTP

When you unflag this option,
WildFly will listen on HTTP
connections as well. It is highly
recommended not to listen to HTTP
connections.

Mandato
ry

Flagged

Installation – 43

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default value

Enable debugging

When you flag this option, it is
possible to remotely debug the
WildFly application server. It is
highly recommended to leave this
option unflagged.

Mandato
ry

Unflagged

Safe mode

When flagging this option, the
communication channels will not be
started automatically when the
Bank Connector service is started.
Safe mode can be activated after
the installation of Bank Connector
through a property in the
application.properties file.

Mandato
ry

Unflagged

Protocol

The protocol to be used when
configuring a proxy.

Optional

No default value

Hostname of proxy

The host of the proxy server
through which it connects to the
internet.

Optional

No default value

Port of proxy

The port of the proxy server through
which is connects to the internet.

Optional

No default value

User for proxy

The username in case the proxy
server requires credentials.

Optional

No default value

Password for proxy

The password in case the proxy
server requires credentials.

Optional

No default value

Installation – 44

Trax – Bank Connector user guide

4.3.4 Database connection details
Parameter

Description

Mandat
ory /
Optional

Default value

Choose Database

Only SQL Server is supported by
Bank Connector. See Bank
Connector server - v2.4 (see page 40)
for more details

Mandato
ry

SQLserver

Hostname

Database hostname.

Mandato
ry

No default value

Port

Port the database listens on.

Mandato
ry

No default value

DatabaseName

The database name is usually the
same as the username, every
database typically has an “owner”
of the same name.

Mandato
ry

No default value

Username

Database user name.

Mandato
ry

No default value

Mandato
ry

No default value

Only SQL Server users are
currently supported
Password

Password of the database user.

4.3.5 FIS Payment Hub integration
(These are only required if you want to install the ActiveMQ Artemis.)

Parameter

Description

Mandat
ory /
Optional

Default value

Choose MQ Broker

When selecting Apache Artemis, an
Apache Artemis server will be
installed.

Mandato
ry

Apache Artemis

Installation – 45

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default value

service name

name of the Artemis service

Mandato
ry

bcartemis

Port

The port the ActiveMQ Artemis
server will listen on.

Mandato
ry

61817

Jetty port (HTTP)

The HTTP port to access the web
console.

Mandato
ry

8361

Jetty port (HTTPS)

The HTTPS port to access the web
console.

Mandato
ry

8362

Artemis ActiveMQ
Broker Name

name of the ActiveMQ broker

Mandato
ry

bcartemisbroker

4.3.6 Bank Connector directories
Parameter

Description

Mandat
ory /
Optional

Default value

Data directory

Directory for temporarily storing
large data files during processing.

Mandato
ry

<installation directory>\data

Temporary directory

Directory for temporarily storing
large data files during downloading.

Mandato
ry

<installation directory>\tmp

Error directory

Directory for storing error
messages.

Mandato
ry

<installation directory>\error

Installation – 46

Trax – Bank Connector user guide

4.3.7 Services
Parameter

Description

Mandat
ory /
Optional

Default value

Create BC service

When flagging this option, the Bank
Connector service will be created
during installation. Only unflag this
option if the admin user running the
installer does not have the access
rights to create services.

Mandato
ry

Unflagged

Start BC service
after installation

When flagging this option, the Bank
Connector service will be started
after the installation. Unflag this
option if you want to start the
service manually after the
installation or if you have opted not
to create the services during the
installation.

Mandato
ry

Unflagged

Create ActiveMQ
Artemis service

When flagging this option, the
service will be created during
installation. Only unflag this option
if the admin user running the
installer, does not have the access
rights to create the service. This
option will only be present if you
have opted for the installation of an
Apache Artemis server.

Mandato
ry

Unflagged

Start ActiveMQ
Artemis service
after installation

When flagging this option, the
service will be started after the
installation. Unflag this option if you
want to start the service manually
after the installation. This option will
only be present if you have opted
for the installation of an Apache
Artemis server.

Mandato
ry

Unflagged

Installation – 47

Trax – Bank Connector user guide

Parameter

Description

Mandat
ory /
Optional

Default value

Create database

Flag this option if you want to
create a new database during the
installation. If you install Bank
Connector in a clustered setup and
this is the second node or higher on
which you want to run a Bank
Connector installation, unflag this
option to avoid the creation of a
new database.

Mandato
ry

Unflagged

Installation – 48

Trax – Bank Connector user guide

5 Single Sign-on (SSO)
5.1 IDP and Bank Connector configuration
Bank Connector requires SSO to log in. User authentication and authorization will be managed through an
Identity provider (IdP).

5.1.1 Profiles
There are different profiles to manage users' access to the application. The following profiles can be
assigned:

User Profile

Description

configurator

A configurator can import / reject / approve channel configuration
and can stop / start channels.

operator

An operator can retry failed messages.

confidential

Through the confidential profile, a user will be able to view the
message content (or the payload).

logs

Grants access to the logs in the GUI.

audit

Users with the audit profile have access to the User Activity logs.

system

Grants access to the application properties in the GUI

ebicslimitedaccess

Exceptionally, specific users only need access to Bank Connector to
trigger a job manually that fetches account statements. This profile
will only show the EBICS scheduled jobs in the GUI from where
manual "Run now" actions can be triggered.

webservice

Users with the webservice profile have access to the import rest api
(/api/v1/import)

By default, if no user profile is assigned, the users can still monitor the incoming and outgoing messages.
Each user can be assigned a combination of any these profiles in the IdP.

Single Sign-on (SSO) – 49

Trax – Bank Connector user guide

The following steps have to be completed before running the Bank Connector installer.

5.1.2 Identity Provider Configuration
5.1.2.1 Set up a Bank Connector service provider
Some identity providers require a metadata file to integrate a service provider. Bank Connector can generate
such a file and provides a dynamic download at https://<bankconnector setup>:8643/bankconnector/
MetaData (e.g. https://server.someclient.local:8643/bankconnector/MetaData).

service provider metadata (sample)

<?xml version="1.0" encoding="UTF-8"?><md:EntityDescriptor xmlns:md="urn:oasis:names:
tc:SAML:2.0:metadata" entityID="BankConnector">
<md:SPSSODescriptor AuthnRequestsSigned="true" ID="BankConnector"
WanetAssertionsSigned="false" protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0
:protocol">
<md:KeyDescriptor use="signing">
<ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:X509Data>
<ds:X509Certificate>MIIFgTCCA2mgAwIBAgIEHQstsTANBgkqhkiG9w0BAQ0FA
DBxMQswCQYDVQQGEwJCRTEQMA4GA1UE
CBMHQW50d2VycDERMA8GA1UEBxMITWVjaGVsZW4xEDAOBgNVBAoTB1N1bkdhcmQxFzAVBgNVBAsT
DkF2YW50R2FyZCBUcmF4MRIwEAYDVQQDEwlsb2NhbGhvc3QwHhcNMTQwMjE0MTQyNjUxWhcNNDQw
MjE0MTQyNjUxWjBxMQswCQYDVQQGEwJCRTEQMA4GA1UECBMHQW50d2VycDERMA8GA1UEBxMITWVj
aGVsZW4xEDAOBgNVBAoTB1N1bkdhcmQxFzAVBgNVBAsTDkF2YW50R2FyZCBUcmF4MRIwEAYDVQQD
Ewlsb2NhbGhvc3QwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCLnemyHqoP0gIZ2g/a
Hp2i00R1WtMTFGXkHpnolCz5LfF97FF3FVoO5oOlpdCh47qysFRc5AGw/Ysmh80wH/EJLJQma0Zs
S1TrdDqq+HYI/QjWmtGK0aqznVYtvDfvJ+J3fzRo3YuGWQQMyPxSuNt7uX3TdkRQlc4qutosUgJ3
UHSCGs6PysrQvk6JCwqcY/qBzE0IHgwZw2P8JuDAnG4oIFAfJnhz6aTe3QjR4SiEdWys2TYCjYfM
oS5N+UCq8yuctWcKkpZAngHkPsEl6CzYy+Zk505y0ke3AI+3hvxj2/dCAyWAm2V9t0+TDaENdREO
5iuHSkaANerOW+25NuMnzSSP50aN8fYiPt94jMl++LziqmhbFSJx1CqJbX71SFp6c6KcPNMMBKHh
1r68hhaUQ7lSZ97N/Dq97lWbVF1lBM2mcIxwhrdudLx+cwOcPELlhynJVaQQso8EnqRQhTxfpyvm
7BepPriqWzvWVH4PaWyhrtw+6fbXystzBcaUWToLHRsnltJtrtgXCDeh5td13SQSIP+CHRZ5eChc
r7KBiwRwSR5Mn4sEewWvK/SwF5oUAQlJwXo1jUniLXzBeq3yhIFvJxmZs5cYY8R1cNl+Ekjww/rb
5AR3TdB0kX0Xql7HOOjuRyeiHMEUl4jQCnU+GXWaBpdy9EoOsY00tGhegQIDAQABoyEwHzAdBgNV
HQ4EFgQUXdiH43CaHLIV9WO4P5Zr+FgFVaEwDQYJKoZIhvcNAQENBQADggIBADoXqq/1FK3dpZSJ
2wYo/5nHNRhu402qp5U+UFjCqVZit03DrWY+rDYMTiKXtbKsuhURrmguDlw75XrnKsZPI8TPM0Hy
oPfR/rMXjOmBXZH5p6hLJnusqH1Bqzh//Abqg7L2vVdftB+1OK1+2rfJKp12ELP0+WrUPfrltqKU
wy7EGbUaPRDiRHQCkcIZq+ySMhxFRg0cIXJIRKiQ+z9jWvwkCJmnnWnZy4x9dRMlA65JrQS3UMR9
AV7C5mhp3wjxx4fkO6Kj05jAu7Up6agoA3Tn48EvuEZFBLJeV6hjMTvm4MzI6NvP7Xb6re8IDGzE
TgLrWUWzFS2oWe5cXsL1E8d0gHq5QbvvtCmRA9h0IZcaPVO+7KvXJzM+87sbBLdcUnFQH2jDDpxr
ge3bRb74Yj/AqI/uJg1H2ZtIFPetXWz4EX8l0XDGSiizE/9nuRj97ePuCUVr0Op6E3WT/0AJznNJ
sfNuumpHh2lnIlXnCe49JaLf3N+jh6peJN7/Z04Vycoo7Wb2a2MR4QtHkb/YygRYC9K3P66I3BgI
7eqlLI05AeP75XALb+us/T/MQ2gpxofxZ7DVGKWYZGEGrmgECe1ye+qzLhd8k9zFRKNUtnr9oA9r
pzao+k1ZvrK+/uYx4IcyyYKH2zz3B2MKm20EB+7dmhTRGCqq1UiQOCnMrvga</ds:X509Certificate>
</ds:X509Data>

Single Sign-on (SSO) – 50

Trax – Bank Connector user guide

</ds:KeyInfo>
</md:KeyDescriptor>
<md:KeyDescriptor use="encryption">
<ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:X509Data>
<ds:X509Certificate>MIIFgTCCA2mgAwIBAgIEHQstsTANBgkqhkiG9w0BAQ0FA
DBxMQswCQYDVQQGEwJCRTEQMA4GA1UE
CBMHQW50d2VycDERMA8GA1UEBxMITWVjaGVsZW4xEDAOBgNVBAoTB1N1bkdhcmQxFzAVBgNVBAsT
DkF2YW50R2FyZCBUcmF4MRIwEAYDVQQDEwlsb2NhbGhvc3QwHhcNMTQwMjE0MTQyNjUxWhcNNDQw
MjE0MTQyNjUxWjBxMQswCQYDVQQGEwJCRTEQMA4GA1UECBMHQW50d2VycDERMA8GA1UEBxMITWVj
aGVsZW4xEDAOBgNVBAoTB1N1bkdhcmQxFzAVBgNVBAsTDkF2YW50R2FyZCBUcmF4MRIwEAYDVQQD
Ewlsb2NhbGhvc3QwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCLnemyHqoP0gIZ2g/a
Hp2i00R1WtMTFGXkHpnolCz5LfF97FF3FVoO5oOlpdCh47qysFRc5AGw/Ysmh80wH/EJLJQma0Zs
S1TrdDqq+HYI/QjWmtGK0aqznVYtvDfvJ+J3fzRo3YuGWQQMyPxSuNt7uX3TdkRQlc4qutosUgJ3
UHSCGs6PysrQvk6JCwqcY/qBzE0IHgwZw2P8JuDAnG4oIFAfJnhz6aTe3QjR4SiEdWys2TYCjYfM
oS5N+UCq8yuctWcKkpZAngHkPsEl6CzYy+Zk505y0ke3AI+3hvxj2/dCAyWAm2V9t0+TDaENdREO
5iuHSkaANerOW+25NuMnzSSP50aN8fYiPt94jMl++LziqmhbFSJx1CqJbX71SFp6c6KcPNMMBKHh
1r68hhaUQ7lSZ97N/Dq97lWbVF1lBM2mcIxwhrdudLx+cwOcPELlhynJVaQQso8EnqRQhTxfpyvm
7BepPriqWzvWVH4PaWyhrtw+6fbXystzBcaUWToLHRsnltJtrtgXCDeh5td13SQSIP+CHRZ5eChc
r7KBiwRwSR5Mn4sEewWvK/SwF5oUAQlJwXo1jUniLXzBeq3yhIFvJxmZs5cYY8R1cNl+Ekjww/rb
5AR3TdB0kX0Xql7HOOjuRyeiHMEUl4jQCnU+GXWaBpdy9EoOsY00tGhegQIDAQABoyEwHzAdBgNV
HQ4EFgQUXdiH43CaHLIV9WO4P5Zr+FgFVaEwDQYJKoZIhvcNAQENBQADggIBADoXqq/1FK3dpZSJ
2wYo/5nHNRhu402qp5U+UFjCqVZit03DrWY+rDYMTiKXtbKsuhURrmguDlw75XrnKsZPI8TPM0Hy
oPfR/rMXjOmBXZH5p6hLJnusqH1Bqzh//Abqg7L2vVdftB+1OK1+2rfJKp12ELP0+WrUPfrltqKU
wy7EGbUaPRDiRHQCkcIZq+ySMhxFRg0cIXJIRKiQ+z9jWvwkCJmnnWnZy4x9dRMlA65JrQS3UMR9
AV7C5mhp3wjxx4fkO6Kj05jAu7Up6agoA3Tn48EvuEZFBLJeV6hjMTvm4MzI6NvP7Xb6re8IDGzE
TgLrWUWzFS2oWe5cXsL1E8d0gHq5QbvvtCmRA9h0IZcaPVO+7KvXJzM+87sbBLdcUnFQH2jDDpxr
ge3bRb74Yj/AqI/uJg1H2ZtIFPetXWz4EX8l0XDGSiizE/9nuRj97ePuCUVr0Op6E3WT/0AJznNJ
sfNuumpHh2lnIlXnCe49JaLf3N+jh6peJN7/Z04Vycoo7Wb2a2MR4QtHkb/YygRYC9K3P66I3BgI
7eqlLI05AeP75XALb+us/T/MQ2gpxofxZ7DVGKWYZGEGrmgECe1ye+qzLhd8k9zFRKNUtnr9oA9r
pzao+k1ZvrK+/uYx4IcyyYKH2zz3B2MKm20EB+7dmhTRGCqq1UiQOCnMrvga</ds:X509Certificate>
</ds:X509Data>
</ds:KeyInfo>
</md:KeyDescriptor>
<md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTPPOST" Location="https://10.7.139.61:8643/SignOut"/>
<md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTPRedirect" Location="https://10.7.139.61:8643/SignOut"/>
<md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HT
TP-POST" Location="https://10.7.139.61:8643/" index="1" isDefault="true"/>
</md:SPSSODescriptor>
</md:EntityDescriptor>

This metadata file will contain:
•
•
•
•
•
•

the ACS URL where the IdP must send its authentication Responses
the entity ID that Bank Connector will use to identify itself when sending request
whether Bank Connector can sign authentication requests (yes)
whether Bank Connector expects that assertions are signed or not
the SLO endpoints where the IdP must send its Logout Responses
the X509 certificates that the IdP must use to verify request signatures or encrypt assertions

Single Sign-on (SSO) – 51

Trax – Bank Connector user guide

5.1.2.2 Add a custom user property "Profiles"
The property "Profiles" is a comma separated list of user profiles34. Link the profiles property to a new
custom SAML assertion attribute "Profiles". This will ensure that the user profiles will be passed along in the
SAML 2.0 assertion. Consult the documentation of your IdP for more information on setting up custom user
properties and assertion attributes.

5.1.3 Bank Connector configuration
5.1.3.1 Download the Entity Descriptor metadata file from your Identity Provider

IDP metadata file (sample)

<?xml version="1.0" encoding="UTF-8"?>
<md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" entityID="okta">
<md:IDPSSODescriptor WantAuthnRequestsSigned="false" protocolSupportEnumeration="urn:
oasis:names:tc:SAML:2.0:protocol">
<md:KeyDescriptor use="signing">
<ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:X509Data>
<ds:X509Certificate>MIIDpDCCAoygAwIBAgIGAW+pvX4LMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGE
wJVUzETMBEG
A1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzENMAsGA1UECgwET2t0YTEU
MBIGA1UECwwLU1NPUHJvdmlkZXIxEzARBgNVBAMMCmRldi0xOTg1NTAxHDAaBgkqhkiG9w0BCQEW
DWluZm9Ab2t0YS5jb20wHhcNMjAwMTE1MTUwNTA1WhcNMzAwMTE1MTUwNjA1WjCBkjELMAkGA1UE
BhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDTALBgNV
BAoMBE9rdGExFDASBgNVBAsMC1NTT1Byb3ZpZGVyMRMwEQYDVQQDDApkZXYtMTk4NTUwMRwwGgYJ
KoZIhvcNAQkBFg1pbmZvQG9rdGEuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA
p8iHveU81SF8RLEGhIDEXDaBnGLEaBjA3j4DgqwKgc+SIFrDznKqFaOJoqtO+IWEmfZm+jZ/XWvs
VAmoGYxX5uG5UXTSBF16fT3HEsT8F1QFBlGsE54xJeF92u7S2vGgUIyMBDpeVvWcgNCgSgD61Z8w
IO2zFa1tlPSv+/nRPbfCDfHjHjleuPT0io7SLbbLP4Lu0jnzSAJ7TMJuiXuzyu00IkVP6warI6eC
ic91RZDqv53RV9o/5ItEBwfGAyUC8L71JBlKj8hkQDkQAcsi4SiJpJH9vow9miJFrZhCzygcMYKV
CnklxVfI6BNwg4X/4wd6paxGdXoJyRZJC+BylQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQArSegn
BZJx6qbLrUv8Br9km0loU77AAQip4F1P6b2RHXIKLtaFjOR714ExK9G56E3w0FQzDELHBYwdhVnM
MI3c7+DE07yE6lbx8/Ptw1WcE9q+lLiD1LGbGsgs8EhwRcXCLTHtU23o4kl6VCt5G2s+42ewSMad
ulfo06fd8z1m2xwKWdkcCLZ/ovMutAYNfd4ZVD6ja6hcKEykhvjnAyuQ1P24YpCpI5O1ScnHJGhr c/
BWcCBcuQvzM8/DVtPdIL2N0kIW061cUOcp3q3SWpYt2kdGR3SETM5KH9PN668Q+eFlNVaAiWMT
dj6HRbUDSV55EpCW0XPXDxtG4mDCpiZP</ds:X509Certificate>
</ds:X509Data>
</ds:KeyInfo>
</md:KeyDescriptor>

3 https://wiki.fisglobal.com/display/trax/SSO+-+Configuring+FIS+Infinity+IdP+for+Bank+Connector+-+current
4 https://wiki.fisglobal.com/display/trax/SSO+-+Configuring+FIS+Infinity+IdP+for+Bank+Connector+-+current

Single Sign-on (SSO) – 52

Trax – Bank Connector user guide

<md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
Location="https://dev-198550.okta.com/app/dev-198550_bc_1/exk31nvb8vixrzJX04x7/slo/
saml"/>
<md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"
Location="https://dev-198550.okta.com/app/dev-198550_bc_1/exk31nvb8vixrzJX04x7/slo/
saml"/>
<md:NameIDFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</md:NameIDFor
mat>
<md:SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
Location="https://dev-198550.okta.com/app/dev-198550_bc_1/exk31nvb8vixrzJX04x7/sso/
saml"/>
<md:SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"
Location="https://dev-198550.okta.com/app/dev-198550_bc_1/exk31nvb8vixrzJX04x7/sso/
saml"/>
</md:IDPSSODescriptor>
</md:EntityDescriptor>

The following elements are required in the metadata file:
•
•
•
•

IdP EntityID
IdP signing certificate
IdP SSO endpoint (HTTP-Redirect or HTTP-POST)
WantAuthnRequestsSigned. The IdP can specify if it requires Bank Connector to sign its
authentication request.
• IdP SLO endpoint (HTTP-Redirect or HTTP-POST). Bank Connector supports SP-initiated SLO. Please
bear in mind that for SLO to function, the LogoutRequest must be signed as per specification. This
requires the IdP to import the SP signing certificate. For SLO to work, the IdP must publish the this
element in its metadata.

5.1.3.2 Modify the SAML.properties file

SAML.properties

###
# This file contains the configuration for SAML v2.0 SSO/SLO.
###
## Disable the SAML servlet filters. To enable SSO/SLO, set this property to false
and change the user authenticator in the database application properties. *** CHANGE
THIS
ssoDisabled=false
## IdP SAML metadata XML *** CHANGE THIS
idpMetaData=metadata.xml
## Enables IdP SAML metadata XSD validation. Defaults to true.

Single Sign-on (SSO) – 53

Trax – Bank Connector user guide

#idpMetaDataSchemaValidation=true
## The location where SAML communication should be directed to (replace trax-host
with IP address or hostname) *** CHANGE THIS
acsUrl=https://bankconnector.someclient.local:8643/bankconnector/
## Service Provider client ID. This should match the Service Provider ID in your
Identity Provider configuration *** CHANGE THIS
## This can be whatever identifier you seem fit: "TraxDEV", "https://
dev.mydomain.com/trax/", etc.
## If you are using your IdP for different Trax deployments, you will need a unique
ID for each service provider (DEV, UAT, PROD, etc).
samlClientId=BankConnector_VN
## Enable IdP signature validation. This settings MUST be true in production
environments!!
## Defaults to true.
validateSignatures=true
## We want the <Response/> messages to be signed at message-level. Defaults to true.
#signedResponses=true
## We want all <Assertion/> elements to be signed at assertion level. Defaults to
false.
#signedAssertions=false
## A boolean value of "true" or "false" that indicates whether the request generated
by the service provider should
## include an option to bypass an existing security context and require explicit user
interaction during authentication
## to the identity provider. This corresponds to the SAML 2.0 ForceAuthn attribute in
a <samlp:AuthnRequest> message. Defaults to false.
#forceAuthn=false
## Define the signature algorithm used to sign requests, defaults to RSA/SHA-256.
Make sure that the IdP expects this algorithm on service provider signatures.
#signingAlgorithm=http://www.w3.org/2000/09/xmldsig#rsa-sha1
#signingAlgorithm=http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
#signingAlgorithm=http://www.w3.org/2001/04/xmldsig-more#rsa-sha384
#signingAlgorithm=http://www.w3.org/2001/04/xmldsig-more#rsa-sha512
## Indicate in the generated SP metadata that AuthnRequests signatures are supported.
Defaults to true.
## Note: whether we actually sign AuthnRequests is based on the IdP metadata.
LogoutRequests are always signed, as per spec.
#authnRequestsSigned=true
## Keep track of the last response IDs to disable potential double-post responses.
Defaults to 150.
#maximumNumberOfIDs=150

Single Sign-on (SSO) – 54

Trax – Bank Connector user guide

## This property allows relaxing the allowed time difference between client and
server (in seconds).
## Always make sure the system time of your servers are in sync.
#relaxationPeriodSeconds=1800

Property

Description

ssoDisabled

Value has to be false

idpMetaData

The name of the file that contains your identity provider
metadata.

idpMetaDataSchemaValidation

Enables or disables the optional XSD schema validation of the
IdP metadata file. This must be set to false if the metadata file
contains unsupported extensions or namespaces or is simply
not schema-valid.
Regardless of this setting, Bank Connector will always validate
the necessary elements needed for SSO to function properly.
Defaults to true.

acsUrl

Assertion Consumer Service URL where the IdP sends its
Responses. This is the same as the regular Bank Connector URL
(e.g. https://bankconnector.someclient.local:8643/
bankconnector/).

samClientId

The value that uniquely identifies Bank Connector as a service
provider within your identity provider

validateSignatures

Toggles signature validation. This must always be enabled in
production environments to prevent easy identity exploits

signedResponses

If enabled, Bank Connector will reject the authentication
Response if it is not signed. Defaults to true.

signedAssertions

If enabled, Bank Connector will reject the authentication
Response if its assertions are not signed. Defaults to false.

forceAuthn

Indicates whether the request generated by the service provider
should include an option to bypass an existing security context
and require explicit user interaction during authentication to the
identity provider.
Set this to true if your identity provider does not support SLO (no
SingleLogoutService endpoints in its metadata).

Single Sign-on (SSO) – 55

Trax – Bank Connector user guide

Property

Description

signingAlgorithm

Specifies the signature algorithm that Bank Connector will use
to sign requests. Must be a valid XMLSig algorithm URI that is
supported by your signature key and by the IdP. Defaults to
RSA/SHA-256.

5.1.4 Signatures, encryption, X509 certificates, and private keys
Bank Connector as a service provider will sign Authentication Requests if specified in the identity provider’s
metadata file. This is done by setting the WantAuthnRequestsSigned attribute in the the IdP metadata file to
false.
Bank Connector will use the Bank Connector HTTPS certificate and corresponding private key for signing
requests.
The identity provider’s signature is validated using the signing certificate that is available in the metadata file
of the identity provider. Any certificates that are included in the Response message are discarded to mitigate
man-in-the-middle attacks that might alter signatures and supply a spoofed certificate.
Signatures –if present– will always be validated (unless signature validation is generally disabled in
saml.properties; this should never be the case in production!). Whether they are required or not can also be
specified in saml.properties. By default, Bank Connector requires Response signatures, and Assertion
signatures are optional.
The identity provider can choose to encrypt any assertions it sends in its authentication Responses by using
the X509 encryption certificate of Bank Connector (the Bank Connector HTTPS certificate that gets published
in the generated service provider metadata). Bank Connector will transparently attempt to decrypt any
available encrypted assertions.

5.1.5 Identity provider-initiated SSO
Bank Connector supports SSO sessions that are directly initiated by the IdP. This is the case if users clickthrough to the different service providers via an IdP portal where they are already authenticated, or if they
access the Bank Connector URL while they are already authenticated.
In these cases, an unsolicited Response will be sent to Bank Connector.

5.1.6 SLO – LogoutRequest – Force authentication
Bank Connector can initiate Single Logout by sending a service provider-initiated Logout Request to the IdP
when the user signs out.
The user will be redirected to the login screen of the IdP.
If no Single Logout Service endpoints are available in the metadata file, Bank Connector cannot initiate a
global logout but will terminate the local user sessions only. This is followed by a server-side redirect to the
Bank Connector URL, which in turn generates a new AuthnRequest to be sent to the IdP.

Single Sign-on (SSO) – 56

Trax – Bank Connector user guide

If the IdP still considers the security context active, it will respond without requiring the end user to
authenticate and Bank Connector will transparently create a new local user session using the identifiers in
the IdP response.
This can be confusing to the end user because it may seem that the explicit Sign Out action did not logout
the user, but in fact the user was logged out and the IdP instructed Bank Connector to re-login the user. To
instruct the IdP to at least authenticate the user in this case (where the IdP does not support SLO), set the
forceAuthn property in saml.properties to true. This is reflected in the AuthnRequest that is send after
terminating the local Bank Connector user sessions.

5.2 Configuring Azure AD

Disclaimer
The authors do not have access to Azure AD, and the screenshots were made by a friendly client.
While we believe that these pages can provide useful inspiration, they should not be considered
as the definitive HOW TO about this topic. YMMV, and please proceed with caution. (For
instance, we cannot help you to assign roles to Groups, which is certainly more elegant, but also
quite some overhead for the handful of users with access to Bank Connector. Feel free to go
ahead if you know what you are doing.)

5.2.1 Add Bank Connector as an Enterprise application
Bank Connector needs to be defined as an application. Create a new "own application" in Enterprise
applications.

Single Sign-on (SSO) – 57

Trax – Bank Connector user guide

Single Sign-on (SSO) – 58

Trax – Bank Connector user guide

Choose a name for the application (we suggest "FIS Bank Connector", its official name), select Nongallery and click Create.

Single Sign-on (SSO) – 59

Trax – Bank Connector user guide

5.2.2 Assign Bank Connector profiles to users
Bank Connector relies on the Identity Provider not only for authentication, but for authorization as well: the
SAML response needs to contain a custom attribute called "profiles" (at this time lowercase only is
accepted) as shown in this snippet:

Attributes

<saml2:AttributeStatement>
<saml2:Attribute Name="profiles" NameFormat="urn:oasis:names:tc:SAML:2.0:attr
name-format:unspecified">
<saml2:AttributeValue
xmlns:xs="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:st
ring">configurator,operator
</saml2:AttributeValue>
</saml2:Attribute>
</saml2:AttributeStatement>

You can use roles in Azure AD to assign Bank Connector profiles to users. In the Enterprise application, go to
Users and groups, and then click the application registration link.

Single Sign-on (SSO) – 60

Trax – Bank Connector user guide

Warning
The screenshots in the next part are confusing, and in most cases wrong.
The approach shown below assumes that there is a direct 1-1 mapping between a role in Azure
AD and a profile in Bank Connector. You almost certainly do not want that. Bank Connector rarely
has or needs more than half a dozen users, and/but most of those will not be able to perform
their tasks without a combination of several profiles in Bank Connector. As far as we know it is
not possible in Azure AD to assign several roles to a user, and then have those combined in a
comma-separated list in the profiles attribute. Therefore, we suggest the following approach.
1. define (virtual) groups of people who have the same responsibilities and tasks
2. map those responsibilities and tasks to a list of profiles (see the table below)
3. create a role for each 'group' defined in #1
4. assign the list of profiles of #2 as the Value
As a simple example:
role → profiles
treasury → configurator, operator, logs
it → logs
auditor → audit

User
Profile

Description

configur
ator

A configurator can import / reject / approve channel configuration and can stop / start
channels.

Single Sign-on (SSO) – 61

Trax – Bank Connector user guide

User
Profile

Description

operator

An operator can retry failed messages.

confiden
tial

Through the confidential profile, a user will be able to view the message content.

logs

Grants access to the logs in the GUI.

audit

Users with the audit profile have access to the User Activity logs.

By default, if no profiles are assigned, the user can still monitor the incoming and outgoing messages.

Create the roles you need, fill in the Display name (e.g. treasury) and the Value (e.g. "configurator, operator,
logs", without the quotes). Again, this screenshot is confusing, enable the role, and Apply.

Single Sign-on (SSO) – 62

Trax – Bank Connector user guide

Once you are done creating roles, you can assign users to them.

Single Sign-on (SSO) – 63

Trax – Bank Connector user guide

(See the warning above: this list is almost certainly not what you will see.)

This blurred user has been assigned the "operator" role, but we do not see here which Bank Connector
profiles are assigned to it in its Value.

5.2.3 Set up SSO with SAML
The permissions have been distributed by assigning a combination of profiles to roles, and assigning a role
to the relevant users, but we still need to set up SSO. In the Enterprise Application you created, click Single
sign-on from the menu on the left, and select SAML as the method.

Single Sign-on (SSO) – 64

Trax – Bank Connector user guide

In Basic SAML Configuration two settings are relevant:
the Entity ID (this needs to be identical to the value of samlClientId in Bank Connector's SAML
properties).
the Reply URL is where the user is redirected to after successful login.

5.2.4 Add profiles to SAML response attributes
Almost done, but we still have to insert those profiles in the SAML response. Go to Attributes & Claims on
the same page, and click Edit.

Single Sign-on (SSO) – 65

Trax – Bank Connector user guide

Add a new claim....

... call it profiles (lowercase!) in the Name field, and pick user.assignedroles as the Source attribute field.

Single Sign-on (SSO) – 66

Trax – Bank Connector user guide

That should do it. When a user logs in, they should now see the tabs/buttons/content they have the
permissions for.

5.3 Configuring Okta
One client with Okta as their IdP used https://developer.okta.com/docs/reference/okta-expressionlanguage/#group-functions to populate the custom attribute "profiles" (with an enumerated list of profiles) to
groups instead of users individually.

5.3.1 Add an application
Here we have called it "BC".

Single Sign-on (SSO) – 67

Trax – Bank Connector user guide

5.3.2 Edit General App Settings

Single Sign-on (SSO) – 68

Trax – Bank Connector user guide

5.3.3 SAML Settings

Single Sign-on (SSO) – 69

Trax – Bank Connector user guide

5.3.4 Add a Custom Attribute and set it to user.Role

5.3.5 Edit the user's Profile

Scroll down, and add the desired profiles to the Role field.

Single Sign-on (SSO) – 70

Trax – Bank Connector user guide

5.3.6 Profile Editor

Single Sign-on (SSO) – 71

Trax – Bank Connector user guide

5.4 Configuring FIS Infinity IdP
In order to assign profiles to a user and pass the profiles to Bank Connector, the following configuration
changes have to be made in the IdP. The guidelines and the screenshots rely on the FIS Infinity IdP, so
YMMV.

You need admin role access to make the configuration changes below. The admin role also
requires access to the IDP_SAML_ATTRIBUTE_MANAGE authorization in order to perform step 2.

5.4.1 Add a custom property Profiles to the user definition
Navigate to Site Administration - Customizations - Custom Fields

Select user Custom Fields and then Add New Field

Add a new field with the following properties
Custom Field Name : Profiles
Type : Text Input

Single Sign-on (SSO) – 72

Trax – Bank Connector user guide

Mandatory Field : leave blank
Sub-Type : Text
By assigning the Type Text Input to the field, the profiles can be entered as a comma separated list of values.
The custom field Profiles is now available when creating a user.
When creating a new user, the field Profiles can be found in the additional details section
Enter the profiles that apply to the user as comma separated list of values
(configurator,operator,confidential,logs). If let blank, the user will have access to the message monitoring
tab only.

5.4.2 Link the custom field Profiles to a new assertion attribute profiles.
This ensures that the profiles assigned to the user, will be passed as an assertion attribute in the SAML 2.0
response sent by Infinity to Bank connector.
Navigate to IdP administration - Custom Profiles

Single Sign-on (SSO) – 73

Trax – Bank Connector user guide

Add a new Custom Attrbute Details with the following properties
Assertion Key : profiles
Attribute Type : select User
Associated User Attribute : select Profiles from the dropdown list.

5.4.3 Sample SAML 2.0 response
The SAML 2.0 response will now contain as assertion attribute the comma separated list of profiles.

SAML 2.0 response example (okta)

<?xml version="1.0" encoding="UTF-8"?>
<saml2:Assertion ID="id158020727899524051349886643" IssueInstant="2022-02-17T16:02:34
.617Z" Version="2.0"
xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion">
<saml2:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">okta</
saml2:Issuer>
<saml2:Subject>
<saml2:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress">
peter.vaneygen@fisglobal.com</saml2:NameID>
<saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">
<saml2:SubjectConfirmationData NotOnOrAfter="2022-02-17T16:07:34.617Z"
Recipient="https://vlmazjmees.fisdev.local:8643/"/>

Single Sign-on (SSO) – 74

Trax – Bank Connector user guide

</saml2:SubjectConfirmation>
</saml2:Subject>
<saml2:Conditions NotBefore="2022-02-17T15:57:34.617Z" NotOnOrAfter="2022-02-17T1
6:07:34.617Z">
<saml2:AudienceRestriction>
<saml2:Audience>BankConnector</saml2:Audience>
</saml2:AudienceRestriction>
</saml2:Conditions>
<saml2:AuthnStatement AuthnInstant="2022-02-17T16:02:34.617Z" SessionIndex="id164
5113754615.2049323137">
<saml2:AuthnContext>
<saml2:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspec
ified</saml2:AuthnContextClassRef>
</saml2:AuthnContext>
</saml2:AuthnStatement>
<saml2:AttributeStatement>
<saml2:Attribute Name="profiles" NameFormat="urn:oasis:names:tc:SAML:2.0:attr
name-format:unspecified">
<saml2:AttributeValue
xmlns:xs="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:st
ring">configurator,operator
</saml2:AttributeValue>
</saml2:Attribute>
</saml2:AttributeStatement>
</saml2:Assertion>

Single Sign-on (SSO) – 75

Trax – Bank Connector user guide

6 Channel management
6.1 Concepts

Bank Connector is the messaging hub where all payments streams between backend applications and the
banks are processed in a centralized manner.
To configure message exchanges between endpoints in Bank Connector, you will set up outgoing and
incoming message flows. The outgoing flow manages the sending of messages (e.g. MT101,
pain.001.001.03) from the backend application to the bank. The outgoing flow will also process response
messages (ACK, DN) received from the bank. The incoming flow determines how message received from the
bank will be routed to the backend applications.
A message flow consists of a source and a target. The source is the connection through which a message
enters Bank Connector. The connection through which a message leaves Bank Connector is the target. For
the outgoing flow, source and target are configured in the sourceconnection - outgoing and
targetconnection - outgoing. For the incoming flow, the sourceconnection - incoming and targetconnection
- incoming. Response messages on outgoing messages are managed through the outgoingreponse outgoing.
Source and target connections are managed through channels. The connection with a backend application
would typically be set up in a channel that consists of a sourceconnection - outgoing, an outgoingresponse outgoing and a targetconnection - incoming section. The channel that manages the connection with the
bank will consist of a targetconnection - outgoing and a sourceconnection - incoming section.
When a message enters Bank Connector, the source channel will assign a profile to it. The profile will
determine the target channel through which the message will leave Bank Connector.

Channel management – 76

Trax – Bank Connector user guide

6.2 Structure of the channel configuration
6.2.1 Structure of the Channel configuration
Bank Connector ships with channel configuration sample files which you can export and store locally to start
working on your own configuration.
1. Log on to the Bank Connector GUI with profile Configurator
2. Go to Configuration
3. From the list, select TEMPLATES
4. Click Export to download the channel configuration sample files. A ZIP file is saved as TEMPLATES <timestamp>.zip

6.2.1.1 TEMPLATES folder
After unzipping the TEMPLATES archive, you will see the following structure

TEMPLATES
|
|___ FILEACT
|
|
|
| fileact-config
|
| fileact-profile
|
| fileact-route-config
|
|__ FILE-SYSTEM
|
|

Channel management – 77

Trax – Bank Connector user guide

|
| file-system-config
|
|__ FIN
|
|
|
| fin-config
|
| fin-profile
|
| fin-route-config
|
|__ TRAX
|
|
|
| trax-config
|

Each folder represents a channel in Bank Connector and contains the channel specific configuration files.
You can add a channel by adding a folder and configuration files.
In the example below the following channels have been added;
• a second FIN channel FIN-PTSCFRHH
• a QUANTUM channel

TEMPLATES
|
|___ FILEACT
|
|
|
| fileact-config
|
| fileact-profile
|
| fileact-route-config
|
|__ FILE-SYSTEM
|
|
|
| file-system-config
|
|__ FIN
|
|
|
| fin-config
|
| fin-profile
|
| fin-route-config
|
|__ TRAX
|
|
|
| trax-config
|
|__ FIN-PTSCFRHH
|
|
|
| fin-config
|
| fin-profile
|
| fin-route-config
|
|__ QUANTUM
|
|
|
| quantum-config

Channel management – 78

Trax – Bank Connector user guide

|

The following constraints have to be taken into consideration when creating new channels:
• The configuration file names (fin-config, fin-profile and fin-route-config) have to remain the same.
• When adding a channel of a type that already exists, as in the example above, the FIN-FIN-PTSCFRHH
channel, the directory name has to be structured as [known channel name]+ hyphen + [suffix].
The suffix can be any string but the length and allowed characters are restricted to:
• max length and characters allowed for a directory name on Windows
• max length and characters allowed for a directory name on Linux
• max length and characters allowed in a HTTP URL
• It is also possible to add a new channel, such as QUANTUM in the example above. The name of the
channel can be freely chosen but the same restrictions apply. The general configuration file inside the
directory has the same name as the directory with -config.yml appended.

6.2.1.2 Channel configuration file structure
The format of the channel configuration files is YAML. Below is an example of a trax-config.yml file.
The YAML file is structured through indentation, each subsection is marked by the two whitespaces.
Properties are specified through key/value pairs. (The structure is key: value; the colon after the key always
needs to followed by a whitespace.) A list is always preceded by a hyphen.
Comments can be added to the YAML file, a comment starts with a hash/pound sign.

trax:
default: # each subsection is marked by two whitespaces
sourceconnection:
outgoing:
brokerurl: "tcp://127.0.0.1:61617?sslEnabled=true&randomize=false" #
properties are specified through key value pairs
uri: "JMS:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"
outgoingresponse:
outgoing:
brokerurl: "tcp://127.0.0.1:61617?sslEnabled=true&randomize=false"
uri: "jms-resp:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
targetconnection:

Channel management – 79

Trax – Bank Connector user guide

incoming:
brokerurl: "tcp://127.0.0.1:61617?sslEnabled=true&randomize=false"
uri: "JMS:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
- incoming: # a list is preceded by a hyphen
profile: "MT940"
- incoming:
profile: "MT942"

Channel configuration file types
Depending on the type of channel, the following configuration file types are required

1

2

3

Channel Type

Configuration file type

Examples

All

[channel type]-config

fin-config.yml

This file contains the general targetconnection
and sourceconnection parameters. These
parameters are connection method specific.

trax-config.yml

[channel type]-profile

fin-profile.yml

This file contains the MT header and footer
parameters and the XMLv2 PDU parameters to
be added to outgoing messages

fileact-profile.yml

[channel type]-route-config

fin-route-config.yml

This file contains the MT header parameters
and the XMLv2 PDU parameters on the basis
of which a profile will assigned to incoming
messages

fileact-route-config.yml

FIN / FileAct

FIN / FileAct

file-system-config.yml
api-config.yml

6.2.1.3 Structure of the configuration file
The configuration file structure depends on the channel type and the connection method.

6.2.2 Viewing the channel configuration details and history
You can view the details of the channel configuration files and the configuration changes that took place
over time in the Bank Connector GUI

Channel management – 80

Trax – Bank Connector user guide

1. Log on to the Bank Connector GUI with profile Configurator
2. Go to Configuration
3. Select one of the imported channel configurations from the list
4. Select one of the channels from the channels list. Changes compared to the previous imported
version are highlighted with icons
• Warning icon: the configuration file has been updated
• Plus icon: the configuration file has been added
• X icon: the configuration file has been deleted
5. Select one of the configuration items to see the configuration file contents
Clicking the Channel Configuration type will show the contents of the [channel type]-config file. The
Profile Configuration will show the contents of the [channel type]-profile file and the Incoming Routing
the contents of the [channel type]-route-config file.
A split screen compares what has been added, deleted or modified between the current active
configuration files (left side panel) and the imported ones (right side panel). Added or modified lines are
highlighted in green. Lines that have been removed or changed are highlighted in red.

6.3 Importing and exporting channel configuration
6.3.1 Importing and exporting channel configuration
A Bank Connector user who has the configurator profile can export and import channel configuration via the
GUI.

Channel management – 81

Trax – Bank Connector user guide

6.3.1.1 Exporting channel configuration
1. Go to the Configuration screen.
2. Select the channel configuration you want to export from the list and then click Export .

A zipped folder containing all channel configuration files will be downloaded. See Structure of the
channel configuration (see page 77) for more more information on the contents of the .zip folder.

6.3.1.2 Importing channel configuration
1. Go to the Configuration screen.
2. click Choose file
A dialogue box will open from where you can select channel configuration to import. Only files with the
extension .zip can be imported.

Note 1
When importing channel configuration, the .zip folder cannot contain any subfolders. You should
create the .zip file from the individual channel folders instead of compressing their parent folder.

Channel management – 82

Trax – Bank Connector user guide

Note 3
Do not delete files or directories from the exported .zip file, or add files or directories to it. Do not
move any YAML files into or out of the directories. If a wrong configuration has been imported
(for instance, a .zip file only containing the channel in which configuration changes have been
made), you can export the previous version, re-apply the configuration changes and import the
corrected .zip file again.

Note 4
The newly imported configuration will not be activated automatically. The channel that has been
modified has to be restarted.

6.3.1.3 Troubleshooting
The following errors can occur during the import of channel configuration

Channel management – 83

Trax – Bank Connector user guide

Error

Description

Solution

Invalid File Type

Only the .zip format is supported

Make sure that the
configuration has been
zipped

ZIP could not be imported

The structure of .zip file is not correct.

See Note 1 on how to
create the .zip file

The configuration is
successfully uploaded
but the channel is not
visible anymore in the
channel tab

This is probably caused by an error in the
structure of the one of the configuration files.
Check the logs for more information and
review the recent configuration changes in the
configuration tab.

Correct the error and
upload the configuration
again

The configuration is
successfully uploaded
but only the incoming or
outgoing connection is
visible in the channel tab

This is probably caused by an unknown or
incorrectly spelled property in one of the
configuration files. Check the logs for more
information and review the recent
configuration changes in the configuration.

Correct the error and
upload the configuration
again

6.3.2 Importing certificates and keystores
Certificates and keystores that are used for securing connections, can be imported in Bank Connector
together with the channel configuration files.
1. Go to the Configuration Screen
2. Export and unzip the channel configuration
3. Add a KEYS folder and store the keys that have to be imported in the KEYS folder. The names of the
keys must match exactly with the names with which the keys are referenced in the channel
configuration.
4. Create a .zip file with the KEYS folder included, and import the .zip file
5. Go to the Keys screen to check that the keys have been correctly imported in Bank Connector. If you
select any of the keys in the list, this will display a list of channels and configuration files in which that
key is referenced. This list will be empty If there is a discrepancy between the name of the key and its
reference in the channel configuration.

Channel management – 84

Trax – Bank Connector user guide

For security reasons, keys cannot be exported.
Importing a new version of an existing key can be done by importing the key with the same
name. The new version of the key will become active after a channel restart.

6.4 Change approval on channel configuration
When setting change approval on configuration changes, the configuration has to be approved by a second
user with the role configurator. If the approval workflow is active, then only approved channel configuration
updates can be activated.
Change approval on channel configuration is configured through the following application property

Application Property

Description

Default value

configuration.change.approval

specifies the number of approvals
required

0

The Bank Connector service has to be restarted to activate or deactivate the approval workflow.
Modifications to the approval workflow process, for instance deactivating the approval workflow, will only
take effect as from the next imported channel configuration. A channel configuration that is still in a pending
state, will still need to be processed through the workflow.
1. Go to the Configuration screen

Channel management – 85

Trax – Bank Connector user guide

2. Select the configuration from the list that is pending for approval.
3. Click Approve or Reject. The Approve button will not be available for the configurator who has
imported the configuration or has already approved it in case more than 1 approval is required.

The approved configuration will not be activated automatically. See Stopping and starting
channels56 to activate the new configuration.

As long as a channel configuration is pending for approval, no new channel configuration can be
imported.

6.5 Stopping and starting channels
Bank Connector configurators can stop and start channels from the channels tab. When stopping or starting
a channel, both the incoming and outgoing flows are stopped and started.
1. Log on to Bank Connector with role "configurator" and go to the Channels screen.
2. Select the channel that you want to start or stop from the list and click the Start or Stop button in the
top right corner.

5 https://wiki.fisglobal.com/display/trax/ChannelMgt+-+Stopping+and+starting+channels+-+current
6 https://wiki.fisglobal.com/display/trax/ChannelMgt+-+Stopping+and+starting+channels+-+current

Channel management – 86

Trax – Bank Connector user guide

Whenever a new configuration has been imported and has been approved (only if change approval on
channel configuration is active), the channel screen highlight the changes that will become active once the
channel is restarted. The following icons are used to show the differences:
Warning icon: the channel has been updated.
Plus icon: an incoming or outgoing routing has been added.
X icon : an incoming or outgoing routing has been deleted.

Channel management – 87

Trax – Bank Connector user guide

Before stopping a channel, make sure that there are no in-flight messages, incoming or outgoing.
You can check this by going to the message tab and check if all the messages for the channel
are in a final state.

6.6 Channel downtime
Through the scheduler, channels can be stopped and restarted automatically on a regular interval, for
instance to determine a downtime window during which maintenance activities can be done.

6.6.1 Downtime of Swift and the two FIS Swift Service Bureaus
Below is the window table for Swift itself, and the SSB services:

SSB
team

ET (or EST)

CET (or CEST)

IST

Swift
main

Saturday 09:00 AM ET to
11:00 PM ET

Saturday 15:00 CET to
Sunday 5:00 AM CET

Saturday 7:30 PM IST to
Sunday 09:30 AM IST

SSB US

Saturday 08:00 AM ET to
11:30 PM ET

Saturday 14:00 CET to
Sunday 5:30 CET

Saturday 6:30 PM IST to
Sunday 10:00 AM IST

SSB
EMEA

Saturday 11:00 AM ET to
4:00 PM ET

Saturday 17:00 CET to
Saturday 22:00 CET

Saturday 9:30 PM IST to
Sunday 2:30 AM IST

6.6.2 Configuration of channel downtime
The channel downtime is set up in the SYSTEMEVENT channel.
1. Export the latest configuration that has been imported.
2. Unzip the downloaded archive.
3. Add a folder "SYSTEMEVENT" and create the scheduler-config.yml file in it.

TEMPLATES
|
|___ FILEACT

Channel management – 88

Trax – Bank Connector user guide

|
|
|
| fileact-config
|
| fileact-profile
|
| fileact-route-config
|
|__ FILESYSTEM
|
|
|
| filesystem-config
|
|__ FIN
|
|
|
| fin-config
|
| fin-profile
|
| fin-route-config
|
|__ TRAX
|
|
|
| trax-config
|
|__ SYSTEMEVENT
|
|
|
| scheduler-config
|

• Set up the scheduler-config file according to below examples.
• Zip the channel folder structure again and import the configuration

Channel management – 89

Trax – Bank Connector user guide

• Go to Channels and start the SYSTEMEVENT channel.

6.6.2.1 scheduler-config.yml
The scheduler-config.yml file specifies the channel downtimes. In the example below, the following channel
downtime schedule is configured:
• The TRAX channel stops every week on Saturday at 02:30PM and restarts every Sunday at 05:30PM
• The FIN and FILEACT channel stop every week on Saturday at 02:00PM and restart every Sunday at
05:00PM.

The times have to be expressed in the time zone of your server.

scheduler configuration (sample)

schedulers:
- scheduler:
# stop the FIN and FileAct channel every Saturday at 02:50PM
service: StopChannelScheduleServiceImpl
cron: 0 50 14 ? * 6
arguments: channels=FIN;FILEACT
- scheduler:
# stop the TRAX channel every Saturday at 02:50PM
service: StopChannelScheduleServiceImpl
cron: 0 50 14 ? * 6
arguments: channels=TRAX
- scheduler:
# start the FIN and FileAct channel every Saturday at 10:30PM
service: StartChannelScheduleServiceImpl
cron: 0 30 22 ? * 6
arguments: channels=FIN;FILEACT
- scheduler:
# start the TRAX channel every Saturday at 10:30PM
service: StartChannelScheduleServiceImpl
cron: 0 30 22 ? * 6
arguments: channels=TRAX

Channel management – 90

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

service

Must be StopChannelScheduleServiceImpl for stopping a channel
and

M

StartChannelScheduleServiceImpl for starting a channel
cron

time in server time zone at which the channel is started or
stopped.

M

Only spring cron expressions (6 fields) are accepted
arguments

The channel or list of channels to be stopped or started.

M

6.6.3 Monitoring the channel downtime activity
The channel downtime scheduler events are stored in the bankconnector-scheduler-activity.log file.
The logs are stored in <Bank Connector install directory>\wildfly\standalone\log.

6.7 Validation of channel configuration
After manually editing channel configuration files, the validation function can check the configuration files
whether all mandatory properties are present, and the syntax of the properties. Currently, channel
configuration validation is available for the FIN and FileAct channel.
The validation settings are defined in the following files (by default located in <release-dir>/wildfly/modules/
com/scotty/scotty-web/main/config/)

file

description

fin-validator-properties

contains the validation settings for the properties of the finprofile and fin-route-config configuration file.

fileact-validator-properties

contains the validation settings for the properties of the
fileact-profile configuration file

filact-route-validator-properties

contains the validation settings for the properties of the
fileact-route-config configuration file

finplus-validator-properties

contains the validation settings for the properties of the
fileact-profile configuration file

Channel management – 91

Trax – Bank Connector user guide

file

description

finplus-route-validator-properties

contains the validation settings for the properties of the
finplus-route-config configuration file

For each property, you can set if the property is mandatory or not and check the syntax using regex
validation.

6.7.1 FIN profile validation
Property

Mandat
ory

Regex

mqmessagetype

false

priority

false

applicationidentifier

true

[AFLXIH]{1}

serviceidentifier

true

(01|02|03|05|06|12|13|14|15|21|22|23|25|26|33|35|42|43|NF|IS){1}

logicalterminaladdr
ess

true

[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}

sessionnumber

true

[0-9]{4}

sequencenumber

false

[0-9]{6}

inputoutputidentifie
r

true

[IO]{1}

messagetype

true

[0-9]{3}

receiversaddress

false

[A-Z0-9]{12}

messagepriority

false

[SUN]{1}

deliverymonitoring

false

[123]{1}

Channel management – 92

Trax – Bank Connector user guide

Property

Mandat
ory

Regex

obsolescenceperio
d

false

[0-9]{3}

inputtime

false

[0-9]{4}

messageinputrefere
nce

false

[0-9]{6}[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}[0-9]{4}[0-9]{6}

outputdate

false

[0-9]{6}

outputtime

false

[0-9]{4}

bankingpriority

false

[a-zA-Z0-9]{4}

servicecode

false

[A-Z]{3}

messageuserrefere
nce

false

[\\/\\-\\?:\\(\\)\\.,'\\+A-Za-z0-9]{1,16}

validationflag

false

[a-zA-Z0-9]{1,8}

addresseeinformati
on

false

[\\/\\-\\?:\\(\\)\\.,'\\+A-Za-z0-9]{1,32}

userinformationcod
e

true

[0-9]{3}

113

false

[a-zA-Z0-9]{4}

103

false

[A-Z]{3}

119

false

[a-zA-Z0-9]{1,8}

115

false

[\\/\\-\\?:\\(\\)\\.,'\\+A-Za-z0-9]{1,32}

108

false

[\\/\\-\\?:\\(\\)\\.,'\\+A-Za-z0-9]{1,16}

Channel management – 93

Trax – Bank Connector user guide

Property

Mandat
ory

Regex

trailerinformationco
de

true

[A-Z0-9]{3}

MAC

false

[A-F0-9]{8}

PAC

false

[A-F0-9]{8}

CHK

false

[A-F0-9]{12}

TNG

false

[A-Z]{0}

PDE

false

([0-9]{4}[0-9]{6}[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}[0-9]{4}
[0-9]{6}){0,1}

SYS

false

([0-9]{4}[0-9]{6}[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}[0-9]{4}
[0-9]{6}){0,1}

PDM

false

([0-9]{4}[0-9]{6}[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}[0-9]{4}
[0-9]{6}){0,1}

DLM

false

[A-Z]{0}

MRF

false

[0-9]{6}[0-9]{6}[0-9]{6}[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}
[0-9]{4}[0-9]{6}

sblockinformationc
ode

false

[A-Z0-9]{3}

6.7.2 FIN route config validation
Property

Mandat
ory

routingsequence

true

targetprofile

true

Regex

Channel management – 94

Trax – Bank Connector user guide

Property

Mandat
ory

Regex

applicationid

false

[AFLXIH]{1}

serviceid

false

(01|02|03|05|06|12|13|14|15|21|22|23|25|26|33|35|42|43|NF|IS){1}

senderlt

false

[A-Z0-9]{12}|[A-Z0-9]{1,12}(\\.\\*){1}|\\[[A-Z]\\-[A-Z]\\d\\-\\d\\]\\{12\\}

receiverlt

false

[A-Z0-9]{12}|[A-Z0-9]{1,12}(\\.\\*){1}|\\[[A-Z]\\-[A-Z]\\d\\-\\d\\]\\{12\\}

incomingmessaget
ype

false

[0-9]{3}|^(MT){1}[0-9]{0,3}(\\.\\*){1}|^[0-9]{1,3}(\\.\\*){1}

incomingmessage
priority

false

[SUN]{1}

6.7.3 FileAct profile validation
Property

Mandatory

service

true

requesttype

true

senderdn

true

receiverdn

true

priority

false

ispossibleduplicate

false

isnotificationrequested

false

notificationrequesttype

false

Channel management – 95

Trax – Bank Connector user guide

Property

Mandatory

notificationresponderdn

false

transferdescription

false

transferinfo

false

filedescription

false

fileinfo

false

issigningrequested

false

isnrrequested

false

filedigestalgorithm

false

filelogicalname

false

pduuri

false

6.7.4 FileAct route config validation
Property

Mandatory

targetprofile

true

service

false

requesttype

false

sender

false

receiver

false

Channel management – 96

Trax – Bank Connector user guide

Property

Mandatory

priority

false

transferdescription

false

transferinfo

false

filedescription

false

fileinfo

false

6.7.5 Sample file

Example of fin-validator-properties file

fin:
# mqOptions:
- property:
propertyName: "mqmessagetype"
isMandatory: "false"
- property:
propertyName: "priority"
isMandatory: "false"
#basicHeaderBlock:
- property:
propertyName: "applicationidentifier"
isMandatory: "true"
regexFormat: "[AFLXIH]{1}"
- property:
propertyName: "serviceidentifier"
isMandatory: "true"
regexFormat: "(01|02|03|05|06|12|13|14|15|21|22|23|25|26|33|35|42|43|NF|IS)
{1}"
- property:
propertyName: "logicalterminaladdress"
isMandatory: "true"
regexFormat: "[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}[A-Z0-9]{1}[A-Z0-9]{3}"
- property:
propertyName: "sessionnumber"
isMandatory: "true"
regexFormat: "[0-9]{4}"
- property:

Channel management – 97

Trax – Bank Connector user guide

propertyName: "sequencenumber"
isMandatory: "false"
regexFormat: "[0-9]{6}"
#applicationHeaderBlock:
- property:
propertyName: "inputoutputidentifier"
isMandatory: "true"
regexFormat: "[IO]{1}"
- property:
propertyName: "messagetype"
isMandatory: "true"
regexFormat: "[0-9]{3}"
- property:
propertyName: "receiversaddress"
isMandatory: "false"
regexFormat: "[A-Z0-9]{12}"
...

Changes to the validation settings require a restart of the Bank Connector service.

6.7.6 Troubleshooting errors
If the edited incoming or outgoing connection is not visible in the FIN or FileAct channel in the Channels tab,
then search the logs for the following type of errors:

Channel management – 98

Trax – Bank Connector user guide

7 Trax connection
7.1 Configuration in Bank Connector
7.1.1 trax-config.yml file
The Trax channel configuration is set up in the trax-config.yml file. You can follow the steps in Configuring
channels to get access to the file.
The Trax channel is pre-defined in Bank Connector during the installation of Bank Connector. Changes to the
sourceconnection - outgoing, outgoingresponse - outgoing and targetconnection - incoming sections are
required only:
• if Bank Connector and Artemis ActiveMQ do not run on the same node; in that case, the brokerurl ip
address has to be updated to point to the node where the Artemis instance is running.
• if you use a custom keystore and truststore to secure the connection between Artemis and Bank
Connector.
The targetconnection - incoming - profiles have to match with the targetProfiles defined in the incoming
profiles of the Bank Connector integration channel. See configuration in Trax on how to set up the incoming
profiles.

Trax-config file

trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"
outgoingresponse:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"

Trax connection – 99

Trax – Bank Connector user guide

keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
targetconnection:
incoming:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
- incoming:
profile: "MT940"
- incoming:
profile: "MT942"
- incoming:
profile: "camt.053"
- incoming:
profile: "unicredit-camt053-ebics"
targetprotocol: "Swift-FileAct"

7.1.1.1 sourceconnection - outgoing
The sourceconnection - outgoing specifies the JMS connection details for sending messages from Artemis
to Bank Connector.

Property

Description

Mandator
y/
Optional

brokerurl

Host IP and listener port of the Artemis ActiveMQ server. The structure is
"tcp://host:port?sslEnabled=true&randomize=false7".

M

uri

The value has to be "jms-source:trax.toTSGQueue".

M

truststore

Name of the SSL truststore. It has to correspond to the name with which
the truststore was imported.

M

To be updated only if you do not want to use the default truststore /
truststore password that are provided when installing Bank Connector.

7 tcp://hostport?sslEnabled=true&randomize=false

Trax connection – 100

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

truststorepassw
ord

Password of the SSL truststore. The password has to be AES encrypted.
The structure of the property is "{AES}<encrypted password>".

M

To be updated only if you do not want to use the default truststore /
truststore password that are provided when installing Bank Connector.
keystore

Name of the SSL keystore. It has to correspond to the name with which
the keystore was imported.

M

To be updated only if you do not want to use the default keystore /
keystore password that are provided when installing Bank Connector.
keystorepasswo
rd

Password of the SSL keystore. The password has to be AES encrypted.
The structure of the property is "{AES}<encrypted password>".

M

To be updated only if you do not want to use the default keystore /
keystore password that are provided when installing Bank Connector.
responseprofile

The name has to correspond to the name of the profile specified in the
outgoingresponse settings. See Response messages on outgoing
messages for more information on the default settings.

M

encryptkeyfile

Name of the keystore containing the AES symmetric key used to decrypt
the outgoing messages from Trax. It has to correspond to the name with
which the keystore was imported.

M

To be updated only if you do not want to use the default trax.jceks
keystore provided when installing Bank Connector.
encryptkeypass
word

Password of the encryptkeyfile. The password has to be AES encrypted.
The structure of the property is "{AES}<encrypted password>".

M

7.1.1.2 outgoingresponse - outgoing
The outgoingresponse - outgoing specifies
• the JMS connection details for sending response messages on outgoing messages from Bank
Connector to Artemis
• the response subscriptions that detail on how response messages will be processed in bank
Connector and Trax. See Response subscriptions for more details.

Trax connection – 101

Trax – Bank Connector user guide

Propert
y

Description

Mandatory
/ Optional

brokeru
rl

Host IP and listener port of the Artemis ActiveMQ server. The structure is "tcp://
host:port?sslEnabled=true&randomize=false8".

M

uri

the value has to be "jms-response:trax.fromTSGQueue?
exchangePattern=InOnly"

M

truststo
re

Name of the SSL truststore. It has to correspond to the name with which the
truststore was imported.

M

To be updated only if you do not want to use the default truststore / truststore
password that are provided when installing Bank Connector.
truststo
repass
word

Password of the SSL truststore. The password has to be AES encrypted. The
structure of the property is "{AES}<encrypted password>".

keystor
e

Name of the SSL keystore. It has to correspond to the name with which the
keystore was imported.

M

To be updated only if you do not want to use the default truststore / truststore
password that are provided when installing Bank Connector.
M

To be updated only if you do not want to use the default keystore / keystore
password that are provided when installing Bank Connector.
keystor
epassw
ord

Password of the SSL keystore. The password has to be AES encrypted. The
structure of the property is "{AES}<encrypted password>".

profile

Identifies a list response subscriptions.

M

To be updated only if you do not want to use the default keystore / keystore
password that are provided when installing Bank Connector.
M

The name has to correspond to the name of the responseprofile specified in the
sourceconnection - outgoing settings.

8 tcp://hostport?sslEnabled=true&randomize=false

Trax connection – 102

Trax – Bank Connector user guide

7.1.1.3 targetconnection - incoming
Propert
y

Description

Mandatory
/ Optional

brokeru
rl

Host IP and listener port of the Artemis ActiveMQ server. The structure is "tcp://
host:port?sslEnabled=true&randomize=false9".

M

uri

the value has to be "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"

M

truststo
re

Name of the SSL truststore. It has to correspond to the name with which the
truststore was imported.

M

To be updated only if you do not want to use the default truststore / truststore
password that are provided when installing Bank Connector.
truststo
repass
word

Password of the SSL truststore. The password has to be AES encrypted. The
structure of the property is "{AES}<encrypted password>".

keystor
e

Name of the SSL keystore. It has to correspond to the name with which the
keystore was imported.

M

To be updated only if you do not want to use the default truststore / truststore
password that are provided when installing Bank Connector.
M

To be updated only if you do not want to use the default keystore / keystore
password that are provided when installing Bank Connector.
keystor
epassw
ord

Password of the SSL keystore. The password has to be AES encrypted. The
structure of the property is "{AES}<encrypted password>".

encrypt
keyfile

Name of the keystore containing the AES symmetric key used to encrypt the
incoming messages to Trax. It has to correspond to the name with which the
keystore was imported.

M

To be updated only if you do not want to use the default keystore / keystore
password that are provided when installing Bank Connector.
M

To be updated only if you do not want to use the default trax.jceks keystore
provided when installing Bank Connector.
encrypt
keypass
word

Password of the encryptkeyfile. The password has to be AES encrypted. The
structure of the property is "{AES}<encrypted password>".

M

9 tcp://hostport?sslEnabled=true&randomize=false

Trax connection – 103

Trax – Bank Connector user guide

7.1.1.4 List of target profiles
Property

Description

Mandatory
/ Optional

profile

Incoming profile code. The entries have to match with the targetprofiles
that are defined in the fin-route-config and fileact-route-config file. These
profiles will be forwarded as JMS parameter to Trax and will be used to
route the message into the correct Trax workflow.

M

targetproto
col

In Trax versions older than 7.12.0, incoming messages sent to Trax require
the presence of a JMS parameter "TargetProtocol" with value "Swift-FIN" or
"Swift-FileAct".

O

If the Bank Connector channel through which the message is processed is
FIN or FileAct, this parameter will be added automatically to the message
with the correct value. For other channels such as EBICS or Bank APIs, the
target protocol is not set by default. In order to process the incoming
messages from these channels, a targetprotocol parameter can be
specified with value "Swift-FileAct" which ensures the message will be
processed in Trax.
For Trax versions as from 7.12, the target protocol is no longer required and
does not have to be specified in the target profile.

7.1.2 Response subscriptions
7.1.2.1 Default response subscriptions
The response subscriptions define how responses on outgoing messages will be processed in Bank
Connector.
There are three different ways of processing response messages in Bank Connector:
• Event : An event as an intermediate response. They are logged for information purpose only and do
not trigger an update of the status of the message to SENT or FAILED. In Bank Connector they will be
visible in the data history section of the outgoing message. The event is also forwarded to Trax.
There it will be stored as incoming transmission and linked to the original outgoing communication.
• Response : the message is considered as a final response. It will update the status of the outgoing
message in Bank Connector to SENT or FAILED and will also be forwarded to Trax where it will trigger
a status update of the payment from "SENDING" to "SENT" or SENDING FAILED".
• Request : By default, response messages are reconciled with outgoing messages and will be
forwarded to Trax as events or responses. It is however possible to forward the response message to
Trax as a new incoming message. This is done typically if a back office application requires the
response message for reconciliation purposes.

Trax connection – 104

Trax – Bank Connector user guide

Bank Connector has a default set of subscription options for processing response messages for Swift FIN
and FileAct. The response subscriptions only have to be defined in the outgoingresponse - outgoing section
in case custom response subscriptions are needed.
For FIN and FileAct service, the default setup is:

Service

response message

type

status update

FIN

ACK, NetworkedAcked

Response

SENT

FIN and FileAct

NAK,
NetworkNacked, MessageStatusErr
or

Response

FAILED

FileAct

Positive delivery notification
(RcvDelivered)

Response

SENT

FileAct

Negative delivery notification
(RcvAborted,RcvDelayedNak,RcvFC
PReleased,RcvOverdue,RcvUnknow
n)

Response

FAILED

In configuration format (please note that this is hardcoded in the application), the default "response
subscriptions" look like this:

outgoingresponse:
outgoing:
brokerurl: "tcp://10.58.98.105:61617?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
subscriptions:
- subscription:
filter: "NetworkNacked,NAK,MessageStatusError"
code: "RESPONSE"
order: "true"
status: "FAILED"
- subscription:
filter: "ACK,NetworkAcked"
code: "RESPONSE"
order: "true"
status: "SENT"

Trax connection – 105

Trax – Bank Connector user guide

source: "FIN"
- subscription:
filter: "NetworkAcked"
code: "EVENT"
order: "true"
source: "FileAct"
- subscription:
filter: "RcvDelivered"
code: "RESPONSE"
order: "true"
status: "SENT"
source: "FileAct"
- subscription:
filter: "RcvAborted,RcvDelayedNak,RcvFCPReleased,RcvOverdue,RcvUnknown"
code: "RESPONSE"
order: "true"
status: "FAILED"
source: "FileAct"

You can view the currently active subscriptions in Bank Connector. Go to Channels → TRAX → Outgoing /
default response. The subscriptions are listed under response subscriptions.

Trax connection – 106

Trax – Bank Connector user guide

7.1.2.2 Common examples of custom response subscriptions
• Bank does not send Delivery Notifications for FileAct
Banks do not always send delivery notifications for FileAct. In that case the NetworkAcked will be
considered as a final response and will update the status of the message to SENT. Modify the
subscriptions in the outgoingresponse - outgoing section in the trax-config file as follows:

trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"
outgoingresponse:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
# The delivery notification subscriptions with filters "RCVDelivered" and
"RcvAborted,RcvDelayedNak,RcvFCPReleased,RcvOverdue,RcvUnknown" have to be removed
subscriptions:
- subscription:
filter: "NetworkNacked,NAK,MessageStatusError"
code: "RESPONSE"
order: "true"
status: "FAILED"
# an ACK or NetworkAcked message will update the status of the message to SENT for
both FIN and FileAct
- subscription:
filter: "ACK,NetworkAcked"
code: "RESPONSE"
order: "true"
status: "SENT"
targetconnection:
incoming:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"

Trax connection – 107

Trax – Bank Connector user guide

truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
- incoming:
profile: "MT940"
- incoming:
profile: "MT942"
- incoming:
profile: "camt.053"

• FIN MT011 delivery notification
For FIN service, it is possible to request a delivery notification (MT011) next to the ACK message. In the
following setup, the MT011 will be processed as a response and update the status of the message to
SENT. The ACK is considered as an event message. Add the following subscriptions to the
outgoingresponse - outgoing section in the trax-config file.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"
outgoingresponse:
outgoing:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
# add these subscriptions to the outgoingresponse - response section
subscriptions:
- subscription:
filter: "NetworkNacked,NAK,MessageStatusError"
code: "RESPONSE"
order: "true"
status: "FAILED"
# an ACK message will be processed as an EVENT for both FIN and FileAct

Trax connection – 108

Trax – Bank Connector user guide

- subscription:
filter: "ACK,NetworkAcked"
code: "EVENT"
# the delevery notification (MT011) will be processed as RESPONSE for FIN.
- subscription:
filter: "MT011"
code: "RESPONSE"
order: "true"
status: "SENT"
source: "FIN"
- subscription:
filter: "RcvDelivered"
code: "RESPONSE"
order: "true"
status: "SENT"
source: "FILEACT"
- subscription:
filter: "RcvAborted,RcvDelayedNak,RcvFCPReleased,RcvOverdue,RcvUnknown"
code: "RESPONSE"
order: "true"
status: "FAILED"
source: "FILEACT"
targetconnection:
incoming:
brokerurl: "tcp://localhost:61817?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: ar-keystore.jks
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
- incoming:
profile: "MT940"
- incoming:
profile: "MT942"
- incoming:
profile: "camt.053"

• Sending ACK as event and request to Bank Office
In the following setup an ACK response will be forwarded to Trax as a response and as a request at the
same time. The request will be processed in Trax as a new incoming message.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"

Trax connection – 109

Trax – Bank Connector user guide

uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"
outgoingresponse:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: ar-keystore.jks
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "efault_response"
# add these subscriptions to the outgoingresponse - response section
subscriptions:
- subscription:
filter: "NetworkNacked,NAK,MessageStatusError"
code: "RESPONSE"
order: "true"
status: "FAILED"
- subscription:
filter: "ACK,NetworkAcked"
code: "RESPONSE"
status: "SENT"
order: "true"
source: "FIN"
# An ACK message will be processed as a new request and will be assigned
targetprofile ACKREQUEST
- subscription:
filter: "ACK"
code: "REQUEST"
targetprofile: "ACKREQUEST"
- subscription:
filter: "RcvDelivered"
code: "RESPONSE"
order: "true"
status: "SENT"
source: "FILEACT"
- subscription:
filter: "RcvAborted,RcvDelayedNak,RcvFCPReleased,RcvOverdue,RcvUnknown"
code: "RESPONSE"
order: "true"
status: "FAILED"
source: "FILEACT"
targetconnection:
incoming:

Trax connection – 110

Trax – Bank Connector user guide

brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
- incoming:
profile: "MT940"
- incoming:
profile: "MT942"
- incoming:
profile: "MT900"
- incoming:
profile: "MT671"
- incoming:
profile: "JPM_CAMT53"
- incoming:
profile: "ACKREQUEST"
# The targetprofile has to be added to the targetconnection - incoming section as
well to route the ACK message to Trax

• Sending the event and response to Trax with a custom target protocol.
In trax versions older than 7.12.0, the event or response message sent to trax requires the presence of a jms
parameter TargetProtocol with values "Swift-FIN" or "Swift-FileAct". If the bank Connector channel through
which the message is processed is FIN or FileAct, this parameter will be added automatically to the message
with the correct value. For other channels such as ebics or bank api's, the target protocol is not set by
default. In order to process the response messages from these channels, a targetprotocol parameter can be
specified with value "Swift-FileAct" which ensures the response message will be processed in Trax. For trax
versions as from 7.12, the target protocol is no longer required and does not have to be specified in the
response subzscription.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
responseprofile: "default_response"

Trax connection – 111

Trax – Bank Connector user guide

outgoingresponse:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: ar-keystore.jks
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "efault_response"
# "TS01" is an ebics intermediary status sent as event to Trax
subscriptions:
- subscription:
filter: "TS01"
code: "EVENT"
targetprotocol: "Swift-FileAct"
# "DS01" is an ebics final status sent as response to Trax
- subscription:
filter: "DS01"
code: "RESPONSE"
order: "true"
status: "SENT"
targetprotocol: "Swift-FileAct"

Trax connection – 112

Trax – Bank Connector user guide

7.2 Configuration in Trax
7.2.1 The BankConnector integration channel

The BankConnector integration channel is predefined in Trax but the connection parameters such as the
hostname of the node on which the ActiveMQ artemis is running, needs to be specified during the installation
of Trax by means of a set of cli parameters.
Install Trax with the following cli parameters to set up the connection between Trax and ActiveMQ Artemis

cli parameter

Description

bcEnabled

When enabled, a connection to the Artemis ActiveMQ will be made
to be used in integration channel (defaults to false). If not enabled,
all other bcXXX parameters are irrelevant.

bcAddresses

A comma-separated list of IP:port addresses of the Artemis
ActiveMQ nodes.

Trax connection – 113

Trax – Bank Connector user guide

cli parameter

Description

bcTrustStore

The relative( to <release-dir>/cli) or absolute path of a custom
truststore to be used for the connection to a remote Artemis
ActiveMQ. This file will be copied in the WildFly installation folder.
The default WildFly truststore will be used when bcTrustStore is not
provided or blank.

bcTrustStorePass

The password for the bcTrustStore, required when bcTrustStore is
used.
The default WildFly truststore (and password) will be used when
bcTrustStore is not provided or blank.

bcKeyStore

The relative (relative to <release-dir>/cli) or absolute path of a
custom KeyStore to be used for the connection to a remote Artemis
ActiveMQ. This file will be copied in the WildFly installation folder.
The default WildFly keystore will be used when bcKeyStore is not
provided or blank.

bcKeyStorePass

The password for the bcKeyStore, required when bcKeyStore is
used.
The default WildFly keystore (and password) will be used when
bcKeyStore is not provided or blank.

After the Trax installation, the BankConnector integration channel needs to be activated.
Go to Config → System → Internal services. Right-click the Integration Channel Service and select Start
service.

Trax connection – 114

Trax – Bank Connector user guide

7.2.1.1 Outgoing profiles
Outgoing integration channel profiles are defined in Trax for sending messages from Trax to Bank
Connector. When sending a message to Bank Connector, the targetProfile associated with the channel
profile will be assigned to the outgoing message and forwarded to Bank Connector as a JMS parameter.
In Bank Connector, the message will be routed to the FIN or FileAct channel based on the targetProfile. For
each outgoing profile defined in Trax, a corresponding outgoing FIN or FileAct profile has to be set up in
Bank Connector.
Go to Config → Routing → Integration channel → Outgoing Profile

Add a new outgoing profile with the following details

tab

parameter

description

gener
al

code

code of the profile

name

name of the profile

description

small description of the profile

direction

is defaulted to Out

Trax connection – 115

Trax – Bank Connector user guide

tab

para
meter

parameter

description

Active

check this flag to make the profile available

route

has to be BankConnector-out

split script

to be left blank

Acknowledgeme
nt route

to be left blank

targetProfile

the targetProfile is the code that will be exchanged with Bank Connector
and on the basis of which the message will be routed to the FIN or FileAct
channel in Bank Connector

targetProtocol

specifies if the targetprofile is linked to the FIN or FileAct service. Possible
values are Swift-FileAct or Swift-FIN.

SendNumberofTr
ansactions

if set to true, the number of transactions contained in a file will be
exchanged with Bank Connector.
This is only possible if the targetProtocol is Swift-FileAct

Go to Config → Routing → Outgoing routing and select one of the workflows

Trax connection – 116

Trax – Bank Connector user guide

In Routing information, select Integration-Channel as channel, and the outgoing profile created in step 2 as
Profile. The targetProfile associated to this profile will now be forwarded to Bank Connector.

7.2.1.2 Incoming profiles
Incoming profiles are defined in Trax for receiving incoming messages and response messages from Bank
Connector into Trax.
Response messages are processed by the incoming profile BankConnector-connection-in. This profile is
pre-defined in Trax but still needs to be activated.
1. Go to Config → Routing → Integration channel → Incoming profile.
2. Right-click the BankConnector-connection-in profile and check the Active flag.

Trax connection – 117

Trax – Bank Connector user guide

When receiving incoming messages from Bank Connector, a targetProfile associated to the message in Bank
Connector, is forwarded as jms parameter to Trax.
On the basis of the profile, Trax will route the message into one of the workflows, e.g. the statements
workflow. For each incoming profile defined in Trax, a corresponding incoming FIN or FileAct profile has to
be set up in Bank Connector. Check FIN or FileAct for more details on configuring incoming FIN and FileAct
profiles.
Go to Config → Routing → Integration channel → Incoming Profile

Add a new incoming profile with the following details

Trax connection – 118

Trax – Bank Connector user guide

tab

parameter

description

gener
al

code

code of the profile

name

name of the profile

description

small description of the profile

direction

is defaulted to "In"

Active

check this flag to make the profile available

route

to be left blank

split script

to be left blank

Acknowledge
ment route

to be left blank

targetProfile

the targetProfile is the code that will be exchanged with Bank Connector and
on the basis of which the message will be routed into the corresponding
workflow in Trax

targetProtocol

specifies if the targetprofile is linked to the FIN or FileAct service. Possible
values are Swift-FileAct or Swift-FIN.

para
meter

Go to Config → Routing → Incoming routing and select one of the workflows

Trax connection – 119

Trax – Bank Connector user guide

In Routing criteria, select Integration-Channel as channel, and the incoming profile created in step 2 as
Profile. Incoming messages from Bank Connector which have the targetProfile associated to this profile will
now be routed into this worlflow.

7.2.2 Additional routing parameters
For outgoing messages, it is possible provide to Bank Connector additional data or information on how to
process the message. These parameters have to be specified in the integration channel outgoing profile.

The following routing parameters are available for FIN and FileAct

Trax connection – 120

Trax – Bank Connector user guide

Ser
vic
e

Parameter

Description

FIN

EXT_TSGFIN
MUR

defines a custom MessageUserReference (MUR) in Trax that will be set in tag
108 in the Application header block of the FIN message. If no custom value is
provided, Bank Connector will use a timestamp as MUR.

EXT_TSGFINS
enderLT

defines a custom value for the logicalterminaladdress in Trax that will be set in
the basic header of the FIN message. If no value is provided, Bank Connector will
use the value defined in the parameter logicalterminaladdress of the FIN profile

EXT_TSGFINR
eceiverLT

defines a custom value for the receiversaddress in Trax that will be set in the
application header of the FIN message. If no value is provided, Bank Connector
will use the value defined in the parameter receiversaddress of the FIN profile

EXT_TSGFINP
riority

defines a value for the priority in Trax that will be set in the application header of
the FIN message. If no value is provided, Bank Connector will use the value
defined in the parameter messagepriority of the FIN profile

EXT_TSGFINS
kipHeaders

This will allow the header generation in Bank Connector (based on the FIN Flow
Profile) to be skipped and Trax Payments (TP) to send a custom header together
with the payload

EXT_TSGFile
ActLogicalNa
me

defines a custom value for the field FileLogicalName in Trax that will be set in the
XMLv2 PDU message. If no custom value is provided, Bank Connector will
provide a value.

File
Act

Trax connection – 121

Trax – Bank Connector user guide

8 ERP connections
8.1 Scope
Bank Connector can connect to different backend applications using file based channels for outgoing and
incoming messages. Connection is usually made through the camel components sftp, ftp or file.

8.2 Supported message formats
8.2.1 Swift FIN messaging service
For FIN MT messages, Bank Connector requires a correctly formatted FIN RJE block 4 which contains the
payload. Bank Connector will generate the FIN header and footer blocks (RJE message format) or XMLv2
PDU message (XMLv2 message format) based on the FIN profile configuration which is set up in Bank
Connector. Bank Connector does not perform any validations or modifications on the payload.
It is also possible for the back end application to provide the header blocks along with the message text
block (block 4) of the FIN message. In that case, Bank Connector will skip the header generation.

8.2.2 Swift FileAct messaging service
For FileAct payload messages, Bank Connector accepts any message format that can be exchanged over the
FileAct messaging service. Bank Connector will generate the XMLv2 PDU message based on the FileAct
profile configuration which is set up in Bank Connector. Bank Connector does not perform any validations or
modifications on the FileAct payload message?
It is also possible for the backend application to send both XMLv2 PDU message and payload. In that case,
Bank Connector will skip the generation of the PDU message.

8.2.3 Swift FINplus messaging service
For FINplus, Bank Connector requires a correctly formatted ISO20022 XML message. Bank Connector will
generate the FINplus Business Application Header and XMLv2 PDU message based on the FINplus profile
configuration which is set up in Bank Connector.
It is also possible for the backend application to send both ISO20022 XML message and FINplus Business
Application Header. In that case, Bank Connector will not skip the generation of the Business Application
Header.
Bank Connector does not perform any validations or modifications to the ISO20022 XML message, nor to the
FINplus Business Application Header if provided by the backend application.

ERP connections – 122

Trax – Bank Connector user guide

8.2.4 Bank APIs
For Bank APIs, Bank Connector requires a correctly formatted API request body. Bank Connector does not
perform any validations or modifications to the request body.

8.2.5 Bank H2H connections
For host-to-host connections, Bank Connector requires a correctly formatted message as specified by the
bank. Bank Connector does not perform any validations or modifications to the message.

8.3 ERP connection details
8.3.1 SFTP connection details
The connection details are set up in the file-system-config.yml file

file-system-config.yml

filesystem:
sourceconnection:
outgoing:
targetprofile:
actor: "FileConsumerActor"
uri:sftp://hostname:port/path to reception directory>?username=<your
username>&privateKeyPassphrase=<AES encrypted
password>&binary=true&move=processed&stepwise=false&streamDownload=true&readLock=chan
ged&preferredAuthentications=publickey&serverHostKeys=ssh-dss,ecdsa-sha2nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,rsa-sha2-512,rsa-sha2-256,ssh-rsa
privatekey: <private key name>
targetconnection:
- incoming:
profile:
actor: "FileProducerActor"
uri: sftp://hostname:port/path to emission directory>?username=<your
username>&password=<AES encrypted username password>privateKeyPassphrase=<AES
encrypted private key
password>&binary=true&preferredAuthentications=publickey&serverHostKeys=sshdss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,rsa-sha2-512,rsasha2-256,ssh-rsa&fileExist=Fail
privatekey: <private key name>

ERP connections – 123

Trax – Bank Connector user guide

Property

Description

M/O

targetprofile

profile that will be assigned to messages that are
picked up from the reception directory specified in
the uri

M

actor

Value has to be for

M

sourceconnection-outgoing : "FileConsumerActor"
sourceconnection-incoming: "FileProducerActor"
uri - hostname

sftp server hostname

M

this can be the DNS or IP
uri - port

port sftp server is listening on

M

uri - path to reception directory

relative or absolute path to the folder from which
Bank Connector will pick up the files

M

uri - path to emission directory

relative or absolute path to the folder in which Bank
Connector will drop the files&fileName=FIN-$
{date:now:yyyyMMddHHmmssSSS}.xml

M

uri - username

username to log into sftp server - for username /
password authentication

M

uri - password

password to log into sftp server - for username /
password authentication

uri - binary

Determines the file transfer mode

M

Value is "true"
uri - move

Determines the behaviour once the file has been
processed

M

When setting the value to "processed" processed
files will be moved to a "processed" subfolder

ERP connections – 124

Trax – Bank Connector user guide

Property

Description

M/O

uri - readLock

avoids that files are being picked up By Bank
Connector whilst they are still being written to the
reception directory by the backend system

M

By setting this value to "changed", the file length or
modification timestamp is being checked if the file
is ready to be picked up by Bank Connector
uri - preferredAuthentications

Determines which authentication method will be
used

M

When setting the value to "publickey", SSH public
key authentication will be used
When setting the value to "password", username /
password authentication will be used.
uri - serverHostKeys

Sets a comma separated list of algorithms
supported for the server host key.

M

The value has to be set to "ssh-dss,ecdsa-sha2nistp256,ecdsa-sha2-nistp384,ecdsa-sha2nistp521,rsa-sha2-512,rsa-sha2-256,ssh-rsa"
privateKeyPassphrase

password of the SSH private key. The password
can be AES encrypted. The structure of the
property is "{AES}<encrypted password>" - for SSH
public key authentication

M

privateKey

Name of the SSH private key. It has to correspond
to the name with which the key was imported - SSH
public key authentication

M

FileExist

Determines the behaviour if a file with the same
name already exists in the emission directory

M

When setting the value to "Fail", the message will
fail in Bank Connector and will not be written to the
emission directory

8.3.1.1 Securing the AFT / SFTP connection
The connection between Bank Connector and the sftp server can be secured by username/password
authentication or SSH pubic key authentication. The use of SSH public key authentication is strongly
recommended.

ERP connections – 125

Trax – Bank Connector user guide

SSH relies upon the use of a private / public key pair. They are used to authenticate the identity of the user
that wants to access the sftp server. The private key has to be set up in bank Connector, whilst the public key
needs to be stored on the sftp server.
It is set up in Bank Connector by specifying the private key in the targetconnection-outgoing or
sourceconnection-incoming section of the connection details. The name of the key can be freely chosen, but
is is important that it corresponds to the name with which the key has been imported in bank Connector. The
name used typically is id_rsa (default name when using the windows tool ssh-keygen to generate the key).
When generating the key, it is recommended to protect the key with a passphrase. This passphrase is added
to the uri with the queryparameter "privateKeyPassphrase".
Below example shows how to generate the SSH key by running the ssh-keygen command from a command
prompt window:

> ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (C:\Users\e1083346/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):e
Enter same passphrase again:
Your identification has been saved in C:\Users\e1083346\id.rsa
Your public key has been saved in C:\Users\e1083346\id.rsa.pub
The key fingerprint is:
SHA256:u73OOrEkRZ6L9QmhXG8OZ1JWRHuQUoN+4lDkDXqClEk fnfis\e1083346@EMEABRUGQ3NGB3
The key's randomart image is:
+---[RSA 3072]----+
|
.Eo .o*B.
|
|
.+.+o*o.+
|
|
..=oOo.o . |
|
o XoB ..
|
|
+S& +
|
|
o +.=
|
|
o.o
|
|
o+
|
|
o+=.
|
+----[SHA256]-----+

8.3.2 Shared drive connection details
The connection details are set up in the file-system-config.yml file

file-system-config.yml

filesystem:
sourceconnection:
outgoing:
targetprofile:
actor: "FileConsumerActor"
uri:file://path to reception directory?move=processed&readlock=changed

ERP connections – 126

Trax – Bank Connector user guide

targetconnection:
- incoming:
profile:
actor: "FileProducerActor"
uri: file://path to emission directory?fileExist=Fail

Property

Description

M/O

targetprofile

profile that will be assigned to messages that are
picked up from the reception directory specified in the
uri

M

uri - path to reception directory

directory name of the shared folder from which Bank
Connector will pick up the files

M

uri - path to emission directory

directory name of the shared folder in which Bank
Connector will drop the files

M

uri - move

Determines the behaviour once the file has been
processed

M

When setting the value to "processed" processed files
will be moved to a "processed" subfolder
uri - readLock

avoids that files are being picked up By Bank
Connector whilst they are still being written to the
reception directory by the backend system

M

By setting this value to "changed", the file length or
modification timestamp is being checked if the file is
ready to be picked up by Bank Connector
uri - fileExist

Determines the behaviour if a file with the same name
already exists in the emission directory

M

When setting the value to "Fail", the message will fail
in Bank Connector and will not be written to the
emission directory

8.3.2.1 Securing the shared drive connection
The service user which is used to start the Bank Connector service requires Read and Write access to the
shared folder.

ERP connections – 127

Trax – Bank Connector user guide

8.3.3 Setting the reception directory polling frequency
The frequency with which Bank Connector will poll the reception directory to check for new files, can be
configured by adding the property "delay" to the uri. It is expressed in milliseconds.
By default, Bank Connector uses a polling frequency of 500.

filesystem:
sourceconnection:
outgoing:
targetprofile:
actor: "FileConsumerActor"
uri:file://path to reception directory?move=processed&readlock=changed&delay=500

8.3.4 Assigning a targetprofile to an outgoing message based on the filename
Instead of assigning a targetprofile to a message based on the reception directory from where it has been
picked up by Bank Connector, it is also possible to assign the targetprofile based on the filename.
In that case, a query parameter "include" can be added to the uri containing a regex expression.

filesystem:
sourceconnection:
- outgoing:
targetprofile:"Pain.001.HSBC.xml"
actor: "FileConsumerActor"
uri:file://hostname:port/path to reception directory>?username=<your
username>&privateKeyPassphrase=<AES encrypted
password>&binary=true&move=processed&stepwise=false&streamDownload=true&readLock=chan
ged&preferredAuthentications=publickey&serverHostKeys=ssh-dss,ecdsa-sha2nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,rsa-sha2-512,rsa-sha2-256,sshrsa&include=.*.HSBC.*
privatekey:<private key name>

8.3.5 Defining the filename for incoming messages
Bank Connector generates a filename consisting of <15 character string>-<15 character string> (e.g.
82B5193F3ABCC5D-0000000000000000) if no specific filename has been configured.
The filename can be configured by adding the queryparameter "fileName" to the uri in the targetconnectionoutgoing. A fixed filename can be configured or a combination of a fixed string with a dynamic expression.

filesystem:
targetconnection:

ERP connections – 128

Trax – Bank Connector user guide

- incoming:
profile:
actor: "FileProducerActor"
uri: file://path to emission directory?fileExist=Fail&fileName=FIN-$
{date:now:yyyyMMddHHmmssSSS}.xml

The dynamic expression can be a timestamp as in the example above or can be one of message header
parameters. These message header parameters have to be referenced by ${in.header.parameter}

filesystem:
targetconnection:
- incoming:
profile:
actor: "FileProducerActor"
uri: file://path to emission directory?fileExist=Fail&fileName=FIN-$
{in.header.MessageType}.xml

In the example above, The MessageType parameter is taken from an incoming FIN message.

ERP connections – 129

Trax – Bank Connector user guide

9 Swift connections
9.1 FileAct
9.1.1 Scope
FileAct enables the exchange of any file format. It is typically used for large volumes of data such as bulk
payments, account statements or PDF documents.

9.1.2 Supported message formats
The FileAct service uses the XMLv2 message format.

9.1.2.1 XMLv2 message format
The XMLv2 message or Protocol Data Unit message consisting of a technical header, and the message data
or payload are exchanged in two different files. Bank Connector currently supports XMLv2 revision 2.0.14.
When using a soap connection, the payload is added as attachment to the soap request. For SFTP, the
Protocol Data Unit message and the payload are stored in two separate files. To be able to link both files, the
<body> tag of the Protocol Data Unit message contains the filename of the payload file.

sample Protocol Data Unit message exchanged over soap

<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Header>
<SAAHeader xmlns="urn:swift:saa:xsd:soapha" Id="SAAHeader">
<SessionToken>660ecb5b-143a-4254-a69d-c7c9c35c</SessionToken>
<SequenceNumber>8</SequenceNumber>
</SAAHeader>
<wss:Security xmlns:wss="http://docs.oasis-open.org/wss/2004/01/oasis-200401wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/
oasis-200401-wss-wssecurity-utility-1.0.xsd" SOAP-ENV:actor="urn:swift:saa" wsu:Id="I
D_Security">
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/
xml-exc-c14n#"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsigmore#hmac-sha256"/>
<ds:Reference URI="#ID_SOAPforTRAX1">
<ds:Transforms>

Swift connections – 130

Trax – Bank Connector user guide

<ds:Transform Algorithm="http://www.w3.org/2001/10/xmlexc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/
xmldsig#sha1"/>
<ds:DigestValue>7PMrUlApLlZpqHkvRePKmjdvYdU=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>4d1RRhegq3W8//WzcCEmfz6dsxy5HJYPMe6vBv9RZnc=</ds:S
ignatureValue>
<ds:KeyInfo Id="ID_SOAPforTRAX1">
<ds:KeyName>SOAPforTRAX1</ds:KeyName>
</ds:KeyInfo>
</ds:Signature>
</wss:Security>
</SOAP-ENV:Header>
<SOAP-ENV:Body Id="SAAPayload">
<urn:Put xmlns:urn="urn:swift:saa:xsd:soapha">
<urn1:DataPDU xmlns:urn1="urn:swift:saa:xsd:saa.2.0">
<!-- technical header -->
<urn1:Revision>2.0.14</urn1:Revision>
<urn1:Header>
<urn1:Message>
<urn1:SenderReference>240226170419200</urn1:SenderReference>
<urn1:MessageIdentifier>pain.xxx.soapfortrax1</urn1:MessageId
entifier>
<urn1:Format>File</urn1:Format>
<urn1:Sender>
<urn1:DN>ou=itb2,o=ptscfrhh,o=swift</urn1:DN>
</urn1:Sender>
<urn1:Receiver>
<urn1:DN>ou=itb2,o=ptscfrhh,o=swift</urn1:DN>
</urn1:Receiver>
<urn1:InterfaceInfo>
<urn1:UserReference>240226170419200</urn1:UserReference>
</urn1:InterfaceInfo>
<urn1:NetworkInfo>
<urn1:Priority>Normal</urn1:Priority>
<urn1:IsPossibleDuplicate>false</urn1:IsPossibleDuplicate
>
<urn1:IsNotificationRequested>true</urn1:IsNotificationRe
quested>
<urn1:Service>swift.generic.fa!x</urn1:Service>
<urn1:SWIFTNetNetworkInfo>
<urn1:TransferInfo>HR</urn1:TransferInfo>
<urn1:FileInfo>SwCompression=None;CharacterSet=ASCII;
</urn1:FileInfo>
<urn1:NotificationResponderDN>ou=itb2,o=ptscfrhh,o=sw
ift</urn1:NotificationResponderDN>
<urn1:NotificationRequestType>xsys.xxx.delnotif</urn1:
NotificationRequestType>
</urn1:SWIFTNetNetworkInfo>

Swift connections – 131

Trax – Bank Connector user guide

</urn1:NetworkInfo>
<urn1:SecurityInfo>
<urn1:IsSigningRequested>true</urn1:IsSigningRequested>
<urn1:SWIFTNetSecurityInfo>
<urn1:IsNRRequested>true</urn1:IsNRRequested>
</urn1:SWIFTNetSecurityInfo>
</urn1:SecurityInfo>
<urn1:FileLogicalName>sfbvnl2g_ZHRJPM_2442.xml</urn1:FileLogi
calName>
</urn1:Message>
</urn1:Header>
<urn1:Body>sfbvnl2g_ZHRJPM_2442.xml</urn1:Body>
</urn1:DataPDU>
<urn:attachment>attachment1</urn:attachment>
</urn:Put>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

sample Protocol Data Unit message exchanged over SFTP

002395VeUYKr3EUR7lLk3lq7bEXg==<?xml version="1.0" encoding="UTF-8"?>
<Saa:DataPDU xmlns:Saa="urn:swift:saa:xsd:saa.2.0">
<Saa:Revision>2.0.14</Saa:Revision>
<!-- technical header -->
<Saa:Header>
<Saa:Message>
<Saa:SenderReference>2403071635580003</Saa:SenderReference>
<Saa:MessageIdentifier>pain.xxx.tcg</Saa:MessageIdentifier>
<Saa:Format>File</Saa:Format>
<Saa:Sender>
<Saa:DN>ou=itb2,o=ptscfrhh,o=swift</Saa:DN>
</Saa:Sender>
<Saa:Receiver>
<Saa:DN>ou=itb2,o=ptscfrhh,o=swift</Saa:DN>
</Saa:Receiver>
<Saa:InterfaceInfo>
<Saa:UserReference>2403071635580003</Saa:UserReference>
</Saa:InterfaceInfo>
<Saa:NetworkInfo>
<Saa:Priority>Normal</Saa:Priority>
<Saa:IsPossibleDuplicate>false</Saa:IsPossibleDuplicate>
<Saa:IsNotificationRequested>true</Saa:IsNotificationRequested>
<Saa:Service>swift.generic.fa!x</Saa:Service>
<Saa:SWIFTNetNetworkInfo>
<Saa:FileInfo>SwCompression=Gzip;CharacterSet=ASCII;</Saa:FileInfo>
<Saa:NotificationResponderDN>ou=itb2,o=ptscfrhh,o=swift</Saa:NotificationRe
sponderDN>
<Saa:NotificationRequestType>xsys.xxx.delnotif</Saa:NotificationRequestType
>

Swift connections – 132

Trax – Bank Connector user guide

</Saa:SWIFTNetNetworkInfo>
</Saa:NetworkInfo>
<Saa:SecurityInfo>
<Saa:IsSigningRequested>true</Saa:IsSigningRequested>
<Saa:SWIFTNetSecurityInfo>
<Saa:IsNRRequested>true</Saa:IsNRRequested>
<Saa:FileDigestAlgorithm>SHA-256</Saa:FileDigestAlgorithm>
<Saa:FileDigestValue>2pP5HdYRTPgBXNJNui0B4uryU4aXNyeziz0m6shI6FI=</Saa:File
DigestValue>
</Saa:SWIFTNetSecurityInfo>
</Saa:SecurityInfo>
<Saa:FileLogicalName>Test_payloadFile_2403071635580002</Saa:FileLogicalName>
</Saa:Message>
</Saa:Header>
<!-- Body tag containing the filename of the message data file -->
<Saa:Body>Test_payloadFile_2403071635520001</Saa:Body>
<!-- LAU -->
<Saa:LAU>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-excc14n#">
</ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#hmacsha256">
</ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#envelopedsignature">
</ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#">
</ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256">
</ds:DigestMethod>
<ds:DigestValue>VTd8GeOUM8Cs1rZEXJ6zlwHPFWbGeLxiDPTMCxQKgiI=</ds:DigestValu
e>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>if1WpFbzE6fpJoyuGt3gZLW7gWTMbvTJ7sABZFl4aoI=</ds:SignatureVa
lue>
</ds:Signature>
</Saa:LAU>
</Saa:DataPDU>

9.1.3 FileAct connections
The connection details are set up in the fileact-config.yml file in the targetconnection-outgoing and
sourceconnection-incoming section.

Swift connections – 133

Trax – Bank Connector user guide

9.1.3.1 FileAct general settings

finplus:
xmlv2revision: "2.0.14"

Property

Description

M/O

xmlv2revision

xmlv2 revision version.

M

Bank Connector supports revision 2.0.2 to 2.0.14

9.1.3.2 SFTP / AFT connection details
The SFTP/AFT connection can be used for exchanging FileAct messages using the XMLv2 format.
The connection details are set up in the fileact-config yml file.

fileact-config.yml

fileact:
default:
targetconnection:
outgoing:
actor: "FileActPayloadProducerActor"
uri:
privatekey:
privatekeypassphrase:
profile:
pduuri:
actor: "FileActPDUProducerActor"
sourceconnection:
- incoming:
actor: "FileActPayloadConsumerActor"
uri:
privatekey:
- incoming:
actor: "FileActPDUConsumerActor"
uri:
privatekey:
privatekeypassphrase:

Swift connections – 134

Trax – Bank Connector user guide

Property

Description

M/O

actor

Value has to be for

M

targetconnection-outgoing : "FileActPayloadProducerActor"
sourceconnection-incoming: depending on whether the uri refers to the
reception directory from which the PDU or payload of the incoming message
will be picked, the value will be "FileActPDUConsumerActor" or
"FileActPayloadConsumerActor"
profile: "FileActPDUProducerActor"
uri

This will be

M

for targetconnection-outgoing : path to emission directory on the SFTP server
where outgoing message (payload) need to be put.
for sourceconnection-incoming: path to the reception directory on the SFTP
server from which incoming messages (PDU or payload) are picked up by
Bank Connector
pduuri

path to emission directory on the SFTP server where outgoing message
(PDU) need to be put.

M

privatekey

Name of the SSH private key. It has to correspond to the name with which the
key was imported.

M

This parameter has to be used if SSH public key authentication is used.
privatekeypass
phrase

password of the SSH private key. The password can be AES encrypted. The
structure of the property is "{AES}<encrypted password>"

M

This parameter has to be used if SSH public key authentication is used.

9.1.3.2.1 Sending and receiving FileAct PDU and payload messages as a zipped Archive
The Swift Service Bureau Euro-Information requires that the FileAct messages are exchanged in zipped
format with specific naming conventions for the PDU, payload and zipped file.

fileact-config.yml

fileact:
zipfilename:
payloadfilename:
pdufilename:
pdufileextension:
payloadfileextension:

Swift connections – 135

Trax – Bank Connector user guide

default:
targetconnection:
outgoing:
actor: "FileActZipPayloadPDUProducerActor"
uri:
privatekey:
sourceconnection:
- incoming:
actor: "FileActZipPayloadPDUConsumerActor"
uri:
privatekey:

Property

Description

Mandatory /
Optional

zipfilename

defines the filename of the zipped archive
When connecting to Euro-Information, this filename must be set
with the following naming conventions "FAT_<Swift BIC11 of the
sender>_CME". This value will be concatenated with a timestamp
(YYDDDHHMMSS) and a 4-digit sequencenumber.
The swift BIC11 of the sender can be specified as a parameter in
the common FileAct profile parameters section below

M

payloadfilen
ame

defines the filename of the payload file
When connecting to Euro-Information, this filename must be
identical to the zip filename

M

pdufilenam
e

defines the filename of the PDU file.
When connecting to Euro-Information, this filename must be
identical to the zip filename

M

pdufileexten
sion

defines the filename extension of the XMLv2 PDU file
When connecting to Euro-Information, the filename extension has
to be "cpn".
If not specified the value will be "xml"

O

payloadfilee
xtension

defines the filename extension of the XMLv2 payload file if the
outgoing XMLv2 payload and PDU file must be zipped.
When connecting to Euro-Information, the filename extension has
to be "dat".

O

actor

Value has to be for

M

targetconnection-outgoing : "FileActZipPayloadPDUProducerActor"
sourceconnectionincoming: "FileActZipPayloadPDUConsumerActor"

Swift connections – 136

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

uri

Path to emission directory on the SFTP server where the zipped
payload and PDU for outgoing messages need to be put. See uri
structure

M

privatekey

Name of the SSH private key. It has to correspond to the name with
which the key was imported.

M

This parameter has to be used if SSH public key authentication is
used.
privatekeyp
assphrase

password of the SSH private key. The password can be AES
encrypted. The structure of the property is "{AES}<encrypted
password>"

M

This parameter has to be used if SSH public key authentication is
used.
readLock

Files will only be polled if Bank Connector has exclusive read-lock
on the file

M

Value has to be "changed"

9.1.3.2.2 Encrypting the FileAct PDU and payload message
When connecting to FIS US SSB, both PDU and payload have to be PGP encrypted. By default, both will be
encrypted. If the PDU does not have to encrypted, you can set the FileAct property transformpdu to "false".

fileact:
transformpdu: "false"

9.1.3.2.3 Structure of the uri
The uri has the following structure

sftp://host:port/directoryname?queryparameters in key-value pair separated by &

property

description

M/O

host

Hostname of the SFTP server

M

Swift connections – 137

Trax – Bank Connector user guide

property

description

M/O

port

Port of the SFTP server

M

directoryname

emission or reception directory

M

The following queryparameters are supported by Bank Connector:

Queryparamete
r

Description

M/O

binary

Specifies the file transfer mode, BINARY or ASCII. The value has to
be "true"

M

fileexist

Determines the behaviour if the same file is written twice to the
emission directory. The value has to be "fail"

M

stepwise

Sets whether Bank Connector will stepwise change directories while
traversing file structures when uploading a file to a directory. The
value has to be "false"

M

This parameter has to be used only for the emission directories.
streamDownloa
d

Sets the download method to use when not using a local working
directory. If set to true, the remote files are streamed to the route as
they are read. The value has to be "true".

M

The parameter has to be used only for the emission directories.
move

Directory where files have to be moved after processing. The value
has to be "processed". If the parameter "delete" is used, then this
parameter cannot be used.

M

This parameter has to be used only for the reception directory.
delete

If set to "true", the files will be deleted after processing. If the
parameter "move" is used, then this parameter cannot be used.

M

This parameter has to be used only for the reception directory.
preferredAuthen
tications

Sets the preferred authentications which will be used when
connecting to the SFTP server. The value has to be "publickey".

M

This parameter has to be used if SSH public key authentication is
used.

Swift connections – 138

Trax – Bank Connector user guide

Queryparamete
r

Description

M/O

publicKeyAccep
tedAlgorithms

Sets a comma separated list of public key accepted algorithms.
The value has to be "ssh-rsa".

M

This parameter has to be used if SSH public key authentication is
used.
username

client username to login

M

This parameter has to be used if username/password
authentication is used.
password

password to use for login

M

This parameter has to be used if username/password
authentication is used.
delay

Specifies the polling frequency of the reception directory in
millisecnonds. The default value is 5000.

O

9.1.3.2.4 Emission and reception folder structure
The emission and reception directory structure will be provided by the Swift Service Bureau.
If the emission directory for both PDU and payload is the same, the uri and pduuri will have the same values.
In that case, the distinction between both is usually made by giving the PDU a distinct file extension. This file
extension an be configured via the FileAct property pdufileextension.

fileact:
pdufileextension: in

If the reception directory for the PDU and payload is the same, then the distinction can be made by adding as
query parameter in the uri include with as value the PDU file extension.

fileact:
sourceconnection:
- incoming:
uri: host:port/PDU reception folder?include=.*.xmlv2
actor: FileActPDUConsumerActor
- incoming:
uri: host:port/Payload reception folder?include=.*.payload
actor: FileActPayloadConsumerActor

Swift connections – 139

Trax – Bank Connector user guide

9.1.3.2.5 Setting up common connection properties
Connection parameters that are common for the different emission or reception folders can be configured as
default properties.
The example below shows the setup with the SSH private key as common parameter.

fileact:
default:
sourceconnection:
incoming:
privatekey:
sourceconnection:
- incoming:
uri:
actor:
- incoming:
uri:
actor:

This example below shows the setup of PGP encryption/decryption parameters as common parameters.

fileact:
default:
targetconnection:
outgoing:
postprocessor:
encryptionmode:
encryptkeyfile:
encryptpublickeyfile:
encryptfilename:
keyalgorithm:
hashalgorithm:
sourceconnection:
incoming:
preprocessor:
encryptkeyfile:
hashalgorithm:
sourceconnection:
- incoming:
uri:
actor:
- incoming:
uri:
actor:

Swift connections – 140

Trax – Bank Connector user guide

9.1.3.2.6 Securing the AFT / SFTP connection
The connection between Bank Connector and the SFTP server can be secured by username/password
authentication or SSH pubic key authentication. The use of SSH public key authentication is strongly
recommended.
SSH relies upon the use of a private / public key pair. They are used to authenticate the identity of the user
that wants to access the SFTP server. The private key has to be set up in bank Connector, whilst the public
key needs to be stored on the SFTP server.
It is set up in Bank Connector by specifying the private key and the private key passphrase in the
targetconnection-outgoing or sourceconnection-incoming section of the connection details. The name of the
key can be freely chosen, but is is important that it corresponds to the name with which the key has been
imported in bank Connector. The name used typically is id_rsa (default name when using the windows tool
ssh-keygen to generate the key). When generating the key, it is recommended to protect the key with a
passphrase.

Below example shows how to generate the SSH key by running the ssh-keygen command from a command
prompt window:

> ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (C:\Users\e1083346/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):e
Enter same passphrase again:
Your identification has been saved in C:\Users\e1083346\id.rsa
Your public key has been saved in C:\Users\e1083346\id.rsa.pub
The key fingerprint is:
SHA256:u73OOrEkRZ6L9QmhXG8OZ1JWRHuQUoN+4lDkDXqClEk fnfis\e1083346@EMEABRUGQ3NGB3
The key's randomart image is:
+---[RSA 3072]----+
|
.Eo .o*B.
|
|
.+.+o*o.+
|
|
..=oOo.o . |
|
o XoB ..
|
|
+S& +
|
|
o +.=
|
|
o.o
|
|
o+
|
|
o+=.
|
+----[SHA256]-----+

9.1.3.2.7 Troubleshooting connection issues
When the connection to the SFTP server cannot be established, a warning or error will be logged and will be
displayed in the Logs screen. If event alerting has been set up, the warning will also be sent via email.

Swift connections – 141

Trax – Bank Connector user guide

9.1.3.3 SOAP connection details
The SOAP connection can be used for exchanging FileAct messages using the XMLv2 format.

fin:
default:
targetconnection:
outgoing:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:
sourceconnection:
incoming:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:

Property

Description

Mandatory
/ Optional

actor

Value has to be for

M

targetconnection-outgoing : "FileActSOAPActor"
sourceconnection-incoming: "FileActSOAPActor"
uri

uri of the SWIFT Alliance Access SOAP WSDL location

M

messagepartner

name of the SWIFT Alliance Access SOAPHA message partner

M

truststore

Name of the truststore containing the server public certificate. It has
to correspond to the name with which the truststore was imported..

M

Swift connections – 142

Trax – Bank Connector user guide

Property

Description

Mandatory
/ Optional

truststorepasswor
d

Password of the truststore. The password has to be AES encrypted.
The structure of the property is '{AES}<encrypted password>'.

M

windowsize

the negotiated number of messages which can remain
unacknowledged within an emission or reception window. Min 1,
max 10. Default value is 10

O

proxyhost

host of the proxy server for communicating with SWIFT Alliance
Access

O

proxyport

port of the proxy server

O

timeout

the time in seconds in which the acknowledgement or notification
for each message should be received, default value is 900

O

sockettimeout

the timeout in seconds on the network socket, default value is 60

O

9.1.3.3.1 Securing the SOAP connection
The connection between Bank Connector and SOAP is secured by TLS (server side authentication). This is
set up in Bank Connector by specifying a Java truststore containing the server's public key.
You can use the following Keytool command to add the server's public key (typically it will have a .cer
enxtension) to a java truststore
keytool -import -alias <your_alias> -keystore <your_truststore_filename> -trustcacerts
-file <filename_of_the_public_key>

9.1.3.4 Automatic retry on outgoing messages
Outgoing messages that cannot be sent because the connection to the SSB could not be established, will be
retried automatically. By default, the sending of the message will be retried 5 times. Between each attempt
there will be an incremental delay of 0.5 seconds.
These default settings can be overwritten by adding the properties "maxretries" and "retrydelay" in the
targetconnection-outgoing section. The retrydelay is expressed in milliseconds.

fileact:
default:
targetconnection:
outgoing:

Swift connections – 143

Trax – Bank Connector user guide

maxretries:
retrydelay:

Retrying & partially written files
In some cases (typically SFTP connections), the retry mechanism can recover from a connection
issue, but if the file was already written partially, every retry may still fail if the Camel
parameter &FileExist=Fail is used in the uri.

9.1.4 FileAct outgoing flow
9.1.4.1 Setting up outgoing routing

9.1.4.1.1 Configuring FileAct profiles
When sending out FIleAct messages, Bank Connector will ensure that the correct message parameters are
added to the message. For the XMLv2 format, Bank Connector will generate a PDU based on the message
parameters that are set up in the FileAct profiles.

fileact profile file

fileact:
- profile:
code:
service:
requesttype:
senderdn:
receiverdn:
isnotificationrequested:
notificationrequesttype:
notificationresponderdn:
issigningrequested:
isnrrequested:
filelogicalname:
priority:
transferdesciption:
transferinfo:
filedescription:
fileinfo:

Swift connections – 144

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

code

Profile code. The profile codes must correspond to the targetProfiles
of the outgoing routings defined in the Trax integration channel. See
Trax channel on how to set up the profiles in Trax.

M

service

Swift service name, "swift.generic.fa!p" (penny testing) or
"swift.generic.fa" (production).

M

requesttype

Type of the data being transferred. This will be stored in the
MessageIdentifier tag of the PDU message

M

senderdn

Sending SWIFTNet DN.

M

receiverdn

Receiving SWIFTNet DN.

M

isnotificationreq
uested

Indicates whether a delivery report is requested. Possible values are
"true" or "false".

O

notificationrequ
esttype

Delivery Notification Request Type.

O

notificationresp
onderdn

DN to whom the notification is sent.

O

issigningrequest
ed

Indicates whether signing of the message is required upon emission.

O

isnrrequested

Indicates whether non-repudiation is requested. The possible values
are true or false. The default value is false.

O

filelogicalname

Logical file name.

O

priority

The possible values are Normal or Urgent. The default value is
normal.

O

transferdescripti
on

Information about the file transfer.

O

Swift connections – 145

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

transferinfo

Structured data that the receiver can use for automatic processing of
the file transfer.

O

filedescription

Information about the file.

O

fileinfo

Structured data that the receiver can use for automatic processing of
the file.

O

9.1.4.1.2 Defining the filelogicalname
The file logical name is the filename that is passed from the sender to the receiver via SwiftNet.
If no filelogicalname has been configured in the fileact profile, Bank Connector will generate it with
structure yymmddhhmmss<4-digit sequence number> (example: 2403110749100002).
The filename can be configured by adding the FileAct profile properties "filelogicalname". The
filelogicalname can contain a string to which Bank Connector will add a timestamp and sequencenumber.

fileact:
- profile:
filelogicalname: "FILEACT"

This will generate a filename such as FILEACT_2403110918380006.
Trax can also provide the filelogicalname by configuring the jms parameter "EXT_TSGFileActLogicalName"
on the Integration channel - outgoing profile. This filename that has been passed on via this jms parameter
will take preference over the one defined in the FileAct profile.

9.1.4.1.3 AFT / SFTP connection - Defining the payload filename
In or der to link PDU and payload file, the payload filename is stored in the <body> tag of the PDU message.
If a filelogicalname has been configured via the FileAct profile or the Trax "EXT_TSGFileActLogicalName" jms
parameter, this value will be used as payload filename.
If you do not want to use the filelogicalname but instead have Bank Connector generate the payload
filename, the FileAct profile property "usefilelogicalname" has to be set to "false".

fileact:
- profile:
usefilelogicalname: "false"

Bank Connector will then generate it with structure yymmddhhmmss<4-digit sequence number> (example:
2403110749100002).

Swift connections – 146

Trax – Bank Connector user guide

If no filelogicalname has been configured in bank Connector or Trax, Bank Connector will also generate the
payload filename.
With backend applications other than Trax, it is possible to use as payload filename, the filename that was
originally assigned to the file by the backed application by setting the FileAct profile property
useoriginalfilename to "true".

fileact:
- profile:
useoriginalfilename: "true"

Bank Connector will use the message header parameter "CamelFilename" as payload filename in that case.
It is possible to select other another message header parameter by setting the FileAct profile property
filenameheaderparam to another value.
Possible values other values are: CamelFileNameOnly, CamelFileAbsolutePath

fileact:
- profile:
useoriginalfilename: "true"
filenameheaderparam: CamelFileNameOnly

9.1.4.1.4 AFT / SFTP connection - Defining the PDU filename
Bank Connector generates the PDU filename with structure yymmddhhmmss<4-digit sequence number>
(example: 2403110749100002). The filename extension will be ".xml" by default.
The PDU filename can be set to be the same as the payload filename by adding the property
"usepayloadfilenameforpdu" with value "true" in the fileact-config section. The filename extension by
configured by adding the property "pdufileextension" in the fileact-config section.

fileact:
pdufileextionsion: "fa"
usepayloadfilenameforpdu: "true"

9.1.4.1.5 AFT / SFTP connection - Payload file compression
Payload files can be compressed by specifying the compression type in the FileAct profile property fileinfo.

fileact:
- profile:
fileinfo: "SwCompression=Gzip"

Possible values are Zip, Gzip or None.

Swift connections – 147

Trax – Bank Connector user guide

9.1.4.1.6 Adding the number of transactions
When Trax is the originator of the FileAct message, it is possible to identify the amount of items such as
payments in a file. This is done in the enhanced header info of the PDU message

<Saa:HeaderInfo>
<as1:ApplSpcfc xmlns:as1="urn:swift:xsd:ApplSpcfc.TxsCntr.01">
<as1:TxsCntr>
<as1:TtlNbOfTxs>1</as1:TtlNbOfTxs>
</as1:TxsCntr>
</as1:ApplSpcfc>
</Saa:HeaderInfo>

This can be activated by adding the parameter "sendNumberOfTransactions" on the Integration channel outgoing profile and setting its value to "TRUE".

9.1.4.1.7 Skipping the generation of the PDU
When the backend application provides both payload message and PDU, the property "usepdufromimport"
with value "true" has to be added to the FileAct profile to prevent Bank Connector from generating a new
PDU.

profile specific properties in fileact-profile.yml

fileact:
- profile:
code:
usepdufromimport: true

9.1.4.1.8 Requesting a Delivery Notification
Typically for FileAct, a Delivery Notification will be requested by the sender upon receipt of the message by
the receiver. Requesting a delivery notification is managed by the FileAct profile properties
isnotificationrequested, notificationresponderdn and notificationrequesttype.

fileact profile file

fileact:
- profile:
isnotificationrequested:
notificationrequesttype:
notificationresponderdn:

Swift connections – 148

Trax – Bank Connector user guide

The property isnotificationrequested has to be set to true if a Delivery Notification is expected.
Notificationrequesttype and notificationresponderdn are optional fields. The bank will inform you if a specific
notificationrequesttype is required yes or no.

9.1.4.1.9 Setting up common profile parameters
It is possible to configure profile properties the values of which are common for all profiles, centrally so that
they do not have to repeated for each individual profile. These common properties are set up in the default
section of the fileact-config file. Profile specific properties are configured in the fin profile file.
If the same property is present as both common and profile specific property, the profile specific one will
take preference. A typical setup would be the following:

common properties in fileact-config.yml

fileact:
default:
profile:
service:
senderdn:
isnotificationrequested:
notificationrequesttype:
notificationresponderdn:
issigningrequested:
isnrrequested:
filelogicalname:
priority:

profile specific properties in fileact-profile.yml

fileact:
- profile:
code:
requesttype:
receiverdn:
fileinfo:

9.1.5 FileAct incoming flow
9.1.5.1 Setting up incoming routing
Bank Connector will assign a target profile to incoming FileAct messages based on the message parameters
of the XMLv2 PDU message. Via the target profile, Bank Connector will route the message to the correct
backend application.

Swift connections – 149

Trax – Bank Connector user guide

9.1.5.1.1 Configuring FileAct routing criteria
The message parameters are set up as routing criteria in the fileact-route-config file.
All routing criteria have to be assigned a routing sequence that will determine the order in which they will be
applied on an incoming message. When a matching entry is found, the corresponding target profile will be
assigned to the message.

fileact-route-config file

fileact:
- filtering:
routingsequence:
targetprofile:
service:
requesttype:
sender:
receiver:
priority:
transferinfo:
transferdescription:
fileinfo:
filedescription:
filelogicalname:
filename:
- filtering:
routingsequence:
targetprofile:
service:
requesttype:
sender:
receiver:
priority:
transferinfo:
transferdescription:
fileinfo:
filedescription:
filelogicalname:
filename:

Property

Description

routingsequen
ce

Sequence of the routing criteria

targetprofile

Profile that will be assigned to the incoming message

Swift connections – 150

Trax – Bank Connector user guide

Property

Description

service

Swift service name

requesttype

Type of the data being transferred

sender

Sending SWIFTNet DN

receiver

Receiving SWIFTNet DN

priority

The possible values are Normal or Urgent.

transferinfo

Structured data that the receiver can use for automatic processing of the file transfer

transferdescri
ption

Information about the file transfer

fileinfo

Structured data that the receiver can use for automatic processing of the file

filedescription

Information about the file

filelogicalnam
e

Logical file name

filename

filename in the body tag of the PDU

The targetprofles that are assigned to the messages via the incoming routing have to be defined also in the
targetconnection incoming section of the backend channel to which the messages need to be sent.

9.1.5.1.2 Sample FileAct routing configuration
Filters in routing criteria support wildcards, as shown in the example below.

fileact:
- filtering:
routingsequence: "01"
targetprofile: "RCTXML"
# list of routing criteria
sender: ".*bnpafrpp.*"
requesttype: ".*"
fileinfo: ".*filetype=GK.*"

Swift connections – 151

Trax – Bank Connector user guide

- filtering:
routingsequence: "02"
targetprofile: "RCTXML"
sender: ".*bnpafrpp.*"
requesttype: ".*"
fileinfo: ".*filetype=K6.*"
- filtering:
routingsequence: "03"
targetprofile: "BORAFB"
sender: ".*bnpafrpp.*"
requesttype: ".*"
fileinfo: ".*filetype=J4.*"
- filtering:
routingsequence: "04"
targetprofile: "RCTCODA"
sender: ".*bnpafrpp.*"
requesttype: "camt.xxx.pffl"
- filtering:
routingsequence: "05"
targetprofile: "OTHER"
sender: ".*"
requesttype: ".*"

Routing payload message and PDU to the backend application
When the backend application requires both the payload message and PDU, the property "pdutargetprofile"
has to be added to routing criteria. A specific targetprofile can then be assigned to the PDU so that it can be
routed separately from the payload.

fileact:
- filtering:
pdutargetprofile:

9.1.5.1.3 Disregard unwanted messages
Incoming messages that do not require further processing in the backend application, can be ignored in Bank
Connector. These messages will not be forwarded to the backend application and will not be available in the
message screen. Filtering criteria can be added with value "IGNORE" in the property "targetprofile".

fileact:
- filtering:
targetprofile: "IGNORE"

Swift connections – 152

Trax – Bank Connector user guide

9.1.5.1.4 Marking messages as confidential
Based on the routing criteria, you can define if the message details of a message that matches the criteria
will be visible in the GUI or not. This is done by adding the property "confidential" to the routing criteria with
value "true". The default value is "false".

fileact:
- filtering:
confidential: "true"

9.2 FIN
9.2.1 Scope
FIN enables the exchange of messages formatted with the traditional SWIFT MT standards. SWIFT FIN
messages all start with the literal MT which denotes Message Type. This is followed by a 3 digit number of
which the first digit represents the Category (related to a particular financial instruments or service), the
second digit is the group (messages related to a similar part of a transactions life cycle) and the third digit
represents the type (denotes the individual messages).

9.2.2 Supported message formats
The FIN service uses the MQ-MT, RJE or XMLv2 message format.

9.2.2.1 MQ-MT message format
Bank Connector uses the MQ-MT message format when exchanging messages over MQHA. The message
consists of one to five blocks.

Block identifier

Block name

Mandatory or
Optional

Description

1

Basic header block

Mandatory

The only mandatory block is the
basic header. The basic header
contains the general information that
identifies the message, and some
additional control information.

Swift connections – 153

Trax – Bank Connector user guide

Block identifier

Block name

Mandatory or
Optional

Description

2

Application header
block

Optional

The application header contains
information that is specific to the
application such as the Swift
message type or the Message Input
Reference

3

User header block

Optional

The user header block contains the
Message User Reference or the endto-end transaction reference (UETR)

4

text

Mandatory

Block 4 contains the actual message
payload.

5

trailers

Optional

The trailer either indicates special
circumstances that relate to
message handling or contains
security information such as an
indication if the message is a
possible dulplicate or the LAU

Bank Connector generates the headers and trailers for outgoing FIN messages. The bank end application
only needs to provide the payload. The values for creating the headers are defined in the FIN profle. A trailer
containing a Possible duplicate indicator and a LAU will be added if required. It is also possible for the back
end application to provide the header blocks along with the message text block (block 4) of the FIN
message. In that case, Bank Connector will skip the header generation. The trailer containing the LAU will still
be added in that case if required.

sample payload received from back end application

:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX

Swift connections – 154

Trax – Bank Connector user guide

:59:/GB15MIDL40051512345678
MBS
:71A:SHA

sample outgoing FIN message in MQ-MT format

{1:F01PTSAILBMXM050000000000}{2:I101PTSAILBMXM05U3}{3:{108:2312211702350001}}{4:
:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678
MBS
:71A:SHA
-}{S:{MDG:0FE9949BBBFB6CA9DD750010A023436375D7AAFA0859FDA706030ED3EEB1B773}}

sample incoming FIN message in MQ-MT format

{1:F01PTSAILBMAM052317018660}{2:O9400931231222PTSAILBMAM0523170138682312220931U}{3:{1
08:2312220831380003}}{4:
:20:9400106079020612
:25:650607147
:28C:56/1
:60F:C060320EUR471,25
:62F:C060320EUR471,25
:64:C060320EUR471,25
:86:/PG/1L
-}{5:{CHK:5382D588081A}{PDE:}}{S:
{MDG:4FDAB4A33A32AE23058ADA2530BAF19D4988B56276F7B04151220E22EFD0962E}}

9.2.2.2 RJE message format
The RJE message format is very similar to the MQ-MT format. The RJE format however, allows to include
several FIN messages in one file separated by a "$". For outgoing messages, Bank Connector will include 1
FIN message in a file. Incoming messages containing multiple FIN messages are parsed and processed
individually.

Swift connections – 155

Trax – Bank Connector user guide

sample outgoing message in FIN RJE format

{1:F01PTSCFRHHXXXX0000000000}{2:I101PTSCFRHHXXXXU1}{3:{108:2312220933440002}}{4:
:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678
MBS
:71A:SHA
-}{5:{PDE:}}{S:
{MDG:735641E0981672FB82464E4845569F37F1E649ADA35F2233A2E55263C4BF33F3}}

sample incoming FIN message in FIN RJE format containing multiple FIN messages

{1:F21PTSCFRHHAXXX6296334334}{4:{177:2312220939}{451:0}}{1:F01PTSCFRHHAXXX6296334334}
{2:O1011036231222PTSCFRHHAXXX62962993882312221036U}{3:{108:2312220935360003}}{4:
:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678
MBS
:71A:SHA
-}{5:{CHK:5F96ED886608}{PDE:}{PDE:}{PDE:}}{S:{SAC:}{COP:S}
{MDG:9FA9637AEE3410A353A71682D7AB0EA3B14268CA17052B2AE70B3EBDFF73374B}}${1:F21PTSCFRH
HAXXX6296334335}{4:{177:2312220939}{451:0}}{1:F01PTSCFRHHAXXX6296334335}{2:O101103623
1222PTSCFRHHAXXX62962993892312221036U}{3:{108:2312220935400004}}{4:
:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay

Swift connections – 156

Trax – Bank Connector user guide

:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678
MBS
:71A:SHA
-}{5:{CHK:5F96ED886608}{PDE:}{PDE:}{PDE:}}{S:{SAC:}{COP:S}
{MDG:A7A17C47EB190DBDD2CEAD6BDF04B27D4832AAB3970A6F96AC5B816AAF4BD823}}${1:F21PTSCFRH
HAXXX6296299390}{4:{177:2312221036}{451:0}{108:2312220935440005}}{1:F01PTSCFRHHXXXX62
96299390}{2:I101PTSCFRHHXXXXU1}{3:{108:2312220935440005}}{5:{CHK:5F96ED886608}{PDE:}
{PDE:}}{S:{CON:}{TRN:SOAPforTRAX1}{COR:00001}
{MDG:DBD1B68E7B4D8D561EFEDE3C8F56A8CDF649A9CFACD2805474AF6FDA9FC458A7}}${1:F21PTSCFRH
HAXXX6296334336}{4:{177:2312220939}{451:0}}{1:F01PTSCFRHHAXXX6296334336}{2:O101103623
1222PTSCFRHHAXXX62962993902312221036U}{3:{108:2312220935440005}}{4:
:20:SOAPforTRAX1
:28D:1/1
:30:180910
:21:SOAPforTRAX1
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR2453189,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX
:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678
MBS
:71A:SHA
-}{5:{CHK:5F96ED886608}{PDE:}{PDE:}{PDE:}}{S:{SAC:}{COP:S}
{MDG:F67F2A40078A100D9795C9E1C5A1DD980B5B8ED5CAB724B2085396B1878164A7}}

9.2.2.3 XMLv2 message format
The XMLv2 message or Protocol Data Unit message consists of a technical header and a message data
block or body which contains the FIN message base64 encoded. Bank Connector currently supports XMLv2
revision 2.0.14.
When using a filebased connection method (sftp or AFT), several XMLv2 messages can be included in 1 file.
For outgoing messages, Bank Connector will include 1 XMLv2 message in a file. Incoming messages
containing multiple XMLv2 messages will be parsed and processed individually..

sample outgoing FIN message in XMLv2 format

002213EbP3hgcC6hFsi0aKT+jyAw==<?xml version="1.0" encoding="UTF-8"?>
<Saa:DataPDU xmlns:Saa="urn:swift:saa:xsd:saa.2.0">
<Saa:Revision>2.0.14</Saa:Revision>

Swift connections – 157

Trax – Bank Connector user guide

<!-- technical header -->
<Saa:Header>
<Saa:Message>
<Saa:SenderReference>2312221116490015</Saa:SenderReference>
<Saa:MessageIdentifier>fin.101</Saa:MessageIdentifier>
<Saa:Format>MT</Saa:Format>
<Saa:Sender>
<Saa:BIC12>PTSCFRHHXXXX</Saa:BIC12>
<Saa:FullName>
<Saa:X1>PTSCFRHHXXX</Saa:X1>
</Saa:FullName>
</Saa:Sender>
<Saa:Receiver>
<Saa:BIC12>PTSCFRHHXXXX</Saa:BIC12>
<Saa:FullName>
<Saa:X1>PTSCFRHHXXX</Saa:X1>
</Saa:FullName>
</Saa:Receiver>
<Saa:InterfaceInfo>
<Saa:UserReference>2312221116490015</Saa:UserReference>
<Saa:ProductInfo>
<Saa:Product>
<Saa:VendorName>Sungard</Saa:VendorName>
<Saa:ProductName>Sungard</Saa:ProductName>
<Saa:ProductVersion>2.2</Saa:ProductVersion>
</Saa:Product>
</Saa:ProductInfo>
</Saa:InterfaceInfo>
<Saa:NetworkInfo>
<Saa:Priority>Normal</Saa:Priority>
<Saa:IsPossibleDuplicate>true</Saa:IsPossibleDuplicate>
<Saa:IsNotificationRequested>true</Saa:IsNotificationRequested>
</Saa:NetworkInfo>
</Saa:Message>
</Saa:Header>
<!-- FIN message base64 encoded -->
<Saa:Body>DQo6MjA6U09BUGZvclRSQVgxDQo6MjhEOjEvMQ0KOjMwOjE4MDkxMA0KOjIxOlNPQVBmb3JUUkF
YMQ0KOjIzRTpSRVBBL0UtcGF5DQo6MjNFOlBIT04vMTIzLTQ1Ni03ODkNCjozMkI6RVVSMjQ1MzE4OSwNCjo1
MEg6L0JFNjc2NDU2Nzk1NDg0ODcNCk15TmFtZQ0KOjUyQTpQVFNDRlJISFhYWA0KOjU3QTpQVFNDRlJISFhYW
A0KOjU5Oi9HQjE1TUlETDQwMDUxNTEyMzQ1Njc4DQpNQlMNCjo3MUE6U0hB</Saa:Body>
<!-- LAU -->
<Saa:LAU>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-excc14n#">
</ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#hmacsha256">
</ds:SignatureMethod>
<ds:Reference URI="">
<ds:Transforms>

Swift connections – 158

Trax – Bank Connector user guide

<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#envelopedsignature">
</ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#">
</ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256">
</ds:DigestMethod>
<ds:DigestValue>zAhqLEjE+gmJq5n193qjS6il/t7aU/7ozDF9YZn9q6I=</
ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>5O2d38OVOmUpLCyUtsl5recMva+xud3NOnj5vnMXfis=</
ds:SignatureValue>
</ds:Signature>
</Saa:LAU>
</Saa:DataPDU>

sample incoming FIN message in XMLv2 format

004549mdl7Ofy9n1JjePeVLmBQTQ==<?xml version="1.0" encoding="UTF-8" ?>
<Saa:DataPDU xmlns:Saa="urn:swift:saa:xsd:saa.2.0" xmlns:Sw="urn:swift:snl:ns.Sw"
xmlns:SwInt="urn:swift:snl:ns.SwInt" xmlns:SwGbl="urn:swift:snl:ns.SwGbl"
xmlns:SwSec="urn:swift:snl:ns.SwSec">
<Saa:Revision>2.0.14</Saa:Revision>
<Saa:Header>
<Saa:Message>
<Saa:SenderReference>OPTSCFRHHXXX101SOAPforTRAX1$23122286533</
Saa:SenderReference>
<Saa:MessageIdentifier>fin.101</Saa:MessageIdentifier>
<Saa:Format>MT</Saa:Format>
<Saa:SubFormat>Output</Saa:SubFormat>
<Saa:Sender>
<Saa:BIC12>PTSCFRHHAXXX</Saa:BIC12>
<Saa:FullName>
<Saa:X1>PTSCFRHHXXX</Saa:X1>
</Saa:FullName>
</Saa:Sender>
<Saa:Receiver>
<Saa:BIC12>PTSCFRHHAXXX</Saa:BIC12>
<Saa:FullName>
<Saa:X1>PTSCFRHHXXX</Saa:X1>
</Saa:FullName>
</Saa:Receiver>
<Saa:InterfaceInfo>
<Saa:UserReference>2312221116450014</Saa:UserReference>
<Saa:MessageCreator>FINInterface</Saa:MessageCreator>
<Saa:MessageContext>Copy</Saa:MessageContext>

Swift connections – 159

Trax – Bank Connector user guide

<Saa:MessageNature>Financial</Saa:MessageNature>
<Saa:Sumid>1A7A9C05FFFEADFA</Saa:Sumid>
</Saa:InterfaceInfo>
<Saa:NetworkInfo>
<Saa:Priority>Normal</Saa:Priority>
<Saa:IsPossibleDuplicate>true</Saa:IsPossibleDuplicate>
<Saa:DuplicateHistory>
<Saa:PDE>{PDE:}</Saa:PDE>
</Saa:DuplicateHistory>
<Saa:IsNotificationRequested>false</Saa:IsNotificationRequested>
<Saa:Service>swift.fin</Saa:Service>
<Saa:Network>FIN</Saa:Network>
<Saa:SessionNr>6296</Saa:SessionNr>
<Saa:SeqNr>334355</Saa:SeqNr>
<Saa:FINNetworkInfo>
<Saa:MessageSyntaxVersion>1805</Saa:MessageSyntaxVersion>
<Saa:CorrespondentInputReference>231222PTSCFRHHAXXX6296299401</
Saa:CorrespondentInputReference>
<Saa:CorrespondentInputTime>20231222121700</
Saa:CorrespondentInputTime>
<Saa:LocalOutputTime>20231222121700</Saa:LocalOutputTime>
<Saa:FINUserHeader>{108:2312221116450014}</Saa:FINUserHeader>
</Saa:FINNetworkInfo>
</Saa:NetworkInfo>
<Saa:SecurityInfo>
<Saa:RMAResult>Success</Saa:RMAResult>
<Saa:FINSecurityInfo>
<Saa:ChecksumResult>Success</Saa:ChecksumResult>
<Saa:ChecksumValue>5F96ED886608</Saa:ChecksumValue>
<Saa:MACResult>Success</Saa:MACResult>
<Saa:MACSignatureValue>
<SwSec:Signature>
<SwSec:SignedInfo>
<Sw:Reference>
<Sw:DigestValue>VF1NhHWXQhNMq8rmVKrbonTFABH+Ht9Jh+uU1CbiHa8=</Sw:DigestValue>
</Sw:Reference>
</SwSec:SignedInfo>
<SwSec:SignatureValue>PEMF@Proc-Type: 4,MIC-ONLY
Content-Domain: RFC822
EntrustFile-Version: 2.0
Originator-DN: cn=so1,o=ptscfrhh,o=swift
Orig-SN: 1657926369
MIC-Info: SHA256, RSA,
fd6oXF2/6ofmuTYZlkGpg0LiEpedu/4FGjGsXDoL39LDq1kzhjyaKtMwj6pW6574
d2z468fQBQRrom6IPvjBIrnGW/f0YXFpt3KVBBO4sA4dUoG0n3qefR1YLK79jIxq
J04yUP8CYVn4wAimCq++fkRklE+bV+lkic9FlBUMOmQhMtrL6OqfiRxmN0CQwDtt
UCtSK8Uu25XVp555crOdshul88/fDs8ai1svt9Zg9pU0Iq5pNDUb4HKDVfHzo/wu
6FuZuQBzYxIvx4187vM121BoPoRKFV3Mu5Pz887OaTeF3VFydrQGK5+LCsWSgX9Q
hTfHDOSHrnG25/9otUyLGA==
</SwSec:SignatureValue>
<SwSec:KeyInfo>

Swift connections – 160

Trax – Bank Connector user guide

<SwSec:SignDN>cn=so1,o=ptscfrhh,o=swift</
SwSec:SignDN>
<SwSec:CertPolicyId>1.3.21.6.2</SwSec:CertPolicyId>
</SwSec:KeyInfo>
<SwSec:Manifest>
<Sw:Reference>
<Sw:DigestRef>M</Sw:DigestRef>
<Sw:DigestValue>MXBl9JoL0NC5ieqTPvVfDGt4JrSetQIPylsCVQOnb2g=</Sw:DigestValue>
</Sw:Reference>
<Sw:Reference>
<Sw:DigestRef>Sw.E2S</Sw:DigestRef>
<Sw:DigestValue>gaq18dG4LP9MiPuuCrwhRf3DoJWS7RMJg3NYfN9T4lY=</Sw:DigestValue>
</Sw:Reference>
</SwSec:Manifest>
</SwSec:Signature>
</Saa:MACSignatureValue>
</Saa:FINSecurityInfo>
</Saa:SecurityInfo>
<Saa:ExpiryDateTime>20240111102043</Saa:ExpiryDateTime>
</Saa:Message>
</Saa:Header>
<Saa:Body>DQo6MjA6U09BUGZvclRSQVgxDQo6MjhEOjEvMQ0KOjMwOjE4MDkxMA0KOjIxOlNPQVBmb3JUUkF
YMQ0KOjIzRTpSRVBBL0UtcGF5DQo6MjNFOlBIT04vMTIzLTQ1Ni03ODkNCjozMkI6RVVSMjQ1MzE4OSwNCjo1
MEg6L0JFNjc2NDU2Nzk1NDg0ODcNCk15TmFtZQ0KOjUyQTpQVFNDRlJISFhYWA0KOjU3QTpQVFNDRlJISFhYW
A0KOjU5Oi9HQjE1TUlETDQwMDUxNTEyMzQ1Njc4DQpNQlMNCjo3MUE6U0hB</Saa:Body>
<Saa:LAU>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xmlexc-c14n#"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsigmore#hmac-sha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/
xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-excc14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/
xmlenc#sha256"/>
<ds:DigestValue>eg5WOmqzmOKGpbzAr/uOeDrxkxMxjfy+KpY7Il4EEEI=</
ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>ppnFJOy2Ix1k+B7/hYrfIaMtbXt8gIwyA2Fe+J08PM0=</
ds:SignatureValue>
</ds:Signature>
</Saa:LAU>

Swift connections – 161

Trax – Bank Connector user guide

</Saa:Data

9.2.3 Supported connection methods
Bank Connector supports MQHA, SOAP and File Transfer for exchanging FIN messages. Below table lists the
supported message formats for each connection method

Message format

Connection method

MQ-MT

MQHA

XMLv2

AFT

RJE

AFT

XMLv2

SOAP

9.2.4 FIN connections
The connection details are set up in the fin-config.yml file in the targetconnection-outgoing and
sourceconnection-incoming section.

9.2.4.1 MQHA connection details
Bank Connector uses the IBM MQ client to connect to a IBM MQ server that can be self-hosted or hosted by
the SBB.
The IBM MQ connection can only be used for exchanging FIN messages using the MQ-MT message format.
The connection details are set up in the fin-config yml file.

fin-config.yml

fin:
addcrlfafterfooter:
default:
targetconnection:
outgoing:
actor:
hostname:
port:
queuemanager:

Swift connections – 162

Trax – Bank Connector user guide

mqchannel:
uri:
replyqueue:
sslclientciphersuites:
sslclientprotocol:
truststore:
truststorepassword:
keystore:
keystorepassword:
sourceconnection:
incoming:
actor:
hostname:
port:
queuemanager:
mqchannel:
uri:
sslclientciphersuites:
sslclientprotocol:
truststore:
truststorepassword:
keystore:
keystorepassword:

Property

Description

M/O

addcrlfafterfoo
ter

If set to "true", a CRLF will be added at the end of the MT message

O

The default value is false.
This parameter has to be set to "true" when using EquensWordline as SSB.

actor

Value has to be for

M

targetconnection-outgoing : "FINQueueProducerActor"
sourceconnection-incoming: "FINQueueConsumerActor"
hostname

ip address or DNS host name of IBM MQ server

M

port

MQ listener port

M

queuemanager

MQ queue manager name

M

mqchannel

MQ channel name

M

Swift connections – 163

Trax – Bank Connector user guide

Property

Description

M/O

uri

the queue name for sending outgoing messages(targetconnection outgoing) or receiving incoming messages (sourceconnection - incoming)

M

The queue name has to be preceded with wmq:
replyqueue

specifies the queue name on which the response messages (ACK / Delivery
report) will be posted. The queue name has not be preceded by "wmq:"

M

sslClientCipher
Suites

Ciphersuite for using SSL client mutual authentication. The Oracle JRE
notation has to be used.

M

sslClientProtoc
ol

Supported client protocols. Bank Connector currently supports TLSv1.2 only.

M

trustStore

Name of the SSL truststore. It has to correspond to the name with which the
truststore was imported.

M

trustStorePass
word

Password of the SSL truststore. The password has to be AES encrypted. The
structure of the property is '{AES}<encrypted password>'.

M

keyStore

Name of the SSL keystore. It has to correspond to the name with which the
keystore was imported.

M

keyStorePassw
ord

Password of the SSL keystore. The password has to be AES encrypted. The
structure of the property is '{AES}<encrypted password>'.

M

9.2.4.1.1 Securing the MQHA connection
The connection between Bank Connector and IBM MQ is secured by mTLS. This is set up in Bank Connector
by specifying a java trusstore and keystore. The name of the trusstore and keystore can be freely chosen, but
is is important that it corresponds to the name with which the keystore or truststore has been imported in
bank Connector. The names typically used are ibmmq-keystore.jks and ibmmq-truststore.jks.
The ibmmq-keystore.jks contains the client's server private key but it can contain both private and public
key.
The ibmmq-truststore.jks contains the SSB's IBM MQ server public key.
Bank Connector only supports keystore files in .jks file format. PKCS12 is not supported.
You can use the following Keytool command to convert the .p12 file format into .jks file format:

Swift connections – 164

Trax – Bank Connector user guide

keytool -importkeystore -srckeystore <filename_of_the pkcs12 keystore> -srcstoretype
PKCS12 -destkeystore <your_keystore_filename> -deststoretype jks

When having to renew the keys, it is good practice to keep the previous keystore and truststore filename
(ibmmqkeystore and ibmmqtruststore) and passwords. This requires only an import of the new keystores
and does not require any changes in the channel configuration.

9.2.4.2 SFTP / AFT connection details
The SFTP/AFT connection can be used for exchanging FIN messages using the XMLv2 or RJE format.
The connection details are set up in the fin-config yml file.

fin-config.yml

fin:
default:
targetconnection:
outgoing:
actor:
uri:
privatekey:
privatekeypassphrase:
sourceconnection:
incoming:
actor:
uri:
privatekey:
privatekeypassphrase:

Property

Description

M/O

actor

Value has to be for

M

when the RJE message format is
targetconnection-outgoing : "FINQueueProducerActor"
sourceconnection-incoming: "FINAFTRJEConsumerActor"
when the XMLv2 message format is used
targetconnection-outgoing : "FINAFTProducerActor"
sourceconnection-incoming: "FINAFTConsumerActor"

Swift connections – 165

Trax – Bank Connector user guide

Property

Description

M/O

uri

This will be

M

for targetconnection-outgoing : path to emission directory on the SFTP server
where outgoing messages need to be put.
for sourceconnection-incoming: path to the reception directory on the SFTP
server from which incoming messages are picked up by Bank Connector
privatekey

Name of the SSH private key. It has to correspond to the name with which the
key was imported.

M

This parameter has to be used if SSH public key authentication is used.
privateKeyPass
phrase

password of the SSH private key. The password can be AES encrypted. The
structure of the property is "{AES}<encrypted password>"

M

This parameter has to be used if SSH public key authentication is used.
The uri has the following structure

sftp://host:port/directoryname?queryparameters in key-value pair separated by &

property

description

M/O

host

Hostname of the SFTP server

M

port

Port of the SFTP server

M

directoryname

emission or reception directory of the payload file
or PDU file

M

The following queryparameters are supported by Bank Connector:

Queryparamete
r

Description

M/O

binary

Specifies the file transfer mode, BINARY or ASCII. The value has to
be "true"

M

fileexist

Determines the behaviour if the same file is written twice to the
emission directory. The value has to be "fail"

M

Swift connections – 166

Trax – Bank Connector user guide

Queryparamete
r

Description

M/O

stepwise

Sets whether Bank Connector will stepwise change directories while
traversing file structures when uploading a file to a directory. The
value has to be "false"

M

This parameter has to be used only for the emission directories.
streamDownloa
d

Sets the download method to use when not using a local working
directory. If set to true, the remote files are streamed to the route as
they are read. The value has to be "true".

M

The parameter has to be used only for the emission directories.
move

Directory where files have to be moved after processing. The value
has to be "processed". If the parameter "delete" is used, then this
parameter cannot be used.

M

This parameter has to be used only for the reception directory.
delete

If set to "true", the files will be deleted after processing. If the
parameter "move" is used, then this parameter cannot be used.

M

This parameter has to be used only for the reception directory.
preferredAuthen
tications

Sets the preferred authentications that will be used when
connecting to the SFTP server. The value has to be "publickey".

M

This parameter has to be used if SSH public key authentication is
used.
publicKeyAccep
tedAlgorithms

Sets a comma-separated list of public key accepted algorithms. The
value has to be "ssh-rsa".

M

This parameter has to be used if SSH public key authentication is
used.
username

client username to login

M

This parameter has to be used if username/password
authentication is used.
password

password to use for login

M

This parameter has to be used if username/password
authentication is used.
delay

Specifies the polling frequency of the reception directory in
milliseconds. The default value is 5000.

O

Swift connections – 167

Trax – Bank Connector user guide

9.2.4.2.1 Securing the AFT / SFTP connection
The connection between Bank Connector and the SFTP server can be secured by username/password
authentication or SSH pubic key authentication. The use of SSH public key authentication is strongly
recommended.
SSH relies upon the use of a private/public key pair. They are used to authenticate the identity of the user
that wants to access the SFTP server. The private key has to be set up in bank Connector, whilst the public
key needs to be stored on the SFTP server.
It is set up in Bank Connector by specifying the private key in the targetconnection-outgoing or
sourceconnection-incoming section of the connection details. The name of the key can be freely chosen, but
is is important that it corresponds to the name with which the key has been imported in bank Connector. The
name used typically is id_rsa (default name when using the windows tool ssh-keygen to generate the key).
When generating the key, it is recommended to protect the key with a passphrase. This passphrase is added
to the uri with the queryparameter "privateKeyPassphrase".
example below shows how to generate the SSH key by running the ssh-keygen command from a command
prompt window:

> ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (C:\Users\e1083346/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):e
Enter same passphrase again:
Your identification has been saved in C:\Users\e1083346\id.rsa
Your public key has been saved in C:\Users\e1083346\id.rsa.pub
The key fingerprint is:
SHA256:u73OOrEkRZ6L9QmhXG8OZ1JWRHuQUoN+4lDkDXqClEk fnfis\e1083346@EMEABRUGQ3NGB3
The key's randomart image is:
+---[RSA 3072]----+
|
.Eo .o*B.
|
|
.+.+o*o.+
|
|
..=oOo.o . |
|
o XoB ..
|
|
+S& +
|
|
o +.=
|
|
o.o
|
|
o+
|
|
o+=.
|
+----[SHA256]-----+

9.2.4.3 SOAP connection details
The SOAP connection can be used for exchanging FIN messages using the XMLv2 format.

fin:

Swift connections – 168

Trax – Bank Connector user guide

default:
targetconnection:
outgoing:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:
sourceconnection:
incoming:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:

Property

Description

Mandatory
/ Optional

actor

Value has to be for

M

targetconnection-outgoing : "FINSOAPActor"
sourceconnection-incoming: "FINSOAPActor"
uri

URI of the SWIFT Alliance Access SOAP WSDL location

M

messagepartner

Name of the SWIFT Alliance Access SOAPHA message partner

M

truststore

Name of the truststore containing the server's public certificate. It
has to correspond to the name with which the truststore was
imported..

M

truststorepasswor
d

Password of the truststore. The password has to be AES encrypted.
The structure of the property is '{AES}<encrypted password>'.

M

Swift connections – 169

Trax – Bank Connector user guide

Property

Description

Mandatory
/ Optional

windowsize

The negotiated number of messages that can remain
unacknowledged within an emission or reception window. Min 1,
max 10. The default value is 10

O

proxyhost

host of the proxy server for communicating with SWIFT Alliance
Access

O

proxyport

Port of the proxy server

O

timeout

The time in seconds in which the acknowledgement or notification
for each message should be received, the default value is 900

O

sockettimeout

The timeout in seconds on the network socket, the default value is
60

O

9.2.4.3.1 Securing the SOAP connection
The connection between Bank Connector and SOAP is secured by TLS (server-side authentication). This is
set up in Bank Connector by specifying a Java truststore containing the server's public key.
You can use the following Keytool command to add the server's public key (typically it will have a .cer
extension) to a Java truststore

keytool -import -alias <your_alias> -keystore <your_truststore_filename> -trustcacerts
-file <filename_of_the_public_key>

9.2.4.4 Automatic retry on outgoing messages
Outgoing messages that cannot be sent because the connection to the SSB could not be established will be
retried automatically. By default, the sending of the message will be retried 5 times. Between each attempt,
there will be an incremental delay of 0.5 seconds.
These default settings can be overwritten by adding the properties "maxretries" and "retrydelay" in the
targetconnection-outgoing section. The retrydelay is expressed in milliseconds.

fin
default:
targetconnection:
outgoing:

Swift connections – 170

Trax – Bank Connector user guide

maxretries:
retrydelay:

Retrying & partially written files
In some cases (typically SFTP connections), the retry mechanism can recover from a connection
issue, but if the file was already written partially, every retry may still fail if the Camel
parameter &FileExist=Fail is used in the uri.

9.2.5 FIN outgoing flow
9.2.5.1 Setting up outgoing routing

9.2.5.1.1 Configuring FIN profiles
When sending out FIN (MT) messages, Bank Connector will ensure that based on the message format used
(FIN MQ-MT or XMLv2), the correct message parameters are added to the message. For MQ-MT format, this
means adding a FIN header and footer to the message. For the XMLv2 format, Bank Connector will generate
a PDU in which the message will be integrated. These message parameters are set up in the FIN profiles.

fin-profile file

fin:
- profile:
code:
messagetype:
applicationidentifier:
serviceidentifier:
logicalterminaladdress:
sessionnumber:
sequencenumber:
inputoutputidentifier:
receiversaddress:
messagepriority:
deliverymonitoring:
obsolescenceperiod:
bankingpriority:

Swift connections – 171

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

code

Profile code. The profile codes must correspond to the targetProfiles of
the outgoing routings defined in the Trax integration channel. See Trax
channel on how to set up the profiles in Trax.

M

applicationid
entifier

A 1-letter code in the basic header of a FIN message, which identifies
the application through which SWIFT processes the message

M

serviceidentif
ier

Identifies the type of message service.

M

logicaltermin
aladdress

12-character SWIFT address of the sender of the message

M

sessionnumb
er

The session number. It has to be set to "0000"

M

sequencenu
mber

The sequence number. It has to be set to "000000"

M

inputoutputid
entifier

Input or Output Identifier. It will be "I" for outgoing messages, and "O" for
incoming messages.

M

messagetype

3 digits that indicate the message type.

M

receiversaddr
ess

12-character SWIFT address of the receiver of the message

M

messageprior
ity

U (Urgent) or N (Normal)

O

deliverymonit
oring

1 (non-delivery warning), 3 (non-delivery warning and delivery
notification), 2 (delivery notification). If messagepriority is U, this value
has to be 1 or 3. If messagepriority is N, the value.

O

obsolescence
period

Obsolescence Period

O

bankingpriorit
y

The sender of the message assigns this 4-character banking priority.

O

Swift connections – 172

Trax – Bank Connector user guide

9.2.5.1.2 Skipping the generation of the FIN header
When the backend application provides an MT message already containing a FIN header block, the property
"skipheadergeneration" with value "true" has to be added to the FIN profile to prevent Bank Connector from
generating a new one. Although not used, the FIN profile also requires the mandatory properties to be
present.
When Trax provides the MT message containing a FIN header, this is indicated by an extra jms parameter
(EXT_TSGFINSkipheaders) that is passed on to Bank Connector. In that case, the FIN profile property
"skipheadergeneration" does not not need to be configured explicitly.
In Trax, this parameter can be configured on the Integration channel - outgoing profile.

fin-profile file

fin:
- profile:
code:
skipheadergeneration: "true"
messagetype:
applicationidentifier:
serviceidentifier:
logicalterminaladdress:
sessionnumber:
sequencenumber:
inputoutputidentifier:
receiversaddress:

Bank Connector expects to receive a correctly formatted header and does not perform any validation on it.

9.2.5.1.3 Using header information from Trax
Trax has the option to provide Bank Connector to provide values for the following properties to Bank
Connector through jms parameters. Bank Connector will then disregard the values that have been set up in
the FIN profile. In Trax, these parameters can be configured on the Integration channel - outgoing profile.

FIN profile property

jms parameter

logicalterminaladdress

EXT_TSGFINSenderLT

receiversaddress

EXT_TSGFINReceiverLT

messagepriority

EXT_TSGFINPriority

Swift connections – 173

Trax – Bank Connector user guide

9.2.5.1.4 MUR (Message User Reference) generation
For each outgoing FIN message, Bank Connector will generate a unique MUR. This MUR consists
of yymmddhhmmss<4-digit sequence number> (example: 2312211702350001). Trax can also provide the
MUR by configuring the jms parameter "EXT_TSGFINMUR" on the Integration channel - outgoing profile.
When the backend application provides the header and it does not include the MUR, Bank Connector can
generate one by adding the property "generatemur" with value true to the FIN profile.

fin-profile file

fin:
- profile:
code:
skipheadergeneration: "true"
generatemur: "true"
messagetype:
applicationidentifier:
serviceidentifier:
logicalterminaladdress:
sessionnumber:
sequencenumber:
inputoutputidentifier:
receiversaddress:

9.2.5.1.5 UETR generation
Bank Connector does not generate the Unique End-to-end Transaction Reference (UETR). Instead this
information has to be provided by the backend application.
Trax can provide the reference by mean of the jms parameter UETR. Other backend applications need to
provide the UETR as part of the header meaning that the FIN header block has to be generated by the
backend application and Bank Connector will not generate one.

9.2.5.1.6 AFT / SFTP connection - Defining the message filename
Bank Connector generates the following filenames if none have been configured:
XMLv2 message format : <message source reference>.xml
RJE message format: <15 character string>-<15 character string>
The filename can be configured by adding the queryparameter "fileName" to the uri in the targetconnectionoutgoing. A fixed filename can be configured or a combination of a fixed string with a dynamic expression.

&fileName=FIN-${date:now:yyyyMMddHHmmssSSS}.xml

Swift connections – 174

Trax – Bank Connector user guide

Additionally, for the xmlv2 message format, the filename can be configured by adding the FIN profile
properties "filelogicalname" and "pdufileextension". The filelogicalname can contain a string to which Bank
Connector will add a timestamp.

fin:
- profile:
filelogicalname: "FIN-"
pdufileextension: "xml"

This will generate a filename such as FIN_-2024_01_26_12_09_42_707.xml

9.2.5.1.7 Setting up common profile parameters
It is possible to configure profile properties the values of which are common for all profiles, centrally so that
they do not have to repeated for each indivudual profile. These common properties are set up in the default
section of the fin-config file. Profile specific properties are configured in the fin profile file.
If the same property is present as both common and profile specific property, the profile speciifc one will
take preference. A typical setup would be the following:

common properties in fin-config.yml

fin:
default:
profile:
applicationidentifier:
serviceidentifier:
logicalterminaladdress:
sessionnumber:
sequencenumber:
inputoutputidentifier:

profile specific properties in fin-profile.yml

fin:
- profile:
code:
messagetype:
receiversaddress:

Swift connections – 175

Trax – Bank Connector user guide

9.2.6 FIN incoming flow
9.2.6.1 Setting up incoming routing
Bank Connector will assign a target profile to incoming FIN MT messages based on the message parameters
of the FIN header or the XMLv2 PDU message. Via the target profile, Bank Connector will route the message
to the correct backend application.

9.2.6.1.1 Configuring FIN routing criteria
The message parameters are set up as routing criteria in the fin-route-config file.
All routing criteria have to be assigned a routing sequence that will determine the order in which they will be
applied on an incoming message. When a matching entry is found, the corresponding target profile will be
assigned to the message.

fin-route-config file

fin:
- filtering:
routingsequence:
targetprofile:
applicationid:
serviceid:
senderlt:
receiverlt:
incomingmessagetype:
incomingmessagepriority:
- filtering:
routingsequence:
targetprofile:
applicationid:
serviceid:
senderlt:
receiverlt:
incomingmessagetype:
incomingmessagepriority:

Property

Description

routingsequence

Sequence of the routing criteria

targetprofile

Profile that will be assigned to the incoming message

Swift connections – 176

Trax – Bank Connector user guide

Property

Description

applicationid

A 1-letter code in the basic header of a FIN message, which identifies the
application through which SWIFT processes the message

serviceid

Identifies the type of message service

senderlt

12-character SWIFT address of the sender of the message

receiverlt

12-character SWIFT address of the receiver of the message

incomingmessagetype

Message Type of the incoming FIN message

incomingmessageprior
ity

Message Priority of the incoming FIN message

The targetprofles that are assigned to the messages via the incoming routing have to be defined also in the
targetconnection incoming section of the backend channel to which the messages need to be sent.

9.2.6.1.2 Disregard unwanted messages
Incoming messages that do not require further processing in the backend application, can be ignored in Bank
Connector. These messages will not be forwarded to the backend application and will not be available in the
message screen. Filtering criteria can be added with value "IGNORE" in the property "targetprofile".

fileact:
- filtering:
targetprofile: "IGNORE"

9.2.6.1.3 Marking messages as confidential
Based on the routing criteria, you can define if the message details of a message that matches the criteria
will be visible in the GUI or not. This is done by adding the property "confidential" to the routing criteria with
value "true". The default value is "false".

fileact:
- filtering:
targetprofile: "IGNORE"

Swift connections – 177

Trax – Bank Connector user guide

9.3 FINplus
9.3.1 Scope
FINplus is the SWIFT core, store-and-forward, message-processing service that supports the secure and
reliable exchange of ISO 20022 messages between financial institutions. FINplus enables financial
institutions that are currently using the FIN service to exchange financial transactions in MT format, with the
necessary environment to exchange the richer ISO 20022 format messages.
FINplus enables the exchange of a large span of ISO 20022 request types, including payment and securities
market financial messages:
• In the scope of the ISO 20022 adoption, FINplus enables the exchange of payment messages
compliant with the Cross-Border Payments and Reporting Plus (CBPR+) market practices.
• FINplus supports the exchange of ISO 20022 Universal Confirmation messages to and from
the SWIFT gpi platform.
• FINplus enables the exchange of a broad span of Securities transactions related messages, including
Corporate Actions, Securities Settlement Instructions, and Collateral Management. For Securities
messages, FINplus supports the exchange of messages which comply with the plain ISO 20022
format or with specific usage guidelines.
Finplus uses the InterAct store-and-forward mode. It enables the exchange of ISO20022 financial messages
implemented on the service without the need to be simultaneously connected with the counterparty.
Finplus offers 3 InterAct store-and-forward services
• swift.finplus: The FINplus Live environment
• swift.finplus!pc: The Pilot current environment that mimics the Live environment at all times.
• swift.finplus!pf; The Pilot Future environment that helps to prepare for the future evolutions in the
Live environment.
The requestor and responder Distinguished names (DN) format for all messages exchanged over FINplus
has to be a level 3 DN with the following structure:
organizational unit (ou) : corresponds to the 3-character branch code. If there is no branch code you must
include ou=xxx
organization (o): corresponds to the BIC8
Registration Authority (0) : swift
Example : ou=xxx,o=ptscfrhh,o=swift

9.3.2 Supported message formats
The FINplus service uses the MX message format. Most MX messages are designed according to the
ISO20022 methodolgy and are ISO registered. All MX messages are represented in XML. FINplus specifically
mandates the presence of a Business Application Header (BAH).
The overall message structure is as follows:

Swift connections – 178

Trax – Bank Connector user guide

Bank Connector uses the XMLv2 message format for exchanging MX messages. The FINplus service is
supported only as from XMLv2 revision 10.
Apart from the technical header (DataPDU Header section), you can also opt for Bank Connector to generate
the Business Application Header when sending MX messages. The values for creating the technical header
and the Business Application Header are defined in the FINplus profile.
When receiving MX messages, you have the option to receive the full RequestPayload or only the Business
Document. This can be dined in the FINplus connection details.
The FINplus service also supports LAU validation. See Local Authentication and LAU key (see page 200) on how
the LAU key will be included in the XMLv2 message.

sample MX message in XMLv2 format

<!-- Technical Header-->
003561OO2AO4GHjJdgtgRPpwyMaw==<Saa:DataPDU xmlns:Saa="urn:swift:saa:xsd:saa.2.0">
<Saa:Revision>2.0.14</Saa:Revision>
<Saa:Header>
<Saa:Message>
<Saa:SenderReference>2309081533220001</Saa:SenderReference>
<Saa:MessageIdentifier>pacs.008.001.08</Saa:MessageIdentifier>
<Saa:Format>MX</Saa:Format>
<Saa:Sender>
<Saa:DN>ou=xxx,o=ptscfrhh,o=swift</Saa:DN>

Swift connections – 179

Trax – Bank Connector user guide

</Saa:Sender>
<Saa:Receiver>
<Saa:DN>ou=xxx,o=ptscfrhh,o=swift</Saa:DN>
</Saa:Receiver>
<Saa:InterfaceInfo>
<Saa:UserReference>2309081533220001</Saa:UserReference>
</Saa:InterfaceInfo>
<Saa:NetworkInfo>
<Saa:Priority>Normal</Saa:Priority>
<Saa:IsPossibleDuplicate>true</Saa:IsPossibleDuplicate>
<Saa:IsNotificationRequested>true</Saa:IsNotificationRequested>
<Saa:Service>swift.finplus!xpc</Saa:Service>
<Saa:SWIFTNetNetworkInfo>
<Saa:RequestType>pacs.008.001.08</Saa:RequestType>
<Saa:RequestSubtype>swift.cbprplus.02</Saa:RequestSubtype>
</Saa:SWIFTNetNetworkInfo>
</Saa:NetworkInfo>
<Saa:SecurityInfo>
<Saa:IsSigningRequested>true</Saa:IsSigningRequested>
<Saa:SWIFTNetSecurityInfo>
<Saa:IsNRRequested>false</Saa:IsNRRequested>
</Saa:SWIFTNetSecurityInfo>
</Saa:SecurityInfo>
</Saa:Message>
</Saa:Header>
<!-- RequestPayload -->
<Saa:Body>
<!-- Business Application Header -->
<AppHdr xmlns="urn:iso:std:iso:20022:tech:xsd:head.001.001.02">
<Fr>
<FIId>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</FIId>
</Fr>
<To>
<FIId>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</FIId>
</To>
<BizMsgIdr>pacs8bizmsgidr26</BizMsgIdr>
<MsgDefIdr>pacs.008.001.08</MsgDefIdr>
<BizSvc>swift.cbprplus.02</BizSvc>
<CreDt>2023-09-08T15:33:22.964+02:00</CreDt>
<PssblDplct>true</PssblDplct>
</AppHdr>
<!-- Business Document -->
<Document xmlns="urn:iso:std:iso:20022:tech:xsd:pacs.008.001.08">
<FIToFICstmrCdtTrf>

Swift connections – 180

Trax – Bank Connector user guide

<GrpHdr>
<MsgId>pacs8bizmsgidr26</MsgId>
<CreDtTm>2020-08-04T10:20:47+01:00</CreDtTm>
<NbOfTxs>1</NbOfTxs>
<SttlmInf>
<SttlmMtd>INDA</SttlmMtd>
</SttlmInf>
</GrpHdr>
<CdtTrfTxInf>
<PmtId>
<InstrId>pacs8bizmsgidr03</InstrId>
<EndToEndId>pacs008EndToEndId-036</EndToEndId>
<UETR>8a562c67-ca16-48ba-b074-65581be6f001</UETR>
</PmtId>
<IntrBkSttlmAmt Ccy="EUR">30000</IntrBkSttlmAmt>
<IntrBkSttlmDt>2020-08-04</IntrBkSttlmDt>
<ChrgBr>DEBT</ChrgBr>
<PrvsInstgAgt1>
<FinInstnId>
<BICFI>RBOSGB2L</BICFI>
</FinInstnId>
</PrvsInstgAgt1>
<InstgAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstgAgt>
<InstdAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstdAgt>
<Dbtr>
<Nm>Mr Gone</Nm>
<PstlAdr>
<StrtNm>25 Rowan Street</StrtNm>
<TwnNm>Monument</TwnNm>
<Ctry>GB</Ctry>
</PstlAdr>
</Dbtr>
<DbtrAgt>
<FinInstnId>
<BICFI>ADAGGB2S</BICFI>
</FinInstnId>
</DbtrAgt>
<CdtrAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</CdtrAgt>
<Cdtr>
<Nm>Pictet Asset Management</Nm>

Swift connections – 181

Trax – Bank Connector user guide

<PstlAdr>
<StrtNm>15, avenue J. F. Kennedy</StrtNm>
<TwnNm>Luxembourg</TwnNm>
<Ctry>LU</Ctry>
</PstlAdr>
</Cdtr>
</CdtTrfTxInf>
</FIToFICstmrCdtTrf>
</Document>
</Saa:Body>
<!-- Trailer / Signature -->
<Saa:LAU>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xmlexc-c14n#"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsigmore#hmac-sha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/
xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-excc14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/
xmlenc#sha256"/>
<ds:DigestValue>Ptehz9xLUOhqpW6BKIPOtSc79CMpNSmLmEl0LNeL6LA=</ds:
DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>y9DiNg4Nn0BMPPn1jlXmieNFeYqfCmFGEysBR5xJGCY=</ds:Signa
tureValue>
</ds:Signature>
</Saa:LAU>
</Saa:DataPDU>

9.3.3 FINplus connections
Bank Connector supports SFTP / AFT and SOAP to exchange MX messages over the Swift FINplus service.

9.3.3.1 FINplus general settings

sample finplus-config file

finplus:
xmlv2revision: "2.0.14"

Swift connections – 182

Trax – Bank Connector user guide

bahversion: "001.001.02"
includebahinmessage: "true/false"
bahstandard: "scoreplus"

XMLv2 file
settings

Description

M/O

xmlv2revision

Revision number of the XMLv2 format. Bank Connector currently supports
XMLv2 revision 2.0.2 and 2.0.14. By default, revision 2.0.14 will be used.
Possible values are 2.0.2 or 2.0.14

O

The FINplus MX message service is only supported as of XMLv2 revision
2.0.10, meaning that the XMLv2 revision has to be 2.0.14, which is the latest
that Bank Connector supports.
bahversion

Business Application Header version. If not specified, the current version
"001.001.02" will be applied.

O

Bank Connector currently only supports version "001.001.02".
includebahinm
essage

Defines if for incoming MX messages, the full RequestPayload (Business
Application Header and Business Document) or only the Business
Document. Will be forwarded to the backend application. Possible values
are "true" or "false" (default).

O

bahstandard

determines the service. Possible values are "cbprplus" or "scoreplus".

M

9.3.3.2 SFTP / AFT connection details
SFTP
connection
details

Description

M/O

targetconnecti
on - outgoing
-uri

Path to the emission directory on the SFTP server where outgoing
messages need to be put. The emission directory will be provided by your
Swift Service Bureau.

M

Swift connections – 183

Trax – Bank Connector user guide

SFTP
connection
details

Description

M/O

sourceconnecti
on - incoming
-uri

Path to the reception directory on the SFTP server from which incoming
messages are picked up by Bank Connector.

M

The same config above has two separate sourconnection - incoming
entries, one containing a reception directory for response messages
(transmission reports, delivery notifications) on outgoing MX messages and
one with the reception directory for incoming MX messages
(camt.053.001.009...). Both types of messages may share the same
reception directory, in which case only one one sourceconnection incoming entry has to be defined. Bank Connector handles both these
situations. This information will be provided by your Swift Service Bureau.

9.3.3.2.1 Uri structure
The uri has the following structure

sftp://host:port/directoryname?queryparameters in key-value pairs separated by &

property

description

host

Hostname of the SFTP server.

port

Port of the SFTP server.

directoryname

Emission or reception directory of the PDU file.

The following query parameters are supported by Bank Connector.

Query
parameter

Description

Mandatory /
Optional

binary

Specifies the file transfer mode, BINARY or ASCII. The value needs
to be "true".

M

fileexist

Determines the behaviour if the same file is written twice to the
emission directory. The value is normally "fail".

M

Swift connections – 184

Trax – Bank Connector user guide

Query
parameter

Description

Mandatory /
Optional

move

The directory where files have to be moved after processing. The
value has to be "processed". This parameter should only be used for
the reception directory.

M

stepwise

Sets whether Bank Connector will stepwise change directories while
traversing file structures when uploading a file to a directory. This
parameter should only be used for the emission directories. The
value has to be "false".

M

streamDownloa
d

Sets the download method to use when not using a local working
directory. If set to true, the remote files are streamed to the route as
they are read. The parameter has to be used only for the emission
directories. The value has to be "true"

M

delay

Specifies the polling frequency of the reception directory in
milliseconds. The default value is 5000.

O

9.3.3.2.2 Securing the SFTP connection
The file transfer connection can be secured through username/password and/or TLS. It is highly
recommended to secure the communication between the Bank Connector SFTP client and the SFTP server
using TLS.

9.3.3.2.2.1 Configuration
The following properties need to be added as query parameters to the uri to both the targetconnection outgoing and sourceconnection - incoming details.

Queryparameter

Description

Mandatory
/ Optional

username

Username to log in. To be used if username/password
authentication is used

M

password

Password to use for login. To be used if username/password
authentication is used. The password can be AES encrypted.
The structure of the property is then "{AES}<encrypted
password>"

M

Swift connections – 185

Trax – Bank Connector user guide

Queryparameter

Description

Mandatory
/ Optional

privatekeyfile

Path to the private key file so that the SFTP endpoint can do
private key verification. To be used if TLS authentication is
used.

M

preferredAuthentication
s

To be used if TLS authentication is used. The value has to be
"publickey".

M

privateKeyPassphrase

Password of the private key file. The password can be AES
encrypted, and then the structure of the property is "{AES}
<encrypted password>"

M

9.3.3.3 SOAP connection details
The SOAP connection can be used for exchanging FileAct messages using the XMLv2 format.

fin:
default:
targetconnection:
outgoing:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:
sourceconnection:
incoming:
actor:
uri:
messagepartner:
truststore:
truststorepassword:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:

Swift connections – 186

Trax – Bank Connector user guide

Property

Description

Mandatory
/ Optional

actor

Value has to be for

M

targetconnection-outgoing : "FileActSOAPActor"
sourceconnection-incoming: "FileActSOAPActor"
uri

uri of the SWIFT Alliance Access SOAP WSDL location

M

messagepartner

name of the SWIFT Alliance Access SOAPHA message partner

M

truststore

Name of the truststore containing the server's public certificate. It
has to correspond to the name with which the truststore was
imported..

M

truststorepasswor
d

Password of the truststore. The password has to be AES encrypted.
The structure of the property is '{AES}<encrypted password>'.

M

windowsize

the negotiated number of messages that can remain
unacknowledged within an emission or reception window. Min 1,
max 10. Default value is 10

O

proxyhost

host of the proxy server for communicating with SWIFT Alliance
Access

O

proxyport

port of the proxy server

O

timeout

the time in seconds in which the acknowledgement or notification
for each message should be received, the default value is 900

O

sockettimeout

the timeout in seconds on the network socket, the default value is 60

O

9.3.3.3.1 Securing the SOAP connection
The connection between Bank Connector and SOAP is secured by TLS (server-side authentication). This is
set up in Bank Connector by specifying a java truststore containing the server's public key.
You can use the following Keytool command to add the server's public key (typically it will have a .cer
extension) to a java truststore
keytool -import -alias <your_alias> -keystore <your_truststore_filename> -trustcacerts
-file <filename_of_the_public_key>

Swift connections – 187

Trax – Bank Connector user guide

9.3.3.4 Automatic retry on outgoing messages
Outgoing messages that cannot be sent because the connection to the SSB could not be established will be
retried automatically. By default, the sending of the message will be retried 5 times. Between each attempt,
there will be an incremental delay of 0.5 seconds.
These default settings can be overwritten by adding the properties "maxretries" and "retrydelay" in the
targetconnection-outgoing section. The retrydelay is expressed in milliseconds.

fileact
default:
targetconnection:
outgoing:
maxretries:
retrydelay:

Retrying & partially written files
In some cases (typically SFTP connections), the retry mechanism can recover from a connection
issue, but if the file was already written partially, every retry may still fail if the Camel
parameter &FileExist=Fail is used in the uri.

9.3.4 FINplus outgoing flow
When sending out MX messages over the FINplus service to the bank, Bank Connector generates the XMLv2
Technical Header and optionally the Business Application Header, based on the parameters that are set up in
the FINplus profiles.
When the backend application provides only the Business Document, the Technical Header and the Business
Application Header will be generated by Bank Connector.

sample message from backend application with Business Document

<Document
xmlns="urn:iso:std:iso:20022:tech:xsd:pacs.008.001.08">
<FIToFICstmrCdtTrf>
<GrpHdr>
<MsgId>pacs8bizmsgidr26</MsgId>
<CreDtTm>2020-08-04T10:20:47+01:00</CreDtTm>
<NbOfTxs>1</NbOfTxs>
<SttlmInf>
<SttlmMtd>INDA</SttlmMtd>
</SttlmInf>

Swift connections – 188

Trax – Bank Connector user guide

</GrpHdr>
<CdtTrfTxInf>
<PmtId>
<InstrId>pacs8bizmsgidr03</InstrId>
<EndToEndId>pacs008EndToEndId-036</EndToEndId>
<UETR>8a562c67-ca16-48ba-b074-65581be6f001</UETR>
</PmtId>
<IntrBkSttlmAmt Ccy="EUR">30000</IntrBkSttlmAmt>
<IntrBkSttlmDt>2020-08-04</IntrBkSttlmDt>
<ChrgBr>DEBT</ChrgBr>
<PrvsInstgAgt1>
<FinInstnId>
<BICFI>RBOSGB2L</BICFI>
</FinInstnId>
</PrvsInstgAgt1>
<InstgAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstgAgt>
<InstdAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstdAgt>
<Dbtr>
<Nm>Mr Gone</Nm>
<PstlAdr>
<StrtNm>25 Rowan Street</StrtNm>
<TwnNm>Monument</TwnNm>
<Ctry>GB</Ctry>
</PstlAdr>
</Dbtr>
<DbtrAgt>
<FinInstnId>
<BICFI>ADAGGB2S</BICFI>
</FinInstnId>
</DbtrAgt>
<CdtrAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</CdtrAgt>
<Cdtr>
<Nm>Pictet Asset Management</Nm>
<PstlAdr>
<StrtNm>15, avenue J. F. Kennedy</StrtNm>
<TwnNm>Luxembourg</TwnNm>
<Ctry>LU</Ctry>
</PstlAdr>
</Cdtr>
</CdtTrfTxInf>

Swift connections – 189

Trax – Bank Connector user guide

</FIToFICstmrCdtTrf>
</Document>

The backend application can also provide the Business Application Header and the Business Document, in
which case only the XMLv2 Technical Header will be generated.

sample message from backend application with Business Document and Business Application
Header

<Saa:Body>
<AppHdr
xmlns="urn:iso:std:iso:20022:tech:xsd:head.001.001.02">
<Fr>
<FIId>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</FIId>
</Fr>
<To>
<FIId>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</FIId>
</To>
<BizMsgIdr>pacs8bizmsgidr26</BizMsgIdr>
<MsgDefIdr>pacs.008.001.08</MsgDefIdr>
<BizSvc>swift.cbprplus.02</BizSvc>
<CreDt>2023-09-08T15:33:22.964+02:00</CreDt>
<PssblDplct>true</PssblDplct>
</AppHdr>
<Document
xmlns="urn:iso:std:iso:20022:tech:xsd:pacs.008.001.08">
<FIToFICstmrCdtTrf>
<GrpHdr>
<MsgId>pacs8bizmsgidr26</MsgId>
<CreDtTm>2020-08-04T10:20:47+01:00</CreDtTm>
<NbOfTxs>1</NbOfTxs>
<SttlmInf>
<SttlmMtd>INDA</SttlmMtd>
</SttlmInf>
</GrpHdr>
<CdtTrfTxInf>
<PmtId>
<InstrId>pacs8bizmsgidr03</InstrId>
<EndToEndId>pacs008EndToEndId-036</EndToEndId>
<UETR>8a562c67-ca16-48ba-b074-65581be6f001</UETR>
</PmtId>
<IntrBkSttlmAmt Ccy="EUR">30000</IntrBkSttlmAmt>

Swift connections – 190

Trax – Bank Connector user guide

<IntrBkSttlmDt>2020-08-04</IntrBkSttlmDt>
<ChrgBr>DEBT</ChrgBr>
<PrvsInstgAgt1>
<FinInstnId>
<BICFI>RBOSGB2L</BICFI>
</FinInstnId>
</PrvsInstgAgt1>
<InstgAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstgAgt>
<InstdAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</InstdAgt>
<Dbtr>
<Nm>Mr Gone</Nm>
<PstlAdr>
<StrtNm>25 Rowan Street</StrtNm>
<TwnNm>Monument</TwnNm>
<Ctry>GB</Ctry>
</PstlAdr>
</Dbtr>
<DbtrAgt>
<FinInstnId>
<BICFI>ADAGGB2S</BICFI>
</FinInstnId>
</DbtrAgt>
<CdtrAgt>
<FinInstnId>
<BICFI>SOGEFRP0XXX</BICFI>
</FinInstnId>
</CdtrAgt>
<Cdtr>
<Nm>Pictet Asset Management</Nm>
<PstlAdr>
<StrtNm>15, avenue J. F. Kennedy</StrtNm>
<TwnNm>Luxembourg</TwnNm>
<Ctry>LU</Ctry>
</PstlAdr>
</Cdtr>
</CdtTrfTxInf>
</FIToFICstmrCdtTrf>
</Document>
</Saa:Body>

Swift connections – 191

Trax – Bank Connector user guide

9.3.4.1 FINplus profiles
The profiles are configured in the finplus-config.yml and the finplus-profile.yml files. Parameters that are
common for all profiles can be specified in the default section of the finplus-config.yml. Profile-specific
parameters have to be defined in the finplus-profile.yml configurationfile.
The following parameters for the generation of the Technical Header and Business Application Header can
be set up in the profiles. When the backend application provides both Business Document and Business
Application Header, the Business Application Header Parameters do not have to be provided, and only the
parameter skipbahgeneration with value "true" is required.

Property

Description

Mandatory /
Optional

Technical Header parameters
code

Profile code. The profile codes must correspond to the
targetProfiles of the outgoing routings defined in the Trax
integration channel. See Trax channe1011l on how to set up the
profiles in Trax.

M

service

Swift service name. Possible values for FINplus are

M

• for FINplus live : swift.finplus
• for FINplus pilot current : swift.finplus!pc
requesttype

Type of the data being transferred. For MX messages, it
corresponds to the namespace URI of the XML document in
the body of the message.

M

senderdn

Sending SWIFTNet DN.

M

The senderdn must correspond to the FINplus user's 8character BIC plus one extension.
The extension includes the three-character branch code. Every
branch code defined for the 8-character BIC can be used in the
DN. If no branch code is specified, the extension must include
the three characters: xxx as the senderdn must always be at
least a 3-level DN.
senderfullname

The senderfullname corresponds to the FINplus user's 11character BIC.

O

10 https://wiki.fisglobal.com/display/trax/Trax+channel
11 https://wiki.fisglobal.com/display/trax/Trax+channel

Swift connections – 192

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

receiverdn

Receiving SWIFTNet DN.

M

The receiverdn must correspond to the FINplus user's 8character BIC plus one extension.
The extension includes the three-character branch code. Every
branch code defined for the 8-character BIC can be used in the
DN. If no branch code is specified, the extension must include
the three characters: xxx as the receiverdn must always be at
least a 3-level DN.
receiverfullname

The receiverfullname corresponds to the FINplus user 11character BIC.

O

priority

The possible values are Normal or Urgent. The default value is
"normal".

O

isnotificationrequested

Indicates whether a positive delivery notification is requested.
Possible values are "true" or "false".

O

notificationresponderdn

DN to whom the notification is sent (typically equal to
senderdn).

O

notificationrequesttype

Delivery Notification Request Type.

O

issigningrequested

Indicates whether signing of the message is required upon
emission.

O

isnrrrequested

Indicates whether non-repudiation is requested. The possible
values are true or false. The default value is "false".

O

requestsubtype

Identification of the validation expected to be performed by
sender, receiver, and SWIFT if Message Validation applies.

O

For the FINplus service, the current value has to be
"swift.cbprplus.01"
ispossibleduplicate

Indicates if the sent message is a possible duplicate. When
messages are imported from Trax, this property will be set
based on the JMS parameter TSGPossibleDuplicate.

O

transferdescription

Information about the file transfer.

O

Swift connections – 193

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

transferinfo

Structured data that the receiver can use for automatic
processing of the file transfer.

O

filedescription

Information about the file.

O

Business Application Header parameters
frombic

The sending MessagingEndpoint that has created this
Business Message. The sending MessagingEndpoint has to
be identified by the BIC8 or BIC11. It can be different from the
senderdn defined in the header section of the PDU.

M

tobic

The MessagingEndpoint designated by the sending
MessagingEndpoint to be the recipient. The receiving
MessagingEndpoint has to be identified by the BIC8 or BIC11.
It can be different from the receiverdn defined in the header
section of the PDU.

M

messagedefinitionidenti
fier

The Message Definition Identifier of the Business Message
instance that is being transported with this header. In general,
it must be formatted exactly as it appears in the namespace
of the Business Message instance.

M

businessservice

To support differentiated processing on CBPRPlus, for
example, SWIFT reserves a set of values that conform to a
specific format.

M

For FINplus service, the current value has to be
"swift.cbprplus.02"
marketpracticeregistry

Name of the implementation specification registry in which
the implementation specification of the ISO 20022 message is
maintained.

O

marketpracticeidentifier

Identifier which unambiguously identifies within the
implementation specification registry the implementation
specification to which the ISO 20022 message is compliant.

O

Swift connections – 194

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

skipbahgeneration

If set to "true", Bank Connector will not generate the Business
Application Header and expects to receive a correctly
formatted MX message containing both Business Application
Header and Business Document. The default value is "false". If
this value is set to true, no Business Application Header
parameters have to be specified.

O

sample finplus-profile yml with Business Application Header parameters containing profile specific
parameters

finplus:
- profile:
# Technical Header parameters
code:
requesttype:
senderdn:
receiverdn:
# Business Application Header properties
businessapplicationheader:
frombic:
tobic:
messagedefinitionidentifier:

sample finplus-config yml with common profile parameters

finplus:
default:
profile:
service:
priority:
isnotificationrequested:
notificationresponderdn:
notificationrequesttype:
issigningrequested:
isnrrequested:
requestsubtype:
businessapplicationheader:
businessservice:

Swift connections – 195

Trax – Bank Connector user guide

sample finplus-profile yml without Business Application Header parameters

finplus:
- profile:
# Technical Header parameters
code:
requesttype:
senderdn:
receiverdn:
# Business Application Header properties
skipbahgeneration: "true"

9.3.4.2 FINplus profile validation
The FINplus profile validation checks whether all mandatory properties are present and if the syntax of the
properties is correct.
The validation settings are configurable and are defined in the finplus-validator-properties. yml (by default
located in <release-dir>/wildfly/modules/com/scotty/scotty-web/main/config/). For each property, you can
set if the property is mandatory or not and check the syntax using regex validation.
The default settings for FINplus profile validation are the following:

finplus-validator-properties.yml

finplus:
- property:
propertyname: service
ismandatory: true
- property:
propertyname: requesttype
ismandatory: true
- property:
propertyname: senderdn
ismandatory: true
- property:
propertyname: senderdfullname
ismandatory: false
- property:
propertyname: receiverdn
ismandatory: true
- property:
propertyname: receiverfullname
ismandatory: false
- property:
propertyname: priority
ismandatory: false

Swift connections – 196

Trax – Bank Connector user guide

- property:
propertyname: ispossibleduplicate
ismandatory: false
- property:
propertyname: isnotificationrequested
ismandatory: false
- property:
propertyname: issigningrequested
ismandatory: false
- property:
propertyname: isnrrequested
ismandatory: false
- property:
propertyname: requestsubtype
ismandatory: false
- property:
propertyname: ispossibleduplicate
ismandatory: false
- property:
propertyname: transferdescription
ismandatory: false
- property:
propertyname: transferinfo
ismandatory: false
- property:
propertyname: filedescription
ismandatory: false
- property:
propertyname: frombic
ismandatory: true
regexformat: "^(?=[A-Z0-9]*$)(?:.{8}|.{11})$"
- property:
propertyname: tobic
ismandatory: true
regexformat: "^(?=[A-Z0-9]*$)(?:.{8}|.{11})$"
- property:
propertyname: messagedefinitionidentifier
ismandatory: true
regexformat: "[a-z]{4}.[0-9]{3}.[0-9]{3}.[0-9]{2}"
- property:
propertyname: businessservice
ismandatory: true
- property:
propertyname: marketpracticeregistry
ismandatory: false
- property:
propertyname: marketpracticeidentifier
ismandatory: false

Swift connections – 197

Trax – Bank Connector user guide

9.3.5 FINplus incoming flow
9.3.5.1 Setting up incoming routing
When receiving FINplus messages from the bank, Bank Connector will assign a profile to the message based
on parameters from the technical Header or the Business Application Header. Based on the assigned profile,
the message will be forwarded to the backend application.
Bank Connector will assign a target profile to incoming FINplus messages based on the message
parameters of the XMLv2 PDU message or the Business Application Header. Via the target profile, Bank
Connector will route the message to the correct backend application.
The routing criteria are set up in the FINplus routing configuration stored in in the finplus-route-config.yml.

9.3.5.1.1 Configuring FINplus routing criteria
The message parameters are set up as routing criteria in the finplus-route-config file.
All routing criteria have to be assigned a routing sequence that will determine the order in which they will be
applied on an incoming message. When a matching entry is found, the corresponding target profile will be
assigned to the message.

finplus-route-config file

fileact:
- filtering:
routingsequence:
targetprofile:
service:
requesttype:
sender:
receiver:
priority:
transferinfo:
transferdescription:
filedescription:
messagedefinitionidentifier:
frombic:
tobic:
businessservice:
- filtering:
routingsequence:
targetprofile:
service:
requesttype:
sender:
receiver:

Swift connections – 198

Trax – Bank Connector user guide

priority:
transferinfo:
transferdescription:
filedescription:
messagedefinitionidentifier:
frombic:
tobic:
businessservice:

Property

Description

routingsequence

Sequence of the routing criteria

targetprofile

Profile that will be assigned to the incoming message

service

Swift service name

requesttype

Type of the data being transferred

sender

Sending SWIFTNet DN

receiver

Receiving SWIFTNet DN

transferdescription

Information about the file transfer

transferinfo

Structured data that the receiver can use for automatic processing of the file
transfer

filedescription

Information about the file

priority

The possible values are Normal or Urgent.

frombic

The sending MessagingEndpoint that has created this Business Message

tobic

The MessagingEndpoint designated by the sending MessagingEndpoint to be the
recipient

messagdefinitionid
entifier

The Message Definition Identifier of the Business Message instance that is being
transported with this header

Swift connections – 199

Trax – Bank Connector user guide

Property

Description

businessservice

To support differentiated processing on CBPRPlus, for example, SWIFT reserves a
set of values that conform to a specific format.
For FINplus service, the current value has to be "swift.cbprplus.01"

9.3.5.1.2 Disregard unwanted messages
Incoming messages that do not require further processing in the backend application, can be ignored in Bank
Connector. These messages will not be forwarded to the backend application and will not be available in the
message screen. Filtering criteria can be added with value "IGNORE" in the property "targetprofile".

fileact:
- filtering:
targetprofile: "IGNORE"

9.3.5.1.3 Marking messages as confidential
Based on the routing criteria, you can define if the message details of a message that matches the criteria
will be visible in the GUI or not. This is done by adding the property "confidential" to the routing criteria with
value "true". The default value is "false".

fileact:
- filtering:
confidential: "true"

9.4 Local Authentication and LAU key
9.4.1 LAU key
Local Authentication (LAU) allows to authenticate the origin of the message and guarantees its integrity by
using Hash-Based Message Authentication Code (HMAC) Secure Hash Algorithm (SHA-256) signatures. The
signature algorithm (HMAC-SHA-256) in combination with a symmetric key is used to compute the signature
of a message. The symmetric key is shared by both the back-office application and Alliance Access.

9.4.1.1 LAU key settings
The LAU (Local Authentication) key consists of 32 printable characters and must be entered in two 16character strings. This key must be identical to the LAU key configured in SWIFT Alliance Access and must
be renewed at regular intervals.

Swift connections – 200

Trax – Bank Connector user guide

Bank Connector can check the validity of the LAU key according to the following criteria:
• Each 16-characters string part of the key must contain at least one uppercase, one lowercase and
one digit.
• Each 16-characters string part of the key cannot contain a character repeated more than 7 times.
• Each string part has to be 16 characters long.
• The authorized character set is US-ASCII [48 to 102] for the RJE format and US-ASCII [32 to 126] for
the XMLv2 format.

9.4.1.2 Configuration
The LAU key settings are defined in the fin-confign, fileact-config or finplus-config yml files.

fileact:
# LAU key settings
laukey:
laukeyexpirydate:
skiplaukey:
validatelaukey:
xmlv2revision:
addlausignatureinxml:
generatelauprefix:

Property

Description

Mandat
ory /
Optiona
l

laukey

concatenation of the two 16-characters strings

M

laukeyexpirydat
e

expiry date of the LAU key (format is dd-mm-yyyy)

O

skiplaukey

defines if the LAU key is to be used or not for message signing

O

Swift connections – 201

Trax – Bank Connector user guide

Property

Description

Mandat
ory /
Optiona
l

validatelaukey

defines if the LAU key needs to be validated when processing a FIN or
FileAct message.

O

The following validations will be checked:
• The key must be a 32-character string
• Every 16-character string part of the key should contain at least 1
uppercase characters
• Every 16-character string part of the key should contain at least 1
lowercase characters
• Every 16-character string part of the key should contain at least 2 digits
xmlv2revision

revision number of the XMLv2 format. Bank Connector currently supports
XMLv2 revision 2.0.2 to 2.0.14. By default revision 2.0.14 will be used.

O

addlausignatur
einxml

determines if the LAU key needs to be included in the Protocol Data Unit
(PDU) of the message. This is applicable only if the SOAP connection
method is used as the LAU is added by default in the SOAP envelope
header. The default value is false. Possible values are true or false.

O

generatelaupre
fix

determines if the LAU key needs to be included both as a binary prefix and
embedded in the PDU message. The default value is false. Possible values
are true or false.

O

9.4.1.2.1 Integration of the LAU in FIN RJE message format
For FIN MQ-MT messages, the LAU is added to the trailer of the message preceded by tag MDG.

example of FIN MQ-MT message with LAU as trailer

{1:F01PTSAILBMXM050000000000}{2:I101PTSAILBMXM05U1}{3:{108:2302130941550001}}{4:
:20:SOAPforTRAX02
:28D:1/1
:30:180910
:21:SOAPforTRAX02
:23E:REPA/E-pay
:23E:PHON/123-456-789
:32B:EUR24522,
:50H:/BE67645679548487
MyName
:52A:PTSCFRHHXXX

Swift connections – 202

Trax – Bank Connector user guide

:57A:PTSCFRHHXXX
:59:/GB15MIDL40051512345678 MBS
:71A:SHA -}
{S:{MDG:572C95EF825798D132D46C12B607BF5732171D44A118B43AD07CCCA9EE4B1EC8}}

9.4.1.2.2 Integration of the LAU in XMLv2 message format
In the XMLv2 revision 2 message format, the LAU is added as a binary prefix to the the Protocol Data Unit
(PDU) of the message.

example of XMLv2 revision 2.0.2 message with LAU key as binary prefix

002458pyPv2tUHAaGsXrZeK1tmuQ==<urn:DataPDU xmlns:urn="urn:swift:saa:xsd:saa.2.0"
xmlns:ns2="urn:swift:xsd:ApplSpcfc.TxsCntr.01">
<urn:Revision>2.0.2</urn:Revision>
<urn:Header>
<urn:Message>
<urn:SenderReference>2302131132040009</urn:SenderReference>
<urn:MessageIdentifier>pain.xxx.echos</urn:MessageIdentifier>
<urn:Format>File</urn:Format>
<urn:Sender>
<urn:DN>ou=m05,o=ptsailbm,o=swift</urn:DN>
</urn:Sender>
<urn:Receiver>
<urn:DN>ou=m05,o=ptsailbm,o=swift</urn:DN>
</urn:Receiver>
<urn:InterfaceInfo>
<urn:UserReference>2302131132040009</urn:UserReference>
<urn:ProductInfo>
<urn:Product>
<urn:VendorName>Sungard</urn:VendorName>
<urn:ProductName>Sungard</urn:ProductName>
<urn:ProductVersion>2.2</urn:ProductVersion>
</urn:Product>
</urn:ProductInfo>
</urn:InterfaceInfo>
<urn:NetworkInfo>
<urn:Priority>Normal</urn:Priority>
<urn:IsPossibleDuplicate>false</urn:IsPossibleDuplicate>
<urn:IsNotificationRequested>true</urn:IsNotificationRequested>
<urn:Service>swift.generic.fa!x</urn:Service>
<urn:SWIFTNetNetworkInfo>
<urn:FileInfo>SwCompression=None;CharacterSet=ASCII;</urn:FileInf
o>
<urn:NotificationResponderDN>ou=m05,o=ptsailbm,o=swift</urn:Notif
icationResponderDN>
<urn:NotificationRequestType>xsys.xxx.delnotif</urn:NotificationR
equestType>
</urn:SWIFTNetNetworkInfo>

Swift connections – 203

Trax – Bank Connector user guide

</urn:NetworkInfo>
<urn:SecurityInfo>
<urn:IsSigningRequested>true</urn:IsSigningRequested>
<urn:SWIFTNetSecurityInfo>
<urn:IsNRRequested>true</urn:IsNRRequested>
<urn:FileDigestAlgorithm>SHA-256</urn:FileDigestAlgorithm>
<urn:FileDigestValue>aOQf2nvIbzRldbIdHuOZyDI8zB33+sgHU27UCpm/
N8w=</urn:FileDigestValue>
</urn:SWIFTNetSecurityInfo>
</urn:SecurityInfo>
<urn:FileLogicalName>Test_payload_2302131132040008</urn:FileLogicalName>
</urn:Message>
</urn:Header>
<urn:Body>Test_payload_2302131132040008</urn:Body>
</urn:DataPDU>

In the XMLv2 revision 14 message format, the LAU can be embedded in the Protocol Data Unit (PDU) of the
message. When using the filebased AFT connection method, the LAU will always be embedded in the PDU
message. When setting the generatelauprefix property to "true", the LAU will also be added as a binary prefix
to the PDU message.
For the SOAP connection method, the LAU is always included in the SOAP envelope header of the message.
Additionally, you can include the LAU in the PDU message as well, by setting the addlausignatureinxml to
true.

example of XMLv2 revision 2.0.14 message with LAU key embedded in the PDU message

<?xml version="1.0"?>
<Saa:DataPDU xmlns:Saa="urn:swift:saa:xsd:saa.2.0">
<Saa:Revision>2.0.14</Saa:Revision>
<Saa:Header>
<Saa:Message>
<Saa:SenderReference>2302131709210002</Saa:SenderReference>
<Saa:MessageIdentifier>pain.xxx.echos</Saa:MessageIdentifier>
<Saa:Format>File</Saa:Format>
<Saa:Sender>
<Saa:DN>ou=m05,o=ptsailbm,o=swift</Saa:DN>
</Saa:Sender>
<Saa:Receiver>
<Saa:DN>ou=m05,o=ptsailbm,o=swift</Saa:DN>
</Saa:Receiver>
<Saa:InterfaceInfo>
<Saa:UserReference>2302131709210002</Saa:UserReference>
<Saa:ProductInfo>
<Saa:Product>
<Saa:VendorName>Sungard</Saa:VendorName>
<Saa:ProductName>Sungard</Saa:ProductName>
<Saa:ProductVersion>2.2</Saa:ProductVersion>
</Saa:Product>
</Saa:ProductInfo>

Swift connections – 204

Trax – Bank Connector user guide

</Saa:InterfaceInfo>
<Saa:NetworkInfo>
<Saa:Priority>Normal</Saa:Priority>
<Saa:IsPossibleDuplicate>false</Saa:IsPossibleDuplicate>
<Saa:IsNotificationRequested>true</Saa:IsNotificationRequested>
<Saa:Service>swift.generic.fa!x</Saa:Service>
<Saa:SWIFTNetNetworkInfo>
<Saa:FileInfo>SwCompression=None;CharacterSet=ASCII;</Saa:FileInfo>
<Saa:NotificationResponderDN>ou=m05,o=ptsailbm,o=swift</Saa:NotificationRes
ponderDN>
<Saa:NotificationRequestType>xsys.xxx.delnotif</Saa:NotificationRequestType
>
</Saa:SWIFTNetNetworkInfo>
</Saa:NetworkInfo>
<Saa:SecurityInfo>
<Saa:IsSigningRequested>true</Saa:IsSigningRequested>
<Saa:SWIFTNetSecurityInfo>
<Saa:IsNRRequested>true</Saa:IsNRRequested>
<Saa:FileDigestAlgorithm>SHA-256</Saa:FileDigestAlgorithm>
<Saa:FileDigestValue>vyExBwhtpRVu4OKJprRVqc20qn0WZcmg/vEuLdbkYZc=</Saa:File
DigestValue>
</Saa:SWIFTNetSecurityInfo>
</Saa:SecurityInfo>
<Saa:FileLogicalName>Test_payload_2302131709200001</Saa:FileLogicalName>
</Saa:Message>
</Saa:Header>
<Saa:Body>Test_payload_2302131709200001</Saa:Body>
<Saa:LAU>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-excc14n#"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#hmacsha256"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#envelopedsignature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
<ds:DigestValue>+BetuJURQex4Tx7LB1DJE2/u1RguEeRcGy68JZe5wtA=</ds:DigestValu
e>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>WGofCPAsgGKEkgtI/Pe0EDzX9rW42hBKuo5TIwmyJcI=</ds:SignatureVa
lue>
</ds:Signature>
</Saa:LAU>
</Saa:DataPDU>

Swift connections – 205

Trax – Bank Connector user guide

example of XMLv2 revision 2.0.14 message with LAU key embedded in the SOAP envelope of the
message

<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
<SOAP-ENV:Header>
<SAAHeader xmlns="urn:swift:saa:xsd:soapha" Id="SAAHeader">
<SessionToken>e23f5725-157d-438f-9ceb-9fa7d260</SessionToken>
<SequenceNumber>3</SequenceNumber>
</SAAHeader>
<wss:Security xmlns:wss="http://docs.oasis-open.org/wss/2004/01/oasis-200401wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/
oasis-200401-wss-wssecurity-utility-1.0.xsd" SOAP-ENV:actor="urn:swift:saa" wsu:Id="I
D_Security">
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/
xml-exc-c14n#"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsigmore#hmac-sha256"/>
<ds:Reference URI="#ID_SOAPforTRAX3">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xmlexc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/
xmldsig#sha1"/>
<ds:DigestValue>pjYfAy6CsDf/LOc9aoToAeov5UI=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>BZz4xo4ARg8KLPwEz/fVQGpd8b7H4deSk8VpIJzSbQA=</ds:S
ignatureValue>
<ds:KeyInfo Id="ID_SOAPforTRAX3">
<ds:KeyName>SOAPforTRAX3</ds:KeyName>
</ds:KeyInfo>
</ds:Signature>
</wss:Security>
</SOAP-ENV:Header>
<SOAP-ENV:Body Id="SAAPayload">
<urn:Put xmlns:urn="urn:swift:saa:xsd:soapha">
<urn1:DataPDU xmlns:urn1="urn:swift:saa:xsd:saa.2.0">
<urn1:Revision>2.0.14</urn1:Revision>
<urn1:Header>
<urn1:Message>
<urn1:SenderReference>2302131358090003</urn1:SenderReference>
<urn1:MessageIdentifier>pain.xxx.soapfortrax3</urn1:MessageId
entifier>
<urn1:Format>File</urn1:Format>
<urn1:Sender>
<urn1:DN>ou=itb2,o=ptscfrhh,o=swift</urn1:DN>
</urn1:Sender>

Swift connections – 206

Trax – Bank Connector user guide

<urn1:Receiver>
<urn1:DN>ou=itb2,o=ptscfrhh,o=swift</urn1:DN>
</urn1:Receiver>
<urn1:InterfaceInfo>
<urn1:UserReference>2302131358090003</urn1:UserReference>
<urn1:ProductInfo>
<urn1:Product>
<urn1:VendorName>Sungard</urn1:VendorName>
<urn1:ProductName>Sungard</urn1:ProductName>
<urn1:ProductVersion>2.2</urn1:ProductVersion>
</urn1:Product>
</urn1:ProductInfo>
</urn1:InterfaceInfo>
<urn1:NetworkInfo>
<urn1:Priority>Normal</urn1:Priority>
<urn1:IsPossibleDuplicate>false</urn1:IsPossibleDuplicate
>
<urn1:IsNotificationRequested>true</urn1:IsNotificationRe
quested>
<urn1:Service>swift.generic.fa!x</urn1:Service>
<urn1:SWIFTNetNetworkInfo>
<urn1:FileInfo>SwCompression=Gzip;CharacterSet=ASCII;
</urn1:FileInfo>
<urn1:NotificationResponderDN>ou=itb2,o=ptscfrhh,o=sw
ift</urn1:NotificationResponderDN>
<urn1:NotificationRequestType>xsys.xxx.delnotif</urn1:
NotificationRequestType>
</urn1:SWIFTNetNetworkInfo>
</urn1:NetworkInfo>
<urn1:SecurityInfo>
<urn1:IsSigningRequested>true</urn1:IsSigningRequested>
<urn1:SWIFTNetSecurityInfo>
<urn1:IsNRRequested>true</urn1:IsNRRequested>
</urn1:SWIFTNetSecurityInfo>
</urn1:SecurityInfo>
<urn1:FileLogicalName>CbUW3bNoSKM-AAAAAAAAAAA</urn1:FileLogic
alName>
</urn1:Message>
</urn1:Header>
<urn1:Body>CbUW3bNoSKM-AAAAAAAAAAA</urn1:Body>
</urn1:DataPDU>
<urn:attachment>attachment1</urn:attachment>
</urn:Put>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>

9.5 Routing Swift response messages to the backend application
Bank Connector reconciles the Swift response messages with the outgoing message and will update the
status of the message in Bank Connector accordingly.

Swift connections – 207

Trax – Bank Connector user guide

There are three different ways of processing response messages in Bank Connector:
• Event: An event is an intermediate response. They are logged for information purposes only and do
not trigger an update of the status of the message to SENT or FAILED. In Bank Connector they will be
visible in the data history section of the outgoing message. Events only have to be configured
explicitly if the intermediate response has to be routed to the backend application. In Trax, the events
will be visible in the processing history of the communication.
• Response: the message is considered as a final response. It will update the status of the outgoing
message in Bank Connector to SENT or FAILED and the response will be routed to the backend
application. In Trax this will update the status of the message to "SENT" or "SENDING FAILED".
• Request: the response message will be routed to the backend application as a new request.
Whether a response message is processed as event, response or request is defined by a set of subscriptions
that are set up in the originating backend channel.

9.5.1 Types of response messages
Depending on the message format, Bank Connector can process the following response messages:

Channel

Messa
ge
format

Response message

Description

Filter

FIN

RJE

F21 / ACK

Acknowledgement

ACK

FIN

RJE

F21 / NAK

Negative
Acknowledgement

NAK

FIN

RJE

MT011

Delivery Notification

MT011

FIN

RJE

MT010

Non-Delivery Warning

MT010

FIN

RJE

MT015

Delayed NAK

MT011

FIN

RJE

MT019

Abort Notification

MT019

FIN, FileAct,
FINplus

XMLv2

TransmissionReport /
NetworkAcked

Acknowledgement

NetworkAcked

FIN, FileAct,
FINplus

XMLv2

TransmissionReport /
NetworkNacked

Negative
Acknowledgement

NetworkNacke
d

Swift connections – 208

Trax – Bank Connector user guide

Channel

Messa
ge
format

Response message

Description

Filter

FIN, FileAct,
FINplus

XMLv2

TransmissionReport / Netwo
rkRejectedLocally

Rejected before emission

NetworkReject
edLocally

FIN, FileAct,
FINplus

XMLv2

TransmissionReport / Netwo
rkAborted

Abort Notification

NetworkAbort
ed

FIN, FileAct,
FINplus

XMLv2

DeliveryReport / RcvDelivered

Delivery Notification

RcvDelivered

FIN, FileAct,
FINplus

XMLv2

DeliveryReport /
RcvDelayedNak

Delayed NAK

RcvDelayedNa
k

FIN, FileAct,
FINplus

XMLv2

DeliveryReport / RcvAborted

Abort Notification

RcxAborted

FIN, FileAct,
FINplus

XMLv2

DeliveryReport /RcvOverdue

Overdue Notification

RCVOverdue

FIN, FileAct,
FINplus

XMLv2

DeliveryReport /RcvUnknown

Unknown Notification

RcvUnknown

9.5.2 Configuring subscriptions
The subscriptions are set up in the outgoingresponse - outgoing section of the backend channel config file.

outgoingresponse-outgoing configuration

outgoingresponse:
- outgoing:
subscriptions:
- subscription:
filter:
code:
status:
source:
- subscription:
filter:
code:

Swift connections – 209

Trax – Bank Connector user guide

status:
source:

Property

Description

Mandatory / Optional

filter

specifies the type of response messages. This can
be a comma separated list. See the table above for
each response message and its corresponding
filter

M

code

"EVENT", "RESPONSE" or "REQUEST"

M

status

"SENT" or "FAILED". The status only has to be
specified if the code is "RESPONSE"

O

source

specifies the channel through which the outgoing
message is processed. If not configured, the
subscription is valid for all channels

O

9.5.2.1 Default subscriptions
Bank Connector provides a default set of subscriptions so that they do not have to be configured explicitly.

filter

code

status

source

NetworkNacked, NAK,
NetworkRejectedLocally, NetworkAborted

RESPONSE

FAILED

ACK, NetworkAcked

RESPONSE

SENT

NetworkAcked

EVENT

RcvDelivered

RESPONSE

SENT

FILEACT

RcvAborted, RcvDelayedNak, RcvOverdue,
RcvUnknown

RESPONSE

FAILED

FILEACT

NetworkAcked

EVENT

FIN
FILEACT

FINPLUS

Swift connections – 210

Trax – Bank Connector user guide

filter

code

status

source

RcvDelivered

RESPONSE

SENT

FINPLUS

RcvAborted, RcvDelayedNak, RcvOverdue,
RcvUnknown

RESPONSE

FAILED

FINPLUS

FAILED

RESPONSE

FAILED

9.5.2.2 Defining custom subscriptions
It is possible to set up custom subscriptions to cover specific scenarios.
• No Delivery notifications are received for FileAct messages. The status of the messages has to be
updated to SENT or FAILED based on the transmission report. With these subscriptions, the status of
the message will be updated based on the transmission report or the F21 ACK/NACK for FIN,
FILEACT and FINPLUS channel.

subscriptions:
- subscription:
filter: "NetworkNacked, NetworkRejectedLocally"
code: "RESPONSE"
order: "true"
status: "FAILED"
source: "FILEACT"
- subscription:
filter: "NetworkAcked"
code: "RESPONSE"
order: "true"
status: "SENT"
source: "FILEACT"

• A FIN ACK/NAK message needs to be sent to the originating backend application as a new request.

subscriptions:
- subscription:
filter: "NetworkNacked, NAK"
code: "RESPONSE"
order: "true"
status: "FAILED"
- subscription:
filter: "ACK, NetworkAcked"
code: "RESPONSE"
order: "true"
status: "SENT"

Swift connections – 211

Trax – Bank Connector user guide

source: "FIN"
- subscription:
# a request will be generated with targetprofile "ACK_request"
filter: "ACK, NetworkAcked"
code: "REQUEST"
targetprofile: "ACK_request"
# An entry has to be added to the targetconnection-incoming section as well to route
the message to the relevant backend application.
targetconnection:
- incoming:
profile: "ACK_request"

9.5.2.3 Setting up more than 1 set of subscription
It is possible to set up a different set of subscriptions per targetconnection. The example below describes
the setup if there is one bank for FileAct that will not send Delivery Notifications. For that particular bank, the
status of the FileAct messages need to be updated to SENT based on the transmission report.
Swift channel configuration
A "responseprofile" property can be defined in each targetconnection - outgoing section. This
responseprofile refers to a list subscriptions that can be set up in the originating backend application.

fileact:
laukey: "Abcdefghijklm1230123456789Abcdef"
laukeyexpirydate: "28-02-2030"
maxretry: "5"
retryinterval: "2000"
isproducepduforrequest: "false"
default:
targetconnection:
outgoing:
uri: "https://10.215.24.111:48200/soapha/"
actor: "FileActSOAPActor"
messagepartner: "SOAPforTRAX3"
windowsize: "10"
truststore: "ssb-truststore.jks"
truststorepassword: "{AES}hLbwEhLNSs+1otvMQ9hZjw=="
sourceconnection:
incoming:
uri: "https://10.215.24.111:48200/soapha/"
actor: "FileActSOAPActor"
messagepartner: "SOAPforTRAX3"
truststore: "ssb-truststore.jks"
truststorepassword: "{AES}hLbwEhLNSs+1otvMQ9hZjw=="
profile:
service: "swift.generic.fa!x"
requesttype: "pain.xxx.soapfortrax3"
senderdn: "ou=itb2,o=ptscfrhh,o=swift"
receiverdn: "ou=itb2,o=ptscfrhh,o=swift"

Swift connections – 212

Trax – Bank Connector user guide

isnotificationrequested: "true"
notificationrequesttype: "xsys.xxx.delnotif"
notificationresponderdn: "ou=itb2,o=ptscfrhh,o=swift"
fileinfo: "SwCompression=Gzip"
issigningrequested: "true"
isnrrequested: "true"
# For FileAct profile "BNP_PAIN001_SEPA", a specific set of subscriptions
"BNP_PAIN001_SEPA_RESPONSE" will be used. For all other banks, the default
subscriptions will be used.
targetconnection:
- outgoing:
profile: "BNP_PAIN001_SEPA"
responseprofile: "BNP_PAIN001_SEPA_RESPONSE"

Originating backend channel configuration
The subscriptions are set up in the outgoingresponse-outgoing section in the backend channel config file.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
# The default response subscriptions will be used generally.
responseprofile: "default_response"
targetconnection:
incoming:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
outgoingresponse:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
outgoingresponse:

Swift connections – 213

Trax – Bank Connector user guide

# this section contains the specific subscription options for responseprofile
"BNP_PAIN001_SEPA_RESPONSE"
- outgoing:
profile: "BNP_PAIN001_SEPA_RESPONSE"
subscriptions:
- subscription:
filter: "NetworkNacked, NAK"
code: "RESPONSE"
order: "true"
status: "FAILED"
- subscription:
filter: "ACK, NetworkAcked"
code: "RESPONSE"
order: "true"
status: "SENT"

Swift connections – 214

Trax – Bank Connector user guide

10 EBICS connection
Electronic Banking Internet Communication Standard (EBICS) is an Internet-based communication and
security standard that is primarily used for remote data transfer between your organization and a bank for
corporate payment transactions.
EBICS allows data file exchange independent of message standards and formats. EBICS uses established
digital signature and encryption procedures. Its features are based on international standards for internet
communication and improved security, for example XML, HTTPS, TLS. EBICS also has multibank capability
wherein the corporate clients in the countries that have adopted EBICS can transact with any bank in those
countries using the same software.
What has changed in EBICS 3.0
• One standard for all countries: Up to EBICS version 2.5, a distinction was made between German,
French and Swiss EBICS. This created barriers for banks, customers and manufacturers alike when
different EBICS dialects had to be handled equally. EBICS 3.0 starts right here and with its universal
standard offers the right solution for the whole of Europe.
• Banking transactions via BTFs instead of order types: EBICS v3.0 replaces the use of banking order
types (or file formats in French or Swiss EBICS) with the so-called Business Transaction Formats, or
BTFs for short. Up to EBICS v2.5, the specification of an order type, e.g. CCT for standard SEPA
transfers, was sufficient to determine the business transaction. A BTF, however, allows more values.
• Electronic keys: The most important change for the keys concerns the use of certificates. As of
EBICS 3.0, all keys must always be transferred as X.509 certificates. In addition, the minimum length
for the various key types has been increased to 2048 bits and the A004 format has been removed
from the standard.
• Uniform customer protocol: The adapted version of the customer protocol HAC in XML format
replaces previous text-based versions. The cumbersome and error-prone proprietary parsing of the
protocol is eliminated.

10.1 Managing bank servers and customers
10.1.1 Configure the bank server connection details
The bank server details are set up in the ebics-config yml file. Multiple bank servers can be configured at
once.

EBICS connection – 215

Trax – Bank Connector user guide

bank server details in ebics-config.yml with sample data
bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
tokensigning: "false"

- bankserver:
code:
hostid:
url:
sslservercertificate:
protocolversion:
protocolvariant:
recoverysupported:
prevalidationsupported:
tokensigning:

Property

Description

Mandatory /
Optional

code

ID of the bank server used by the application internally. It must be
alphanumeric and unique..

M

hostid

The EBICS host ID of the bank server, this is defined by the
partner bank.

M

url

The URL of the bank server

M

sslservercertificate

The SSL server certificate of the bank server. The name of the
SSL server certificate must match the name with which the
certificate has been imported in Bank Connector.

M

protocolversion

Bank Connector only supports EBICS 3.0 which corresponds to
protocol version H005.

M

EBICS connection – 216

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

protocolvariant

Can be DE or FR.

M

recoverysupported

Bank server has recovery support. Set to true if recovery is
supported by the bank server. This means that corrupt data can
be resent in one-megabyte blocks to save bandwidth and time.

M (false as
of now)

Possible values are true/false.
prevalidationsupport
ed

Bank server has prevalidation support. Set to true if prevalidation is supported by the bank server. This means that the
message undergoes checks before it is completely uploaded.
This saves time and bandwidth for example in case of incorrect
signatures, which would otherwise only be detected after full
upload.

M (false as
of now)

Possible values are "true" and "false".
tokenssigning

To bet set to "true" if payments will be signed using a 3SKey
token

O

The default value is "false"

10.1.2 Exchanging the bank's public certificates
The bank server SSL certificate is required to establish a secure connection between Bank Connector and
the bank. The certificate will be provided by the bank. Bank Connector only accepts SSL certificates in DER
format.
The certificate is imported in Bank Connector together with the channel configuration files.
1. Go to the Configuration Screen
2. Export and unzip the channel configuration
3. Add a KEYS folder and store the certificate that has to be imported in the KEYS folder. The name of
the certificate must match exactly with the names with which the keys are referenced in the channel
configuration.
4. Create a .zip file with the KEYS folder included, and import the .zip file
5. Go to the Keys screen to check that the certificate have been correctly imported in Bank Connector. If
you select the certificate in the list, this will display a list of channels and configuration files in which
the certificate is referenced. This list will be empty If there is a discrepancy between the name of the
certificate and its reference in the EBICS channel configuration.
The bank server authentication and encryption certificate will be will be downloaded by using the HPB order
type. Fetching and storing the certificates will happen automatically in the background when a connection
with the bank is established for the first time.

EBICS connection – 217

Trax – Bank Connector user guide

10.1.3 Configure the customer details
The customer details are based upon a contractual agreement with the bank. The customer details for a
bank are set up in the ebics-config yml file. Multiple customers can be configured per bank.

customer details in ebics-config.yml with sample data
bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD01"
description: "Demo test customer"
unattendedsignatures: "1"

Property

Description

Mandatory /
Optional

id

The EBICS customer ID (partner ID). This value will be provided
by the bank.

M

profiles

Comma separated list of target profiles.

M

description

Free text description

M

unattendedsignature
s

Determines if unattended or attended signing is required for the
customer. Maximum 2 unattendedsignatures are supported.

M

EBICS connection – 218

Trax – Bank Connector user guide

10.2 Managing users
10.2.1 Setting up EBICS users
The user details are set up in the ebics-users yml file.

sample ebics-users.yml
users:
- user:
id: ""
customerid: ""
description: ""
signer: ""
download: ""
technical: ""
linkedtraxuser:
tokenserialnumber:
- user:
id: ""
customerid: ""
description: ""
signer: ""
download: ""

Property

Description

Mandatory /
Optional

id

EBICS user id as defined by the bank.

M

customerid

The id of the customer as defined in the ebics-config file to
which the user is linked.

M

description

Free text description

M

signer

Determines if the user can be used for unattended signing.
Possible values are "true" or "false".

M

EBICS connection – 219

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

download

Determines if the user can be used as default download user.
Possible values are "true" or "false"

M

technical

Determines if the user can be used as transport user. Possible
values are "true" or "false"

M

linkedtraxuser

The code of the Trax user signing payments in Trax. This is only
applicable for attended signing. More than one Trax user can be
added in a comma separated list. This means that these users
will share the same keys.

O

tokenserialnumber

serial number of the 3SKey token that will be assigned to the
ebics user

O

10.2.2 Authenticating the EBICS user with the bank
After the EBICS configuration (containing bank servers, customer profiles and users) is imported
successfully in Bank Connector, the EBICS users need to be authenticated before they can communicate
with the bank.
When a user is first associated with a customer profile, the user status is blank in Bank Connector.
User authentication with the bank requires the following steps:
• For every user, three user keys (Signature, Encryption and Authentication) need to be generated
and sent to the bank. Bank Connector exchanges both the INI (public part of signature key) and HIA
(public part of encryption and authentication key) with the bank.
• In Bank Connector go to EBICS → Bank server and select one of bank servers from the list.
Select one of the users from the list having a blank status and click the Initialize keys action.
If both INI and HIA order types were successfully transmitted to the bank, the user status will
be updated to "Initialized".

This Initialize keys action will generate :

EBICS connection – 220

Trax – Bank Connector user guide

• signer key: signing of the message the user sends to the bank
• authentication key: authentication of the user by the bank
• encryption key: decrypt messages fetched from the bank by the user
For generating the above listed user keys, the below attribute values will be used:
• sign version : A006
• sign key password : the password will be auto-generated
• authentication version: X002
• authentication key password: The password will be auto-generated
• encryption version: E002
• encryption key password: The password will be auto-generated
• The initialization letters of the INI and HIA keys are printed, and physically sent to the bank. The bank
will use them to verify the hash values in the certificates against its database.
• In Bank Connector, select one of the users having a status "Initialized", and click the Print INI
or Print HIA action. The INI or HIA letter will be downloaded in PDF format. They need to be
sent to the bank's EBICS administrator, who will check the validity of the credentials that were
sent electronically during the initialization phase, and release the user on the bank's side.
• After successful verification, the user is released manually by the bank and is then ready to be used..

10.2.3 Authenticating the EBICS user with the bank when using a 3SKey token
When using a 3SKEY token, Bank Connector will only generate the EBICS user authentication and encryption
key. The EBICS user signer key is stored on the 3SKey token. When assigning the 3SKey token to a Trax user
using the Trax signer app, the public part of the signature key will be sent to Bank Connector after which the
EBICS user can be initialized in bank Connector.
User authentication with the bank requires the following steps:

10.2.3.1 Bank Connector prerequisites
• Add the Trax user and the token serial number that will be assigned to the Trax user via the Trax
signer app to the EBICS user in the ebics-users,yml file.

sample ebics-users.yml
users:
- user:
linkedtraxuser:
tokenserialnumber:

EBICS connection – 221

Trax – Bank Connector user guide

The token serial number can be found by using the safenet application or on the token itself. If the token
serial number contains leading zeroes, they have to be removed.

• Add an outgoing entry to the targetconnection section in the trax-config.yml file in order to process
the message containing the public part of the signature key.

sample trax-config.yml
trax:
targetconnection:
- outgoing:
profile: "BankConnector_USER_SIGNATURE_CERTIFICATE"
actor: "Ebics3skeyCertProducerActor"

10.2.3.2 Trax prerequisites
• Change the value of the application property "enablecertificatesharing" from "false" to "true".

EBICS connection – 222

Trax – Bank Connector user guide

10.2.3.3 Actions in Trax
• Assign the 3SKey token to a Trax user via the Trax signer app.

EBICS connection – 223

Trax – Bank Connector user guide

Select SWIFT_3SKEY as signing method and click next

Select a Trax user and click finish

EBICS connection – 224

Trax – Bank Connector user guide

Go to User management - users to check that the public part of the signature key is assigned to the Trax
user.

10.2.3.4 Actions in Bank Connector
When assigning the 3SKey token to the Trax user, the public part of the signature key will be forwarded to
Bank Connector automatically through a jms message.

EBICS connection – 225

Trax – Bank Connector user guide

Go to Messages and filter on EBICS-USER to check the status of the message.

The EBICS user is now ready to be initialized.
Go to EBICS → Bank server and select one of bank servers from the list. Select one of the users from the list
having a status "Ready to be initialized" and click the Initialize keys action. If both INI and HIA order types
were successfully transmitted to the bank, the user status will be updated to "Initialized".

10.2.4 Other actions on users
The Change keys function allows you to update the credentials (certificates or keys) of a user without having
to reinitialize it. Use this function to update compromised or outdated credentials.
It changes information for the signature, authentication or encryption keys like the key version, or the
password. This action changes the keys by electronically sending the PUB order type for the signature key
and/or the HCA order type for the authentication and encryption key to the bank server.
This can be done by clicking on Change keys action button on GUI.
The Delete keys action will delete key information of the signature key, authentication key and encryption
key. The status of the user will be updated from "Initialized" to blank again. The Delete keys action will only
delete the keys information in Bank Connector. Initializing the user again can only be done in agreement with
the bank.
The Lock user action will send the SPR order type. This uploads a user revocation and will cause the user to
become locked as a safety measure to prevent others from using a compromised user identity. The status of
the user will be updated from "Initialized" to "Suspended" again. The user can be intialized again withe the
Initialize keys action.

EBICS connection – 226

Trax – Bank Connector user guide

The Change keys and Lock user actions cannot be done if the user authentication is done using 3SKey
tokens. Instead, the user keys have to deleted via the Delete keys action and the user has to be initialized
again.

10.2.5 Changing the key length and key password length
By default, Bank Connector will generate the signer, encryption and authentication key with a 2048 bits key
length. This is the minimum requirement for EBICS 3.0. It is possible to increase the key length to max 4096
bits by adding the property userkeylength to the bank server configuration in the ebics-config file.

sample ebics-config file
bankservers:
- bankserver:
code: "BADEQA01"
userkeylength: "4096"

The auto-generated key password have a length of 12 by default. This can be updated by adding the property
userkeypasswordlength to the bank server configuration in the ebics-config file.

sample ebics-config file
bankservers:
- bankserver:
code: "BADEQA01"
userkeypasswordlength: "20"

10.2.6 Troubleshooting
If a user action cannot be completed successfully, an error message will be displayed. Detailed information
on the error can be found in the logs.

EBICS connection – 227

Trax – Bank Connector user guide

If after assigning a 3SKey token to a Trax user via the Trax signer app, the status of the corresponding EBICS
user is not updated to "Ready to be initialized", you can check the status of the jms message for detailed
error information.

10.3 Transaction upload
Bank Connector supports both attended and unattended signing when sending transactions. Unattended
signing is signing done by the EBICS connector itself, using an EBICS user that is not linked to an actual Trax
user. The EBICS connector will provide the signature of an EBICS user independent of who signed it in Trax.
Up to 2 unattended signatures are supported. To use attended signing, the Trax signing administration must
have been set up. The Trax users having signed the payment in Trax, will be forwarded to Bank Connector.
Via the linking between the Trax user and an EBICS user in bank Connector, The EBICS connector will provide
the signature of the linked EBICS user.

EBICS connection – 228

Trax – Bank Connector user guide

Bank Connector also supports the concept of a technical user (sometimes called "transport user"), who can
submit files (signed by one or more signing users) with a transport signature. Technical users can only send
files, they cannot sign payments, but they can be used both in an unattended and attended signing setup.
As from EBICS 3.0, the business transactions order types such as CCT (representing a pain.001.002.03 SEPA
payment) have been replaced by Business Transaction Formats (BTF). For uploading transactions, the
administrative order type BTU (Business Transaction Upload) is used. The official list of supported BTF's can
be downloaded from https://www.ebics.org/en/technical-information/ebics-specification. Next to this,
banks can publish an additional list of supported BTF and their mapping to business transaction order types.
BTF can be configured in Bank Connector in the ebics-btfmap file.
In EBICS 3.0 the customer acknowledgement PTK has been replaced by the HAC order type. Bank
Connector parses the HAC file and reconciles the responses with the uploaded transactions. The status of
the transactions will be updated to "sent" or "failed" accordingly. The HAC can be requested immediately
after the transaction upload or at regular intervals through a scheduled job.
As most French banks do not have a different ebics set up for production and test, the test mode allows to
send payments in a production set up that will be validated but not processed by the banks
With the property "test mode", you can switch between test and production mode when sending payments to
the bank.

10.3.1 Unattended and attended signing
10.3.1.1 Setting up unattended signing
You can activate unattended signing for a given customer by setting the unattendedsignatures property for
the customer to "1" or "2".

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD01"
description: "Demo test customer"
unattendedsignatures: "2"

Depending on the number of unattended signatures required, 1 or 2 EBICS users linked to the customer have
to be configured for unattended signing.

EBICS connection – 229

Trax – Bank Connector user guide

users:
- user:
id: "USDEQA01"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "true"
download: "true"
- user:
id: "USDEQA02"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "true"
download: "false"

10.3.1.2 Setting up attended signing
10.3.1.2.1 Bank Connector setup
Activating attended signing for a given customer is done by setting the unattendedsignatures property for
the customer to "0".

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD01"
description: "Demo test customer"
unattendedsignatures: "0"

The Trax users signing the payments in Trax, have to be linked to an EBICS user in Bank Connector.

EBICS connection – 230

Trax – Bank Connector user guide

users:
- user:
id: "USDEQA01"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "false"
download: "true"
linkedtraxuser: "s1,s2"
- user:
id: "USDEQA02"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "false"
download: "false"
linkedtraxuser: "s3,s4"

10.3.1.2.2 Trax setup
When the Trax signing mandates have been set up in Trax, the Trax users having signed the payments will be
forwarded to Bank Connector. As from Trax version 7.17, the signers are automatically forwarded to Bank
Connector as extra jms parameters.
When using a version older than 7.17, extra configuration has to be imported in Trax to transfer the signers.

10.3.1.3 Setting up 3SKey token signing
10.3.1.3.1 Bank Connector setup
Activating 3SKey token signing is done by adding the property "tokensigning" with value "true" to the
bankserver configuration. For all customers, the "unattendedsignatures" property has to be set to "0".

EBICS connection – 231

Trax – Bank Connector user guide

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
tokensigning: "true"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD01"
description: "Demo test customer"
unattendedsignatures: "0"

he Trax users signing the payments in Trax, have to be linked to a token serial number in Bank Connector.

users:
- user:
id: "USDEQA01"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "false"
download: "true"
linkedtraxuser: "s1"
tokenserialnumber: "2bbb2c5"

10.3.1.3.2 Trax setup
When the Trax signing mandates have been set up in Trax, the token serial number with which the Trax users
havie signed the payments together with the signatures will be forwarded to Bank Connector.
When setting up the Trax outgoing routing, signing method "BC_3SKEY_EBICS_A006" needs to be selected in
the signature section.

EBICS connection – 232

Trax – Bank Connector user guide

10.3.2 3SKey token signing
10.3.2.1 Setting up 3SKey token signing
10.3.2.1.1 Bank Connector setup
Activating 3SKey token signing is done by adding the property "tokensigning" with value "true" to the
bankserver configuration. For all customers, the "unattendedsignatures" property has to be set to "0".

EBICS connection – 233

Trax – Bank Connector user guide

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
tokensigning: "true"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD01"
description: "Demo test customer"
unattendedsignatures: "0"

The Trax users signing the payments in Trax have to be linked to a token serial number in Bank Connector.

users:
- user:
id: "USDEQA01"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "false"
download: "true"
linkedtraxuser: "s1"
tokenserialnumber: "2bbb2c5"

10.3.2.1.2 Trax setup
When the Trax signing mandates have been set up in Trax, the token serial number with which the Trax users
have signed the payments, together with the signatures will be forwarded to Bank Connector as JMS
parameters.

EBICS connection – 234

Trax – Bank Connector user guide

When setting up the Trax outgoing routing, the signing method "BC_3SKEY_EBICS_A006" needs to be
selected in the signature section.

10.3.3 Submitting files with a technical user
A technical user can submit files (signed by one or more signing users) with a transport signature. Technical
users can only send files, they cannot sign payments, but they can be used both in an unattended and
attended signing setup.

10.3.3.1 Activating the technical user
You can activate the technical user for a given bank by setting the "usetechnicaluser" property to "true".

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
usetechnicaluser: "true"

When the "usetechnicaluser" property is true, there should be one user assigned as technical user for each
customer linked to the bank server. All transactions for that customer will be submitted with the transport
signature of that technical user.

EBICS connection – 235

Trax – Bank Connector user guide

users:
- user:
id: "USDEQA01"
customerid: "CUDEQA02"
description: "Demo test user"
signer: "false"
download: "true"
technical: "true"
- user:
id: "USDEQA02"
customerid: "CUDEQA02"
description: "Demo test user"
signer: "false"
download: "false"
technical: "true"

The technical user should have the "signer" property set to "false" as it cannot be used for signing the
payment in unattended signing mode. The technical user should not have a linkedtraxuser assigned to it, as
it cannot be used for signing a payment in attended signing mode either.

10.3.4 Submitting files in test mode
As most French banks do not have a separate EBICS setup for production and test, the test mode allows to
send payments in a production set up that will be validated but not processed by the banks
With the property "test mode", you can switch between test and production mode when sending payments to
the bank.

10.3.4.1 Activating the test mode
You can activate the test mode for a given bank by setting the "testmode" property to "true".

bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
usetechnicaluser: "false"
testmode: "true"

When activating the test mode, an extra property "fileformat" needs to be added to the BTF definition of the
message format you want to test in the ebics-btfmap file. The list of file formats with their corresponding

EBICS connection – 236

Trax – Bank Connector user guide

BTF definitions can be found in https://www.cfonb.org/fichiers/
20180808113947_EBICS_3.0__aide_a_la_migration_V1.1.pdf (chapter 9).

ebics:
- btfmap:
code: "cfonb160dct"
ordertype: "BTU"
servicename: "DCT"
scope: "FR"
msgname: "cfonb160"
fileformat: "pain.xxx.cfonb160.dct"

The 'fileformat" property needs to be added to the btfmap only when running in test mode. This property is
not required in production mode.

10.3.5 Configuring EBICS outgoing profiles
When sending out EBICS transactions, Bank Connector will ensure that the messages are routed to the
correct bank / customer and that the correct BTF is applied to the message. This is done by configuring
EBICS profiles in Bank Connector.
Each message when entering Bank Connector will be assigned a profile. Assigning a profile to the message
can be done in Bank Connector or in the originating backend application.

10.3.5.1 BTF configuration
The BTF which are used in the outgoing profiles have to be set up in the ebics-btmap file so that bank
Connector can generate a upload request with the correct BTF properties.

EBICS connection – 237

Trax – Bank Connector user guide

sample ebics-btfmap file
ebics:
- btfmap:
code: "CCT"
ordertype: "BTU"
servicename: "SCT"
msgname: "pain.001"
- btfmap:
code: "CDD"
ordertype: "BTU"
servicename: "SDD"
serviceoption: "COR"
msgname: "pain.008"
- btfmap:
code:
ordertype:
servicename:
scope:
serviceoption:
msgname:
msgvariant:
msgversion:
msgformat:

Property

Description

Mandator
y/
Optional

code

BTF code. This is mapped with the "btfmap" property in ebicsprofile.yml (outgoing) . This code must be unique

M

ordertype

For transaction upload, this value has to be BTU (Business
Transaction Upload)

M

servicename

Service name identifies the corresponding EBICS service of the
financial institution using existing globally defined service name code
list. [A-Z0-9] length=3

M

scope

The scope parameter defines the set of rules according to which a
message file was created. [A-Z0-9] length=2 to 3

O

EBICS connection – 238

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

serviceoption

Sub-variants of a service, dependent on scope. [A-Z0-9] length=3 to 10

O

container

It identifies how files that are transmitted. [A-Z0-9] length=3. Possible
values are XML, SVC or ZIP.

O

msgname

It contains the technical designation of the message type. [az.0-9] length=1 to 10

M

msgvariant

It contains the technical designation of the message
variant. [0-9] length=3

O

msgversion

It contains the technical designation of the message
version. [0-9] length=2

O

10.3.5.2 EBICS profile configuration in Bank Connector
The EBICS profiles are configured in the ebics-profile file and in the ebics-config file.
Via the EBICS profile, Bank Connector will apply the correct BTF to the outgoing EBICS transaction.

sample ebics-profile file
ebics:
- profile:
code: "CUDEQA01_SCT01"
btfmap: "CCT"
fetchimmediatehac: "false"
- profile:
code: "CUDEQA01_SDD"
btfmap: "SDD"
fetchimmediatehac: "false"

Property

Description

Mandatory /
Optional

code

Profile code. This has to be a unique reference.

M

EBICS connection – 239

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

btfmap

BTF code. This has to correspond to one of the btfmap codes that are
defined in the ebics-btfmap file and will determine the BTF properties
applied to the uploaded transaction.

M

fetchimmedia
tehac

The Customer Acknowledgement (HAC) will be downloaded
immediately after the upload of the transaction if set to "true". If set to
"false", the HAC has to be downloaded via a scheduled job.

M

The same profile also have to be linked to a customer in the ebics-config file. This ensures Bank Connector
will route the message to correct bank / customer.

sample ebics-config file
bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
usedefaultprofile: "false"
customers:
- customer:
id: "CUDEQA01"
profiles: "CUDEQA01_SCT01,CUDEQA01_SDD"
description: "Demo test customer 1"
unattendedsignatures: "2"

10.3.5.3 EBICS profile configuration in Trax
Messages originating from Trax are assigned a target profile before being sent to Bank Connector. This
profile must correspond to one of the profiles set up in ebics-profile file in Bank Connector.
The configuration is done by setting up these profiles as Integration channel - outgoing profiles in Trax.
For Trax version > 7.11, the profiles have to be set up in the following way:

EBICS connection – 240

Trax – Bank Connector user guide

For Trax version < 7.12, the profiles have to be set up in the following way:

10.3.5.4 Working with default profiles
An outgoing profile has to be defined for every customer / BTF combination to correctly route outgoing
messages. This can lead to a high amount of profiles to be set up and maintained in Bank Connector.
In order to avoid this, it is also possible for the backend application to provide customer and BTF as
metadata of the message. Based on this information, Bank Connector will be able to correctly route the
message.

EBICS connection – 241

Trax – Bank Connector user guide

When the originating application is Trax, customer and BTF can be passed to Bank Connector as jms
parameters "TSGCustomerId" and "TSGBtfOrdertype". These can be defined in the integration channel outgoing profiles.

In the ebics-config file, the property usedefaultprofiles has to be set to "true". For customers using the
default profile, no profiles have to be defined in the ebics-config file and in the ebics-profile file.
In below example, the default profile will be used for the customer with id CUDEQA01 as no profiles are
assigned to it. Customer CUDEQA02 will use the standard named profiles.
The value of the TSGCustomerId defined in Trax must correspond with the id of the customer defined in the
ebics-config file.

EBICS connection – 242

Trax – Bank Connector user guide

sample ebics-config file
bankservers:
- bankserver:
code: "BADEQA01"
hostid: "SUNGARD"
url: "https://www.bankrechner.org/ebics/EbicsServlet"
sslservercertificate: "certificate-ssl-BADE001.der"
protocolversion: "H005"
protocolvariant: "DE"
recoverysupported: "false"
prevalidationsupported: "false"
usedefaultprofile: "true"
customers:
- customer:
id: "CUDEQA01"
description: "Demo test customer 1"
unattendedsignatures: "2"
- customer:
id: "CUDEQA02"
profiles: "CUDEQA02_SCT01"
description: "Demo test customer 2"
unattendedsignatures: "0"

The value of the TSGBtfOrdertype must correspond to a btfmap code defined in the ebics-btfmap file.

sample ebics-btfmap file
ebics:
- btfmap:
code: "CCT"
ordertype: "BTU"
servicename: "SCT"
msgname: "pain.001"

Messages that are processed using the default profile will have as Target Profile "Default". The CustomerID
and BtfOrdertype received from Trax, can be seen as header parameters of the message.

10.3.6 Configuring responses on uploaded transactions
10.3.6.1 Customer acknowledgement (HAC)
Feedback from the bank on the upload of transactions is reported in the Customer Acknowledgement HAC
which is downloaded by Bank Connector immediately after the upload of the transaction or via a scheduled
job. When downloading HAC, it will contain all status information since the download of the
last HAC. It contains all actions and status information of the Customer, including the responses on

EBICS connection – 243

Trax – Bank Connector user guide

uploaded transactions. Bank Connector reconciles these response messages with the uploaded transactions
and will update the status of the message in Bank Connector accordingly to "SENT" or "FAILED".
Updating the status to "SENT" or "FAILED" is done on the basis of the following response codes

Code

Description

ORDER_HAC_FINAL_POS

The order is positively completed at EBICS level, which means
that either all signatures required for approval are correct and the
order can therefore go into further processing

ORDER_HAC_FINAL_NEG

The order could not be processed on EBICS level completely for
several reasons such as due to incorrect signatures or due to a
technical error.

Apart from the final responses, intermediary events are also reconciled with the uploaded transaction.
Examples of such events are TS01 (Upload successful) or DS01 (Electronic signatures are correct).
In case of ORDER_HAC_FINAL_NEG, these intermediary event codes will contain more detailed information
on the failure reason. A complete list of event code can be found in https://www.ebics.org/en/technicalinformation/ebics-specification (2022-06-27-EBICS_V_3.0.2_FinalVersion.pdf - 10.3 Annex for HAC: External
reason codes (result of action)).

10.3.6.2 Setting up response subscriptions
Through the setup of response subscriptions, Bank Connector will update the status of a message to "SENT"
or "FAILED" and will forward the response to the originating backend application.
The response subscriptions are set up in the config file of the originating channel.
In the example below, the ORDER_HAC_FINAL_POS response will update the status of the message from
"SENDING" to "SENT" in Bank Connector. The response will also be forwarded to Trax updating the status of
the payment file from "SENDING" to "SENT" in Trax. The ORDER_HAC_FINAL_NEG response will update the
status of the message to "FAILED" in Bank Connector and to "SENDING FAILED" in Trax.

EBICS connection – 244

Trax – Bank Connector user guide

sample trax-config file
trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "JMS:trax.toTSGQueue"
responseprofile: "out_response_msgQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
incoming:
uri: "JMS:trax.fromTSGQueue?exchangePattern=InOnly"
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
outgoingresponse:
outgoing:
type: "response"
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "out_response_msgQueue"
uri: "jms-resp:trax.fromTSGQueue?exchangePattern=InOnly"
subscriptions:
- subscription:
filter: "ORDER_HAC_FINAL_POS"
code: "RESPONSE"
status: "SENT"
order: "true"
- subscription:
filter: "ORDER_HAC_FINAL_NEG"
code: "RESPONSE"
status: "FAILED"
order: "true"

EBICS connection – 245

Trax – Bank Connector user guide

The intermediary events can be also be forwarded to Trax for information.
In below example, TS01 and DS01 codes will be sent to Trax. The status of the payment file will not be
updated and the information will be accessible via the communication history of the payment file.

sample trax-config file with intermediary events
trax:
default:
sourceconnection:
outgoing:
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
uri: "JMS:trax.toTSGQueue"
responseprofile: "out_response_msgQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
incoming:
uri: "JMS:trax.fromTSGQueue?exchangePattern=InOnly"
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
outgoingresponse:
outgoing:
type: "response"
brokerurl: "tcp://default-bank-connector-artemis:61617?
sslEnabled=true&randomize=false"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "out_response_msgQueue"
uri: "jms-resp:trax.fromTSGQueue?exchangePattern=InOnly"
subscriptions:
- subscription:
filter: "ORDER_HAC_FINAL_POS"
code: "RESPONSE"
status: "SENT"
order: "true"
- subscription:

EBICS connection – 246

Trax – Bank Connector user guide

sample trax-config file with intermediary events
filter: "ORDER_HAC_FINAL_NEG"
code: "RESPONSE"
status: "FAILED"
order: "true"
- subscription:
filter: "TS01"
code: "EVENT"
- subscription:
filter: "DS01"
code: "EVENT"

10.4 Transaction download
In order to download transactions, an EBICS user has to be assigned the rights of download user. Only 1
EBICS user can be assigned as download user per customer. All transactions for a given customer will be
downloaded via this user.
As from EBICS 3.0, the business transactions order types such as STA (representing an MT940) have been
replaced by Business Transaction Formats (BTF). For downloading transactions, the administrative order
type BTD (Business Transaction Download) is used. The official list of supported BTF's can be downloaded
from https://www.ebics.org/en/technical-information/ebics-specification. Next to this, banks can publish an
additional list of supported BTF and their mapping to business transaction order types. BTF can be
configured in Bank Connector in the ebics-btfmap file.
Based on the BTF properties of the transaction, messages are assigned a profile when entering Bank
Connector. This profile will be used for routing the message to the correct backend application in the correct
format. These profiles are configured in the ebics-route-config file.
Transactions can be downloaded at regular intervals via scheduled jobs in which you can define to which
BTF and customer the job applies. The scheduled jobs are configured in the ebics-scheduledjob file.

10.4.1 Defining a download user
A download user is set up in the ebics-users file.

EBICS connection – 247

Trax – Bank Connector user guide

sample ebics-users file
users:
- user:
id: "USDEQA01"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "true"
download: "true"
- user:
id: "USDEQA02"
customerid: "CUDEQA01"
description: "Demo test user"
signer: "true"
download: "false"

Only one EBICS user per customer can be assigned as download user.

10.4.2 Configuring EBICS incoming profiles
Bank Connector will assign a target profile to incoming EBICS transactions based on the properties of the
BTF. Via the target profile, Bank Connector will route the message to the correct backend application and in
the correct format.

10.4.2.1 Configuring EBICS routing criteria
The BTF properties are set up as routing criteria in the ebics-route-config file.
All routing criteria have to be assigned a routing sequence that will determine the order in which they will be
applied on an incoming message. When a matching entry is found, the corresponding target profile will be
assigned to the message.

EBICS connection – 248

Trax – Bank Connector user guide

sample ebics-route-config file
ebics:
- filtering:
routingsequence: "10"
targetprofile: "incomingprofile_STA"
ordertype: "BTD"
servicename: "EOP"
scope: "DE"
incomingmessagetype: "mt940"
- filtering:
routingsequence: "11"
targetprofile: "incomingprofile_C53_02"
ordertype: "BTD"
servicename: "EOP"
scope: "DE"
incomingmessagetype: "camt.053.001.*"
containerformat: "ZIP"
- filtering:
routingsequence:
targetprofile:
ordertype:
servicename:
scope:
incomingmessagetype:
containerformat:

Regex expressions can be used in the routing criteria.

Property

Description

Mandatory/
Optional

routingsequence

Sequence of the routing criteria.

M

targetprofile

Profile that will be assigned to the incoming message and will be
used to route message in TRAX. This targetprofile is required to
be set up in TRAX as well under incoming routing.

M

ordertype

BTF ordertype. BTD for download

O

servicename

Service name identifies the corresponding EBICS service of the
financial institution using existing globally defined service name
code list. [A-Z0-9] length=3

O

EBICS connection – 249

Trax – Bank Connector user guide

Property

Description

Mandatory/
Optional

serviceoption

Sub-variants of a service, dependent on scope. [A-Z0-9] length=3
to 10

O

scope

The scope parameter defines the set of rules according to which
a message file was created. [A-Z0-9] length=2 to 3

O

containerformat

It identifies how files that are transmitted. [A-Z0-9] length=3

O

incomingmessagetyp
e

It contains the technical designation of the incoming message
type. [a-z.0-9] length=1 to 10

M

10.4.2.2 Marking incoming messages as confidential
Based on the routing criteria, you can define if the message details of a message that matches the criteria
will be visible in the GUI or not. This is done by adding the property "confidential" to the routing criteria with
value "true". The default value is "false".

sample ebics-route-config file
ebics:
- filtering:
routingsequence: "10"
targetprofile: "incomingprofile_STA"
ordertype: "BTD"
servicename: "EOP"
scope: "DE"
incomingmessagetype: "mt940"
confidential: "true"

10.4.3 Configuring download jobs
Transactions can be downloaded at regular intervals via scheduled jobs in which you can define to which
BTF and customer the job applies. For each bank, it is possible to download transactions for multiple
customers. Also multiple BTF can be downloaded per job.
The scheduled jobs will be executed automatically at regular intervals when the EBICS channel is running.
Stopping the EBICS channel will also stop the scheduler. Scheduled jobs can be set to inactive temporarily so
that the scheduler will not execute them.

EBICS connection – 250

Trax – Bank Connector user guide

At each job execution, only new transactions that have not been downloaded yet, will be fetched. Fetching
again transactions that have been downloaded already, can be done by triggering the download job
manually.

10.4.3.1 BTF configuration
The BTF which are used in the download jobs have to be set up in the ebics-btmap file so that bank
Connector can generate a download request with the correct BTF properties.

sample ebics-btfmap file
ebics:
- btfmap:
code: "C53"
ordertype: "BTD"
servicename: "EOP"
msgname: "camt.053"
scope: "DE"
container: "ZIP"
- btfmap:
code: "STA"
ordertype: "BTD"
servicename: "EOP"
msgname: "mt940"
scope: "DE"
- btfmap:
code: "C54_03"
ordertype: "BTD"
servicename: "STM"
msgname: "camt.054.001.03"
scope: "DE"
container: "ZIP"
- btfmap:
code: "C54_08"
ordertype: "BTD"
servicename: "STM"
msgname: "camt.054.001.08"
scope: "DE"
container: "ZIP"

EBICS connection – 251

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

code

BTF code for outgoing /incoming profiles. Should be mapped with the
"btfmap" property in ebics-profile.yml (outgoing). It must be unique
and can be anything as its a string

M

ordertype

For transaction download, this value has to be BTD (Business
Transaction Download)

M

servicename

Service name identifies the corresponding EBICS service of the
financial institution using existing globally defined service name code
list. [A-Z0-9] length=3

M

scope

The scope parameter defines the set of rules according to which a
message file was created. [A-Z0-9] length=2 to 3

O

serviceoption

Sub-variants of a service, dependent on scope. [A-Z0-9] length=3 to 10

O

container

It identifies how files that are transmitted. [A-Z0-9] length=3. Possible
values are XML, SVC or ZIP.

O

msgname

It contains the technical designation of the message type. For
ISO20022 messages, it is possible to configure the full messagename
including variant and version, such as camt.053.001.03 or just the
message name such as camt.053. This allows to make a distinction
between different versions if variant and version are not part of the
BTF received from the bank e.g. a bank offering both camt.053.001.03
and camt.054.001.08 in parallel.

M

msgvariant

It contains the technical designation of the ISO20022 message
variant. [0-9] length=3

O

msgversion

It contains the technical designation of the ISO20022 message
version. [0-9] length=2

O

10.4.3.1.1 Splitting statement files
When downloading an MT940 or C53 statement file, this file usually contains multiple statements. The
statements can be processed and forwarded to the backend application separately.
In below example the MT940 file containing multiple statements separated by a hyphen, will be split in
separate messages. The delimiter (hyphen) will not be part of the split messages.

EBICS connection – 252

Trax – Bank Connector user guide

sample MT940 file containing multiple statements separated by hyphen
:20:STA-73-240726
:25:DE83111111110000000001
:28C:73
:60F:D240725EUR2472100377,73
:61:2407260726DR10008,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/4562/2009-09-08?21KREF+ABC/086?
31BE30001216371411?32DEF Electronics
:61:2407260726DR500000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/ABC-13679/2009-09-?2115?22KREF+ABC/
086?31BE30001216371411?32GHI Semiconductors
:61:2407260726DR1000000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/987-AC/2009-09-27?21KREF+ABC/086?
31BE30001216371411?32ABC Corporation
:20:STA-74-240729
:25:DE83111111110000000001
:28C:74
:60F:D240726EUR2485705006,03
:61:2407290729DR10008,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/4562/2009-09-08?21KREF+ABC/086?
31BE30001216371411?32DEF Electronics
:61:2407290729DR500000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/ABC-13679/2009-09-?2115?22KREF+ABC/
086?31BE30001216371411?32GHI Semiconductors
:61:2407290729DR1000000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/987-AC/2009-09-27?21KREF+ABC/086?
31BE30001216371411?32ABC Corporation
:61:2407290729DR10008,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/4562/2009-09-08?21KREF+ABC/086?
31BE30001216371411?32DEF Electronics
:61:2407290729DR500000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/ABC-13679/2009-09-?2115?22KREF+ABC/
086?31BE30001216371411?32GHI Semiconductors
:61:2407290729DR1000000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/987-AC/2009-09-27?21KREF+ABC/086?
31BE30001216371411?32ABC Corporation
:62F:D240729EUR2488725022,03
:20:STA-75-240730
:25:DE83111111110000000001
:28C:75
:60F:D240729EUR2488725022,03
:61:2407300730DR10008,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/4562/2009-09-08?21KREF+ABC/086?
31BE30001216371411?32DEF Electronics
:61:2407300730DR500000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/ABC-13679/2009-09-?2115?22KREF+ABC/
086?31BE30001216371411?32GHI Semiconductors
:61:2407300730DR1000000,00NTRFNONREF
:86:166?00SEPA-UEBERWEISUNG?10500000?20EREF+ABC/987-AC/2009-09-27?21KREF+ABC/086?
31BE30001216371411?32ABC Corporation
:62F:D240730EUR2490235030,03
EBICS connection – 253

Trax – Bank Connector user guide

The following properties need to be added to the btfmap

sample ebics-btfmap file
ebics:
- btfmap:
code: "STA"
ordertype: "BTD"
servicename: "EOP"
msgname: "mt940"
scope: "DE"
split: "true"
delimiter: "(\\r\\n\\-)"
keepdelimiter: "false"

Property

Description

Mandator
y/
Optional

split

Possible values are "true" or "false". The default value is "false".

O

delimiter

Delimiter for separating the statements. This is expressed as regex

O

keepdelimiter

Determines if the delimiter will be included in the split message.
Possible values are "true" or "false".

O

10.4.3.1.2 Unzipping statement files
Zipped statement files containing multiple statements can be unzipped by Bank Connector and the individual
statements processed and sent to the backend application separately. This can be done by adding the
property unzip to "true" in the btfmap. If set to "false", the statement file will remain zipped when forwarding
it to the backend application. By default, zipped statement files will be routed to the backend application.

EBICS connection – 254

Trax – Bank Connector user guide

sample ebics-btfmap file
ebics:
- btfmap:
code: "C53"
ordertype: "BTD"
servicename: "EOP"
msgname: "camt.053"
scope: "DE"
container: "ZIP"
unzip: "true"

10.4.3.2 Configuring the download jobs
The download jobs are set up in the ebics-scheduledjob file. When the scheduled job properties have been
updated, the EBICS channel has to be restarted for the changes to become active.

sample ebics-scheduledjob file
jobs:
- job:
name: "EBICS STA_CUDEQA01"
description: "Fetch the MT940 from a bank server"
customerprofiles: "CUDEQA01"
btfmaps: "STA"
active: "true"
cron: "0 0/2 * * * ?"
- job:
name: "EBICS C53_CUDEQA01_CUDEQA01"
description: "Fetch the camt.053 from a bank server"
customerprofiles: "CUDEQA01,CUDEQA02"
btfmaps: "C53"
active: "true"
cron: "0 0/2 * * * ?"

Property

Description

Mandator
y/
Optional

name

scheduled_job name. name must be unique.

M

EBICS connection – 255

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

description

scheduled_job description

O

customerprofiles

comma separated list of customer profile id associated with
scheduled_job.

M

For each customer; 1 download user has to be initialized
btfmaps

comma separated list of btf map codes. Based on the properties
defined in the ebics-btfmap file, Bank Connector will generate a
download request with the correct btf structure

M

active

If set to "false", the job will not be executed by the scheduler.

M

cron

Cron expression to determine the execution date/time interval

M

10.4.3.3 Fetching the Customer acknowledgement HAC
Responses on transaction uploads can be fetched immediately after the upload of the transaction by setting
the property fetchimmediatehac to "true" in the EBICS outgoing profile. It is also possible to download the
HAC at regular intervals using a scheduled job.
The following btfmap has to be added to the ebics-btfmap file. Servicename and msgname are of no
importance but values have to be added because of validation constraints.

HAC btfmap
ebics:
- btfmap:
code: "HAC"
ordertype: "HAC"
servicename: "SCT"
msgname: "pain.001"

The following scheduled job referencing the HAC btfmap has to be added to the ebics-scheduledjob file

EBICS connection – 256

Trax – Bank Connector user guide

sample ebics scheduled job for HAC
jobs:
- job:
name: "EBICS HAC_CUDEQA01"
description: "Fetch the HAC customer protocol from a bank server"
customerprofiles: "CUDEQA01"
btfmaps: "HAC"
active: "true"
cron: "0 0/2 * * * ?"

10.4.3.4 Triggering a download job manually
From the bank Connector GUI, navigate to EBICS - scheduled jobs and select the job you want to run
manually. By default, the job will be executed using as date range the current day. Jobs can only be triggered
manually if the EBICS channel is running.

10.4.3.5 Monitoring the scheduled job execution
Unsuccessful executions of jobs are visible in the log screen with a description of the error reason

EBICS connection – 257

Trax – Bank Connector user guide

Job executions are also logged in the bankconnector-ebics.log file which can be downloaded from the GUI
via the Logs screen.

EBICS connection – 258

Trax – Bank Connector user guide

11 Bank APIs
•
•
•
•
•
•

Bank of America (see page 259)
Citibank (see page 272)
JPMorgan Chase (see page 287)
Necto (see page 290)
US Bank (see page 293)
Routing API response messages to the backend application (see page 298)

11.1 Bank of America
The following API's are currently supported by Bank Connector
• Account information - Current day and Previous day balance inquiry API
Returns CashPro Information Reporting account balance data for a single date in time or for the prior
business day back to the full two year client retention.
• Account information - Current day and Previous day transaction inquiry API
Returns current or previous day CashPro Information Reporting account transaction details for a date
range.
• Payments - Payments V2 initiation - ISO XML
Initiates one or more payment transactions using ISO XML.
• Payments - Payments V2 status - ISO XML
Returns the status of the ISO XML payment request.
Reach out to your bank's Relationship Manager to initiate the API onboarding process.

11.1.1 Bank of America - Authentication
11.1.1.1 Authentication method
To securely access the bank of America CashPro API gateway, the Oauth 2.0 client credentials grant type is
used. Client authentication is done based on the client id, client secret and application id which are provided
by the bank.

11.1.1.1.1 Configuration
Before you start, make sure to have the following information at hand:
• client id, client secret and application id
Step 1 - Create an API-Bofa folder

Bank APIs – 259

Trax – Bank Connector user guide

Step 2 - Open a text editor such as notepad++ and create a yml new file "api-config"
Step 3 - Copy/paste below extract into the file and edit the data as indicated to set up the authentication flow

api:
name: "Bank Of America"
proxyhost:
proxyport:
oauth:
uri: "https://api-sb.bofa.com/authn/v1/client-authentication"
form:
- param:
key: "grant_type"
value: "client_credentials"
- param:
key: applicationID
value:
header:
- param:
key: "Content-Type"
value: "application/x-www-form-urlencoded"
headerhandler: "{bean:AuthorizationHandler}"
map:
- param:
key: "Authorization"
value:

Property

Description

Mandatory / Optional

api name

name of the api

Mandatory

proxyhost

proxy server ip address

Optional

proxyport

proxy server port number

Optional

uri

authentication api to retrieve an access token

Mandatory

Production: https://api.bofa.com/authn/v1/client-authentication
Sandbox: https://apis-sb.bofa.com/authn/v1/clientauthentication
form

set of configurable parameters defined as key/value pairs that
will be added as parameters to the body of the api request

grant-type

client-credentials

Mandatory

Bank APIs – 260

Trax – Bank Connector user guide

Property

Description

Mandatory / Optional

applicationI
D

application id received from the bank during the api onboarding
process

Mandatory

header

set of configurable parameters defined as key/value pairs that
will be added as header parameters to the api request

ContentType

application/x-www-form-urlencoded

Mandatory

headerhandl
er

{bean:AuthorizationHandler?prefix=Basic }

Mandatory

map

list of parameters defined as key/value pairs that will be used by
the headerhandler to compute and set header parameters

Authorizatio
n

combination of client id and client secret separated by a colon.
The headerhandler will generate a base64 encoded string from
this information and add this as value to the authorization
header parameter prefixed with Basic.

The authorization handler is responsible for generating a base64
encoded string from the client id and client secret specified in
the header param with key "Authorization"

11.1.2 Bank of America - Current and previous day balance inquiry
The current and previous day balance inquiry API will return CashPro Information Reporting account balance
data for a single date in time or for the prior business day back to the full two year client retention.

11.1.2.1 Configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the transaction inquiry flow

targetconnection:
- outgoing:
profile: ""
uri: https://api-sb.bofa.com/cashpro/reporting/v1/transaction-inquiries/
previous-day
actor: HttpProducerActor
header:
- param:

Bank APIs – 261

Trax – Bank Connector user guide

key: Content-Type
value: application/json

Property

Description

Mandatory / Optional

profile

In order to route the outgoing message to the correct bank, the
property "profile" has to be added to the targetconnection outgoing section. This profile has to correspond to the profile
that was assigned to the message when entering Bank
Connector from the backend application or the profile that was
assigned to the message in Trax.

Mandatory

uri

Current day

Mandatory

Production: https://api.bofa.com/cashpro/reporting/v1/
balance-inquiries/current-day
Sandbox: https://api-sb.bofa.com/cashpro/reporting/v1/
balance-inquiries/current-day12
Previous day
Production: https://api.bofa.com/cashpro/reporting/v1/
balance-inquiries/previous-day13
Sandbox: https://api-sb.bofa.com/cashpro/reporting/v1/
balance-inquiries/previous-day14
actor

HttpProducerActor

header

set of configurable parameters defined as key/value pairs that
will be added as header parameters to the api request

ContentType

application/json

Mandatory

Mandatory

The request and response message are json messages

11.1.2.2 Request message
bank Connector expects to receive a correctly formatted json message with the following structure from the
backend application

"accounts":
# List of accounts

12 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
13 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
14 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day

Bank APIs – 262

Trax – Bank Connector user guide

[
{
# Account Number
# Length: 1-35
# Mandatory
"accountNumber": "601022222222",
# BIC or routing number of the account
# Length: 1-12
# Optional
"bankId": "BOFAFRPP"
}
],
# Date of requested balances
# Format : YYYY-MM-DD
"balanceAsOfDate": "2017-07-04"
}

11.1.2.3 Response message
Bank Connector will forward the json response message from the bank to the backend application with the
following structure:

# List of accounts returned with balance details
{
"accountBalances": {
# Account Number
# Length of the field : 1-35
# Mandatory
"accountNumber": "600811111111",
# List of balances
"balances": [
{
# Balance amount
# Format: 999999999999999999.99
# Length: 1-21
"amount": "983.97",
# Balance date
# Format: YYYY-MM-DD
"lastUpdatedDate": "2017-07-04",
# BAI code of the balance amount
"transactionCode": "010",
# Description of the BAI balance code
"transactionDescription": "Opening Ledger Balance"
}
],
# BIC or routing number of the account
# Length: 1-12
"bankId": "BOFAGB22",
# Currency code of the account

Bank APIs – 263

Trax – Bank Connector user guide

"currency": "EUR"
}
}

11.1.3 Bank of America - Current and previous day transaction inquiry
The current day and previous day transaction inquiry api will return current or previous day CashPro
Information Reporting account transaction details for a date range.

11.1.3.1 Configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the transaction inquiry flow

targetconnection:
- outgoing:
profile: ""
uri: https://api-sb.bofa.com/cashpro/reporting/v1/transaction-inquiries/
previous-day
actor: HttpProducerActor
header:
- param:
key: Content-Type
value: application/json

Property

Description

Mandatory / Optional

profile

In order to route the outgoing message to the correct bank, the
property "profile" has to be added to the targetconnection outgoing section. This profile has to correspond to the profile
that was assigned to the message when entering Bank
Connector from the backend application or the profile that was
assigned to the message in Trax.

Mandatory

Bank APIs – 264

Trax – Bank Connector user guide

Property

Description

Mandatory / Optional

uri

Current day

Mandatory

Production: https://api.bofa.com/cashpro/reporting/v1/
transaction-inquiries/current-day15
Sandbox: https://api-sb.bofa.com/cashpro/reporting/v1/
16
transaction-inquiries17/current-day18
Previous day
Production: https://api.bofa.com/cashpro/reporting/v1/
19
transaction-inquiries20/previous-day21
Sandbox: https://api-sb.bofa.com/cashpro/reporting/v1/
22
transaction-inquiries23/previous-day24
actor

HttpProducerActor

header

set of configurable parameters defined as key/value pairs that
will be added as header parameters to the api request

ContentType

application/json

Mandatory

Mandatory

The request and response message are json messages

11.1.3.2 Request message
bank Connector expects to receive a correctly formatted json message with the following structure from the
backend application

"accounts":
# List of accounts
[
{
# Account Number
# Length: 1-35
# Mandatory
"accountNumber": "601022222222",

15 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
16 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
17 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
18 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
19 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
20 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
21 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
22 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
23 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
24 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day

Bank APIs – 265

Trax – Bank Connector user guide

# BIC or routing number of the account
# Length: 1-12
# Optional
"bankId": "BOFAFRPP"
}
],
# First Date of requested transactions
# Format : YYYY-MM-DD
# Mandatory
"fromDate": "2025-01-04",
"toDate": "2025-01-10",
}

11.1.3.3 Response message
Bank Connector will forward the json response message from the bank to the backend application with the
following structure:

# List of accounts returned with transaction details
{
"accountTransactions": {
# Account Number
# Length: 1-35
"accountNumber": "601022222222",
# BIC or routing number of the account
# Length: 1-12
"bankId": "BOFAFRPP",
# Currency code of the account
"currency": "EUR",
# List of transactions
"transactions": [
{
# Balance amount
# Format: 999999999999999999.99
# Length: 1-21
"amount": "1.00",
# Reported data of transaction
# Format : YYYY-MM-DD
"asOfDate": "2017-11-21",
# One day available amount
# Format: 999999999999999999.99
# Length: 1-21
"availability1DayAmount": "string",
# Two plus day available amount
# Format: 999999999999999999.99
# Length: 1-21
"availability2PlusDayAmount": "string",
# Immediate available amount

Bank APIs – 266

Trax – Bank Connector user guide

# Format: 999999999999999999.99
# Length: 1-21
"availabilityImmediateAmount": "string",
# Bank reference number associated with the transaction
# Length: 1-30
"bankReference": "555555555555",
# Credit or Debit
"creditDebitIndicator": "Debit",
# Customer reference number associated with the transaction
# Length: 1-50
"customerReference": "CUSTREF123",
# Additional details associated with the transaction
# Length: 1-3600
"detailText": "BENEFICIARY UNSTRUCTURED DETAIL TEXT",
# Count of items contained within the transaction
# Length: 1-12
"itemCount": "1",
# BAI code of the transaction amount
"transactionCode": "400",
# Description of the BAI code
# Length: 1-35
"transactionDescription": "Total Debits",
# Summary or details
"transactionType": "Summary",
# Value date of the transacton
# Format : YYYY-MM-DD
"valueDate": "2017-11-21"
}
]
}
}

11.1.4 Bank of America - Payments V2 initiation ISO XML
The Payments V2 initiation - ISO XML api will initiate one or more payments using ISO XML.

11.1.4.1 Configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the transaction inquiry flow

targetconnection:
- outgoing:
profile: ""
uri: https://api-sb.bofa.com/cashpro/payments/v2/isoxml-transfers
actor: HttpProducerActor
header:
- param:

Bank APIs – 267

Trax – Bank Connector user guide

key: Content-Type
value: "Multipart/form-data"
- param:
key: X-Idempotency-Key
value: "{uuid}"
- param:
key: isPayrollFile
value: "false"

Property

Description

Mandatory /
Optional

profile

In order to route the outgoing message to the correct bank,
the property "profile" has to be added to the targetconnection
- outgoing section. This profile has to correspond to the
profile that was assigned to the message when entering Bank
Connector from the backend application or the profile that
was assigned to the message in Trax.

Mandatory

uri

Production: https://api.bofa.com/25/cashpro/payments/v2/
isoxml-transfers26

Mandatory

Sandbox: https://api-sb.bofa.com/cashpro/payments/v2/
isoxml-transfers
actor

HttpProducerActor

header

set of configurable parameters defined as key/value pairs
that will be added as header parameters to the api request

Content-Type

Multipart/form-data

Mandatory

Mandatory

The ISO XML payment will be added as an attachment to the
API request.

X-IdempotencyKey

Unique reference to identify the request

Mandatory

Length: 1 - 256
This value can be autogenerated by Bank Connector by using
the variable {uuid}

isPayrollFile

If marked as true, the payment will be considered a payroll file

Mandatory

Possible values are "True" or "False"

25 https://api.bofa.com/cashpro/reporting/v1/balance-inquiries/current-day
26 https://api-sb.bofa.com/cashpro/payments/v2/isoxml-transfers

Bank APIs – 268

Trax – Bank Connector user guide

11.1.4.2 Request message
bank Connector expects to receive a correctly formatted ISO XML pain.001.001.03 file. The file has to
contain the namespace xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.03".

11.1.4.3 Response message
Bank Connector will forward the json response message from the bank to the backend application with the
following structure:

{
# File Identifier for the file sent in the request. This fileId can be used to
retrieve status of payment.
"fileId": "FABC123HKHTY654",
# list of failure reasons
"reason": [
{
# Reason code for the failure
"reason code":
# Reason description for the failure
"reason description":
}
],
# "SUCCESS" or "FAILED"
"status": "SUCCESS"
}

11.1.5 Bank of America - Payments V2 status ISO XML
The Payments V2 status - ISO XML api will return the status of the ISO XML payment request.

11.1.5.1 Configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the transaction inquiry flow

targetconnection:
- outgoing:
profile: ""
uri: "https://api-sb.bofa.com/cashpro/payments/v2/isoxml-transfers/status"
actor: "HttpProducerActor"
header:
- param:
key: "X-Idempotency-Key"
value: "{uuid}"

Bank APIs – 269

Trax – Bank Connector user guide

- param:
key: fileId
value: {fileId}

Property

Description

Mandatory /
Optional

profile

In order to route the outgoing message to the correct bank,
the property "profile" has to be added to the targetconnection
- outgoing section. This profile has to correspond to the
profile that was assigned to the message when entering Bank
Connector from the backend application or the profile that
was assigned to the message in Trax.

Mandatory

uri

Production: https://api.bofa.com//cashpro/payments/v2/
isoxml-transfers/status

Mandatory

Sandbox: https://api-sb.bofa.com/cashpro/payments/v2/
isoxml-transfers/status
actor

HttpProducerActor

header

set of configurable parameters defined as key/value pairs
that will be added as header parameters to the api request

X-IdempotencyKey

Unique reference to identify the request

Mandatory

Mandatory

Length: 1 - 256
This value can be autogenerated by Bank Connector by using
the variable {uuid}

fileId

File Identifier for the file received in the response when calling
the Payments V2 initiation API. The value will be passed on
from the back end application via the variable fileId.

Mandatory

11.1.5.2 Request message
bank Connector expects to receive a json message with the following structure containing the File identifier.

{
# File Identifier
"fileId": "FABC123HKHTY700",

Bank APIs – 270

Trax – Bank Connector user guide

}

11.1.5.3 Response message
Bank Connector will forward the json response message from the bank to the backend application with the
following structure:

"statusResponse": [
{
# List of reason codes with description
"reason": [
{
# Reason code for the failure
"reasonCode": "CPS-ENT-001",
# Description of the reason code
"reasonDescription": "Entitlement SenderID Failed"
}
],
# Status of the payment file
"status": "Unsuccessful",
# List of tranaction details
"transaction": [
{
# End to end Identification of the transaction
"endToEndIdentification": "2L2TLL1J42JK",
# List of reason code with description
"reason": [
{
# Reason code for the failure
"reasonCode": "VDT-VAL-007",
# Description of the reason code
"reasonDescription": "Value Date cannot be older than 30 days."
}
],
# Status of the transaction (Rejected, Pending Approval, Unsuccessful, Accepted By
Bank, Rejected by Bank, Settlement Complete)
"status": "Rejected",
# Transaction Id
"tranId": "T0MAPD66OJNMDGDC"
}
],
# Unique identifier
"transactionIdentification": "FS1APD54L2RZ0MCL"
}
]

Bank APIs – 271

Trax – Bank Connector user guide

11.2 Citibank
11.2.1 Which APIs are currently supported by Bank Connector
The following API's are currently supported by Bank Connector
• Account Information - Balance Inquiry API
Returns current and historical (up to last 180 days) account balance information.
• Account Information - Account Statement API
Returns account statements in a range of globally supported file formats such as Swift MT940 or ISO
camt.053.001.02

11.2.2 Citi onboarding procedure
The onboarding procedure consists of the following steps:
• Register on the Citi Institutional Clients developer portal on https://sandbox.developer.icg.citi.com/
apis/signup
• Retrieve your client ID and Client Secret from the Dashboard
• Upload your SSL certificates via the Dashboard
• Follow instruction on Add a TLS/SSL certificate (see page 354) for use in Bank Connector and
upload to the developer portal.
• Upload the Encryption and Signing certificates via the Dashboard
• You can provide your own Encryption and Signing certificate or request them via the Citi/
DigiCert procedure;
• If you have your own encryption and signing certificate, you can simply upload them
via the Dashboard.
• If you use the Citi/DigiCert procedure
• Download the private key from the Dashboard and import the private key into a
java keystore
• Once you have received the public certificates from DigiCert, follow the
instructions on Add a public certificate (see page 351) to add the certificate to a
keystore
• Go to "Developer Tools - Download Citi Certificates" and select "Download All". Unzip the downloaded
Citi-certificates.zip archive.
• In the folder, you will find the UAT encryption, signing and TLS/SSL public certificate. Follow
the instructions on Add a public certificate (see page 351). It is best practice the store the TLS/
SSL certificate in a separate truststore. The encryption and signing certificate can be stored
together in one truststore.

Bank APIs – 272

Trax – Bank Connector user guide

11.2.3 Citibank - Authentication
11.2.3.1 Authentication method
To securely access the bank of America CashPro API gateway, the Oauth 2.0 client credentials grant type is
used. Client authentication is done based on the client id, client secret which are provided by the bank.
When calling the Authentication endpoint, an access token will be returned that will then be used in
subsequent API calls.
mTLS 1.2 encryption is used for secure communications between Bank Connector and the Citi API gateway.
In addition, API payloads are encrypted, and digital signatures verified using AES-256-GCM encryption and
2048-bit RSA keys.

11.2.3.1.1 Certificates
The following certificates and jks keystores are required
mTLS
• jks keystore containing your TLS private/public key pair and certificate chain
• jks truststore containing the Citi TLS certificate
Encryption
• jks keystore containing your encryption private/public key pair and certificate chain
• jks truststore containing the Citi encryption certificate
Signing
• jks keystore containing your signing private/public key pair and certificate chain
• jks truststore containing the Citi signing certificate

Follow the next steps for onboarding and managing the certificates
• Register on the Citi Institutional Clients developer portal on https://sandbox.developer.icg.citi.com/
apis/signup
• Retrieve your client ID and Client Secret from the Dashboard
• Upload the following certificates certificates via the Dashboard
• your mTLS certificate
• your Encryption and Signing certificate
You can find the certificate requirements in the "Authentication Guide" accessible via the Dashboard
You can use the same certificate for encryption and signing.
• Go to "Developer Tools - Download Citi Certificates" and select "Download All". Unzip the downloaded
Citi-certificates.zip archive.
• In the folder, you will find the UAT encryption, signing and TLS/SSL public certificate. It is best
practice the store the TLS/SSL certificate in a separate truststore. The encryption and signing
certificate can be stored together in one truststore.

Bank APIs – 273

Trax – Bank Connector user guide

11.2.3.1.2 Configuration
Step 1 - Create an API-Citi folder
Step 2 - Open a text editor such as notepad++ and create a yml new file "api-config"
Step 3 - Copy/paste below extract into the file and edit the data as indicated to set up the authentication flow

api:
name: Citi API
proxyhost:
proxyport:
oauth:
uri: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/authenticationservices/
v3/oauth/token
formpayload: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<oAuthToken xmlns=\"http://com.citi.citiconnect/services/types/
oauthtoken/v2\">
<grantType>client_credentials</grantType>
<scope>/authenticationservices/v1</scope>
<sourceApplication>CCF</sourceApplication>
</oAuthToken>"
header:
- param:
key: Content-Type
value: application/xml
headerhandler: "{bean:AuthorizationHandler?prefix=Basic }"
responseprocessor: XmlResponseProcessor
map:
- param:
key: Authorization
value: d6f42eaf-5ca9-41cc-9077ac216e1ac3c2:R8xO3kF4kE8uS8tJ5yX4gU5aO2qM2eF4rS4eC0mF5uA0tL5cK3

Property

Description

Mandatory /
Optional

api name

name of the api

Mandatory

proxyhost

proxy server ip address

Optional

proxyport

proxy server port number

Optional

Bank APIs – 274

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

uri

authentication api to retrieve an access token

Mandatory

Citi currently supports three versions of the authentication endpoint:
v1, v2 and v3
When calling the Balances API, v3 has to be used
Production: https://tts.apib2b.citi.com/citiconnect/prod/
authenticationservices/v3/oauth/token
Sandbox: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
authenticationservices/v3/oauth/token
When calling the Statement initiation and retrieval API, v2 has to be
used
Production: https://tts.apib2b.citi.com/citiconnect/prod/
authenticationservices/v2/oauth/token27
Sandbox: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
authenticationservices/v2/oauth/token28

formpayloa
d

payload that will be added to the authentication API call

Mandatory

When calling the Balances API, the structure will be
"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <oAuthToken
xmlns=\"http://com.citi.citiconnect/services/types/oauthtoken/
v2\"> <grantType>client_credentials</grantType> <scope>/
authenticationservices/v1</scope> <sourceApplication>CCF</
sourceApplication> </oAuthToken>"
When calling the Statement initiation and retrieval API, the tsructure
will be
"<?xml version=\"1.0\" encoding=\"UTF-8\"?> <oAuthToken
xmlns=\"http://com.citi.citiconnect/services/types/oauthtoken/
v1\"> <grantType>client_credentials</grantType> <scope>/
authenticationservices/v1</scope> <sourceApplication>CCF</
sourceApplication> </oAuthToken>"
Bank Connector currently only supports the xml structured payload
and not the json variant.

header

set of configurable parameters defined as key/value pairs that will
be added as header parameters to the api request

ContentType

application/xml

Mandatory

27 https://tts.apib2b.citi.com/citiconnect/prod/authenticationservices/v3/oauth/token
28 https://tts.sandbox.apib2b.citi.com/citiconnect/sb/authenticationservices/v3/oauth/token

Bank APIs – 275

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

headerhan
dler

{bean:AuthorizationHandler?prefix=Basic }

Mandatory

responsepr
ocessor

XmlResponseProcessor

map

list of parameters defined as key/value pairs that will be used by the
headerhandler to compute and set header parameters

Mandatory

Authorizati
on

combination of client id and client secret separated by a colon. The
headerhandler will generate a base64 encoded string from this
information and add this as value to the authorization header
parameter prefixed with Basic.

Mandatory

The authorization handler is responsible for generating a base64
encoded string from the client id and client secret specified in the
header param with key "Authorization"
Mandatory

will extract the access token from the xml formatted response.

The mTLS, encryption and signing keystores and truststores have to be set up in the Balances or Statement
initiation and retrieval API.

11.2.4 Citibank - Balance Inquiry
The Account Information - Balance Inquiry API returns current and historical (up to last 180 days) account
balance information.

11.2.4.1 Bank Connector configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the balance inquiry flow

targetconnection:
- outgoing:
profile: "Citi_balance_inquiry"
uri: "https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/balance/inquiry?
client_id=82884eb7-9a6d-4cb3-815d-36740e6ed6de"
actor: "HttpProducerActor"
keystore: bctesttraxfisglobalcom.jks
keystorepassword: scqS2K7uTk5t
truststore: cititls.jks
truststorepassword: traxtrax
signkeyfile: bctestenctraxfisglobalcom.jks

Bank APIs – 276

Trax – Bank Connector user guide

signkeyalias: bctestenctraxfisglobalcom
signkeypassword: aztKKJDtipwP
signprivatekeypassword: aztKKJDtipwP
encryptkeyfile: citi.jks
encryptkeypassword: citiciti
encryptkeyalias: citienc
decryptkeyfile: bctestenctraxfisglobalcom.jks
decryptkeyalias: bctestenctraxfisglobalcom
decryptkeypassword: aztKKJDtipwP
decryptprivatekeypassword: aztKKJDtipwP
verifykeyfile: citi.jks
verifykeypassword: citiciti
verifykeyalias: citisig
preprocessor: "decrypt_verify_XML,remove_XML_signature"
postprocessor: "sign_encrypt_XML"
header:
- param:
key: "Content-Type"
value: "application/xml"

Propert
y

Description

Mandatory /
Optional

profile

In order to route the outgoing message to the correct bank, the property
"profile" has to be added to the targetconnection - outgoing section. This
profile has to correspond to the profile that was assigned to the message
when entering Bank Connector from the backend application or the profile
that was assigned to the message in Trax.

Mandatory

uri

Production: "https://tts.apib2b.citi.com/citiconnect/prod/
accountstatementservices/v3/balance/inquiry?client_id=<Client ID>"

Mandatory

Sandbox: "https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v3/balance/inquiry?client_id=<Client ID>"
actor

HttpProducerActor

Mandatory

keystor
e

keystore containing your mTLS private/public key pair and certificate chain

Mandatory

keystor
epassw
ord

keystore password

Mandatory

truststo
re

truststore containing the Citi TLS/SSL certificate

Mandatory

Bank APIs – 277

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

truststo
repass
word

truststore password

Mandatory

signkey
file

keystore containing the signing/encryption private/public key pair and
certificate chain

Mandatory

signkey
alias

alias of the signing private key

Mandatory

signkey
passwo
rd

password of the keystore

Mandatory

signpriv
atekeyp
asswor
d

password of the signing private key

Mandatory

encrypt
keyfile

truststore containing the Citi encryption certificate

Mandatory

encrypt
keypass
word

password of the truststore

Mandatory

encrypt
keyalias

alias of the signing certificate

Mandatory

decrypt
keyfile

keystore containing the encryption private/public key pair and certificate
chain

Mandatory

decrypt
keyalias

alias of the encryption private key

Mandatory

decrypt
keypass
word

password of the keystore

Mandatory

Bank APIs – 278

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

decrypt
privatek
eypass
word

password of the encryption private key

Mandatory

verifyke
yfile

truststore containing the Citi signing/encryption certificate

Mandatory

verifyke
ypassw
ord

password of the truststore

Mandatory

verifyke
yalias

alias of the encryption certificate

Mandatory

preproc
essor

decrypt_verify_XML,remove_XML_signature

Mandatory

postpro
cessor

sign_encrypt_XML

header

set of configurable parameters defined as key/value pairs that will be added
as header parameters to the api request

Mandatory

Content
-Type

application/xml

Mandatory

will decrypt and remove the signature from the response payload
Mandatory

will sign and encrypt the request payload

The request and response message are xml messages

11.2.4.2 Request message
Bank Connector expects to receive a XML request message with the following structure

<?xml version="1.0" encoding="UTF-8"?>
<balanceInquiryRequest xmlns="http://com.citi.citiconnect/services/types/inquiries/
balance/v1">
<accountNumber>12345678</accountNumber>
<branchNumber>600</branchNumber>
<baseCurrency>USD</baseCurrency>
<fromDate>2020-08-30</fromDate>

Bank APIs – 279

Trax – Bank Connector user guide

<toDate>2020-10-25</toDate>
</balanceInquiryRequest>

Property

Description

Mandatory / Optional

AccountNumber

String

Mandatory

Identifier of the account as defined by the account
service provider. You must include at least 1 account
and can specify up to 50 accounts in the
accountNumber field by comma-seperated values.
You must specify either accountNumber or
branchNumber in order to receive a successful
response. If none of these fields are provided, then the
API will return a reject response along with an error
message.
brancNumber

String

Mandatory

Branch Number as defined by the account service
provider. You can send only one Branch Number in the
request. If you send a branchNumber without an
accountNumber, the API returns balances for all
accounts belonging to the branch specified in the
request. You must specify either accountNumber or
branchNumber in order to receive a successful
response. If none of these fields are provided, then the
API will return a reject response along with an error
message.
baseCurrency

String

Optional

^[A-Z]{3,3}$
3-digit currency code for the currency in which the
balance needs to be retrieved. You may only one value
in this field. If baseCurrency is provided in the request,
the API will return balances in the requested currency
after applying any applicable FX currency
conversations. If baseCurrency is not provided in the
request, then the response will return balances in the
account's currency.
fromDate

YYYY-MM-DD

Mandatory

Date from which balances should be retrieved .
Cannot be more than 180 days from the current date.

Bank APIs – 280

Trax – Bank Connector user guide

Property

Description

Mandatory / Optional

toDate

YYYY-MM-DD

Mandatory

Date up to which balances should be retrieved. Cannot
be more than 180 days from the current date.

11.2.4.3 Response message
Bank Connector receives and forwards to the backend application a response message which follows
ISO20022 v2 (camt.052.001.02) standards.

11.2.5 Citibank - Statement Initiation - Retrieval
The Account Statement API consists of two consecutive API calls:
• Account Statement Initiation: The statement initiation will return a statement ID as response. This
statement ID will be used in the next call to retrieve the account statement.
• Account Statement retrieval: Based on the statement ID, the account statement retrieval will return
the account statement in the requested FIN or ISO20022 format.

11.2.5.1 Bank Connector configuration
Copy/paste below extract into the api-config file that was created when setting up the authentication flow
and edit the data as indicated to set up the Account statement flow

targetconnection:
- outgoing:
profile: Citi_statement_initiation
uri: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/statement/initiation?client_id=d6f42eaf-5ca9-41cc-9077ac216e1ac3c2
actor: "HttpProducerActor"
keystore: bctesttraxfisglobalcom.jks
keystorepassword: scqS2K7uTk5t
truststore: cititls.jks
truststorepassword: traxtrax
signkeyfile: bctestenctraxfisglobalcom.jks
signkeyalias: bctestenctraxfisglobalcom
signkeypassword: aztKKJDtipwP
signprivatekeypassword: aztKKJDtipwP
encryptkeyfile: citi.jks
encryptkeypassword: citiciti
encryptkeyalias: citienc
decryptkeyfile: bctestenctraxfisglobalcom.jks
decryptkeyalias: bctestenctraxfisglobalcom

Bank APIs – 281

Trax – Bank Connector user guide

decryptkeypassword: aztKKJDtipwP
decryptprivatekeypassword: aztKKJDtipwP
verifykeyfile: citi.jks
verifykeypassword: citiciti
verifykeyalias: citisig
preprocessor: "decrypt_verify_XML,remove_XML_signature"
postprocessor: "sign_encrypt_XML"
header:
- param:
key: "Content-Type"
value: "application/xml"
- outgoing:
profile: Citi_statement_retrieval
uri: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/mock/statement/retrieval?
client_id=d6f42eaf-5ca9-41cc-9077-ac216e1ac3c2
actor: HttpProducerActor
binary: true
keystore: bctesttraxfisglobalcom.jks
keystorepassword: scqS2K7uTk5t
truststore: cititls.jks
truststorepassword: traxtrax
signkeyfile: bc-test-sigtraxfisglobalcom_CPrGE6Zc8VR2.jks
signkeyalias: bc-test-sigtraxfisglobalcom
signkeypassword: CPrGE6Zc8VR2
signprivatekeypassword: CPrGE6Zc8VR2
encryptkeyfile: citi.jks
encryptkeypassword: citiciti
encryptkeyalias: citienc
decryptkeyfile: bc-test-enctraxfisglobalcom_aztKKJDtipwP.jks
decryptkeyalias: bc-test-enctraxfisglobalcom
decryptkeypassword: aztKKJDtipwP
decryptprivatekeypassword: aztKKJDtipwP
verifykeyfile: citi.jks
verifykeypassword: citiciti
verifykeyalias: citisig
preprocessor: XML_attachment_decryption_key_decode_base64
postprocessor: sign_encrypt_XML
header:
- param:
key: Content-Type
value: application/xml

Bank APIs – 282

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

profile

In order to route the outgoing message to the correct bank, the property
"profile" has to be added to the targetconnection - outgoing section. This
profile has to correspond to the profile that was assigned to the message
when entering Bank Connector from the backend application or the profile
that was assigned to the message in Trax.

Mandatory

uri

Account statement initiation

Mandatory

Production: "https://tts.apib2b.citi.com/citiconnect/prod/
accountstatementservices/v1/statement/initiation?client_id=<Client ID>"
Sandbox: "https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/statement/initiation?client_id=<Client ID>"
Account statement retrieval
Production: "https://tts.apib2b.citi.com/citiconnect/prod/
accountstatementservices/v1/statement/retrieval?client_id=<Client ID>"
Sandbox: "https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/statement/retrieval?client_id=<Client ID>"
actor

HttpProducerActor

Mandatory

binary

true

Mandatory

This property has to be added in Account Statement retrieval API definition
keystor
e

keystore containing your mTLS private/public key pair and certificate chain

Mandatory

keystor
epassw
ord

keystore password

Mandatory

truststo
re

truststore containing the Citi TLS/SSL certificate

Mandatory

truststo
repass
word

truststore password

Mandatory

signkey
file

keystore containing the signing/encryption private/public key pair and
certificate chain

Mandatory

Bank APIs – 283

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

signkey
alias

alias of the signing private key

Mandatory

signkey
passwo
rd

password of the keystore

Mandatory

signpriv
atekeyp
asswor
d

password of the signing private key

Mandatory

encrypt
keyfile

truststore containing the Citi encryption certificate

Mandatory

encrypt
keypass
word

password of the truststore

Mandatory

encrypt
keyalias

alias of the signing certificate

Mandatory

decrypt
keyfile

keystore containing the encryption private/public key pair and certificate
chain

Mandatory

decrypt
keyalias

alias of the encryption private key

Mandatory

decrypt
keypass
word

password of the keystore

Mandatory

decrypt
privatek
eypass
word

password of the encryption private key

Mandatory

verifyke
yfile

truststore containing the Citi signing/encryption certificate

Mandatory

Bank APIs – 284

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

verifyke
ypassw
ord

password of the truststore

Mandatory

verifyke
yalias

alias of the encryption certificate

Mandatory

preproc
essor

decrypt_verify_XML,remove_XML_signature

Mandatory

postpro
cessor

sign_encrypt_XML

header

set of configurable parameters defined as key/value pairs that will be added
as header parameters to the api request

Mandatory

Content
-Type

application/xml

Mandatory

will decrypt and remove the signature from the response payload
Mandatory

will sign and encrypt the request payload

The request and response message are xml messages

11.2.5.2 Statement initiation
11.2.5.2.1 Request message
Bank Connector expects to receive a xml-formatted request message with the following structure:

<?xml version="1.0" encoding="UTF-8"?>
<statementInitiationRequest xmlns="http://com.citi.citiconnect/services/types/
inquiries/statement/v1">
<accountNumber>12345678</accountNumber>
<formatName>SWIFT_MT940</formatName>
<fromDate>2018-05-01</fromDate>
<toDate>2018-05-28</toDate>
</statementInitiationRequest>

Bank APIs – 285

Trax – Bank Connector user guide

Propert
y

Description

Mandatory /
Optional

Accoun
tNumbe
r

The account number for which statement is initiated. One
or multiple accounts can be sent in the request.

Mandatory

format
Name

The format type for statements to be retrieved:

Mandatory

- SWIFT MT940
- SWIFT MT942
- CAMT_053_001_02
- CAMT_052_001_02

fromDat
e

YYYY-MM-DD

toDate

YYYY-MM-DD

Mandatory

Specifies the begin date for the statement request.
Mandatory

Specifies the end date for the statement request.

11.2.5.2.2 Response message
Bank Connector receives and forwards a response message to the backend application. The response
message contains the StatementId that will be used in the statement retrieval call.

<?xml version="1.0" encoding="UTF-8"?>
<statementInitiationResponse xmlns="http://com.citi.citiconnect/services/types/
inquiries/statement/v1" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
<statementId>21854898</statementId>
</statementInitiationResponse>

11.2.5.3 Statement Retrieval
11.2.5.3.1 Request message
Bank Connector expects to receive a xml-formatted request message with the following structure:

<?xml version="1.0" encoding="utf-8"?>

Bank APIs – 286

Trax – Bank Connector user guide

<statementRetrievalRequest xmlns="http://com.citi.citiconnect/services/types/
attachments/v1">
<statementId>111111111</statementId>
</statementRetrievalRequest>

The StatementId contains the StatementId received in the statement Initiation response.

11.2.5.3.2 Response message
Depending on the formatname defined in the statement initiation request message, the response will be a
FIN MT940, MT942 or an ISO20022 camt.052.001.02, camt.053.001.02 message.

11.3 JPMorgan Chase
11.3.1 Which APIs are currently supported by Bank Connector
• Treasury services - Account Balances API
The Account Balances API allows you to retrieve current and historical account balance information.

11.3.2 JPM Onboarding procedure
The onboarding procedure consists of the following steps:
• Register on the JPM developer portal
• Create a project in the developer portal
• Go to "Projects" and click "create project"
• Choose a project name and project description such as "<company name> UAT setup"
• Add the "certificate Upload management" card to the project
• Select the project - select Add APIS
• In the filter search for "certificate" and select the "Certificate Upload Management" card
• Select the "Certificate Upload Management" card and complete the following steps:
• Select API's and environment
• Currently Bank Connector only supports the Account Balances API
• Select Test to have access to the UAT environment.
• Select Initial setup as this is the first time that certificates will be exchanged.
• OAUTH - Submit request for credentials
• Follow the instructions on Create a private key and generate certificate signing request
(csr) (see page 361)
• Upload the generated certificate.
• OAUTH - Receive Client ID and Public Cert from JPMC

Bank APIs – 287

Trax – Bank Connector user guide

• Download the file from the JPM developer portal
• Take not of the Client ID in the file
• Follow the instructions on Add a public certificate (see page 351)
• Upload mutual TLS/SSL certificates
• see prepare TLS/SSL certificates for upload to developer portal
Create a new project once you are ready to go from UAT to Production or to renew certificates.

For the production setup you will need to complete a form called SADF form which is used to
determine who is going to be authorised to request and maintain the production
certificate. Please reach out to your implementation manager to ensure this step is completed
before starting the production setup procedure

11.3.3 Bank Connector configuration
Before you start, make sure to have the following information at hand:
• Client ID provided to you by JP Morgan
• The keystore created in step 3 above containing the private key and public certificate for OATH
authentication
• The following information from the keystore
• keystore password
• alias of the key
• thumbprint of the key
Step 1 - Export and unzip the latest channel configuration from Bank Connector
Step 2 - Create a KEYS folder and copy the keystore into the folder
Step 3 - Create an API-JPMorgan folder
Step 4 - Open a text editor such as notepad++ and create a new file
Step 5 - Copy/paste below extract into the file and edit the data as indicated

api:
name: "JP Morgan API"
connecttimeout: "60"
oauth:
# UAT: "https://idauatg2.jpmorganchase.com/adfs/oauth2/token/"
# Production: "https://idag2.jpmorganchase.com/adfs/oauth2/token/"
uri: "https://idauatg2.jpmorganchase.com/adfs/oauth2/token/"
form:
- param:
key: "grant_type"

Bank APIs – 288

Trax – Bank Connector user guide

value: "client_credentials"
- param:
# Client ID provided to you during Onboarding process
key: "client_id"
value: "CC-104221-H006182-146607-UAT"
- param:
key: "client_assertion_type"
value: "urn:ietf:params:oauth:client-assertion-type:jwt-bearer"
- param:
key: "resource"
value: "https://apigeeproductProd.jpmchase.net"
jwt:
formkey: "client_assertion"
# Client ID provided to you during Onboarding process
iss: "CC-104221-H006182-146607-UAT"
# UAT: "https://idauatg2.jpmorganchase.com/adfs/oauth2/token/"
# Production: "https://idag2.jpmorganchase.com/adfs/oauth2/token/"
aud: "https://idauatg2.jpmorganchase.com/adfs/oauth2/token/"
# Client ID provided to you during Onboarding process
sub: "CC-104221-H006182-146607-UAT"
iat: "{now}"
exp: "240000"
jti: "{uuid}"
header:
- param:
key: "kid"
# certificate thumbprint with colons removed.
value: "0D09B423144BA16AED686D40D8EF4AB9C28744A8"
header:
- param:
key: "Content-Type"
value: "application/x-www-form-urlencoded"
targetconnection:
- outgoing:
# Profile assigned to the API request message. The profile will be assigned to the
message by Trax or by Bank Connector
profile: "JPMorgan_balance_inquiry"
# UAT: "https://openbankinguat.jpmorgan.com/accessapi/balance"
# Production: "https://openbanking.jpmorgan.com/accessapi/balance"
uri: "https://openbankinguat.jpmorgan.com/accessapi/balance"
actor: "HttpProducerActor"
# name of the keystore used for OAUTH authentication
encryptkeyfile: "jpm.jks"
# password of the keystore
encryptkeypassword: "scotty"
# alias of the key in the keystore
encryptkeyalias: "jpm"
encryptionmode: "RS256"
referenceproperty: "accountId"
header:
- param:
key: "accept"

Bank APIs – 289

Trax – Bank Connector user guide

value: "application/json"
- param:
key: "Content-Type"
value: "application/json"

11.3.4 Request message
Bank Connector expects to receive a JSON-formatted request message with the following structure.

{
# Balances can be requested by date range (startDate and EndDate) or by relative date
(CURRENT_DAY, PRIOR_DAY)
# Date range request
"startDate": "2018-01-03",
"endDate": "2018-02-01",
# Relative date request
" "relativeDateType": "CURRENT_DAY",
# List of accounts
"accountList": [
{
"accountId": "000000004045701",""000000004045702"
}
]
}

11.4 Necto
11.4.1 Which APIs are currently supported by Bank Connector
• Account Balances API
• Account Transactions API
Via the Necto API balance and transaction information can be retrieved for a list of banks. You can find the
list of banks here29. Each bank onboarding procedure has to be completed before the API can be used in
Bank Connector. The required bank-specific information can be found on the Necto BankLync portal.
BankLync only supports requests via secure HTTP (HTTPS), and using mutual TLS is recommended for
maximum safety.

11.4.2 Bank Connector configuration
Before you start, make sure to have the following information at hand:
• Client ID, Client Secret and Client profile provided to you by the bank.

29 https://developer.necto-api.io/banklync/supported-banks/

Bank APIs – 290

Trax – Bank Connector user guide

• The Java truststore containing the Necto TLS/SSL certificate
• The Java keystore containing your TLS/SSL private key and public key.
1. Export and unzip the latest channel configuration from Bank Connector
2. Create an API-Necto folder
3. Open a text editor such as Notepad++ and create a new file

11.4.2.1 Account Balances API
Copy/paste the extract below into the file and edit the data as indicated to set up the authentication flow:

api:
name: NECTO Account Balances API
connecttimeout: 60
targetconnection:
- outgoing:
# Profile assigned to the API Account Balances request message for retrieving
balances. The profile will be assigned to the message by Trax or by Bank Connector
profile: "NECTO_Balance_Inquiry"
# sandbox uri for retrieving balances. {fi} will contain the bank code of the account
for which the balances will be retrieved, e.g. bnp. See https://developer.nectoapi.io/banklync/supported-banks/ for a list of suppported bank codes.
uri: https://sandbox.banklync.com/api/v3/accounts/{fi}/balances
actor: HttpProducerActor
header:
- param:
# Base64 encoded BankLync credentials separated by a colon. example:
necto:aj6eu_-8E9kg5SmYzoIm9uaW6KBxTsZDmFDzdDA_coOEDZcgTB!e_wxP2piB0Dxx
key: Authorization
value: Basic
bmVjdG86YWo2ZXVfLThFOWtnNVNtWXpvSW05dWFXNktCeFRzWkRtRkR6ZERBX2NvT0VEWmNnVEIhZV93eFAyc
GlCMER4eA==
- param:
key: Content-Type
value: application/json
- param:
# client id provided by the bank. This will be the client id for the bank specified
in the uri.
key: x-client-id
value: fnpiQCmAX1XvhKAEQGulsPKcWOUmfGXS
# client secret provided by the bank.
- param:
key: x-client-secret
value: gODkoAScYEhcVCTH
# client profile provided by the bank.
- param:
key: x-client-profile
value: necto_sandbox_bnp_balances_priorday_iban

Bank APIs – 291

Trax – Bank Connector user guide

# defines which field from the response message will be set at source reference in
Bank Connector.
referenceproperty: "iban"

Bank Connector expects to receive a JSON-formatted request message with the following structure:

{
"balance_date": "2024-08-17",
"accounts": [
{
"iban": "FR7630004123459876543219870"
}
]
}

There might be slight variations for certain banks. A complete overview of the request messages for the
banks can be found in https://developer.necto-api.io/account-balances/. This also contains the details of a
successful response to the request.

11.4.2.2 Account Transactions API
Copy/paste the extract below into the file and edit the data as indicated to set up the authentication flow:

api:
name: NECTO Account Balances API
connecttimeout: 60
targetconnection:
- outgoing:
# Profile assigned to the API Account Transactions request message for retrieving
transactions. The profile will be assigned to the message by Trax or by Bank
Connector
profile: "NECTO_Transaction_Inquiry"
# sandbox uri for retrieving transactions. {fi} will contain the bank code of the
account for which the balances will be retrieved, e.g. bnp. See https://
developer.necto-api.io/banklync/supported-banks/ for a list of supported bank codes.
uri: https://sandbox.banklync.com/api/v3/accounts/{fi}/transactions
actor: HttpProducerActor
header:
- param:
# Base64 encoded BankLync credentials separated by a colon. example:
necto:aj6eu_-8E9kg5SmYzoIm9uaW6KBxTsZDmFDzdDA_coOEDZcgTB!e_wxP2piB0Dxx
key: Authorization
value: Basic
bmVjdG86YWo2ZXVfLThFOWtnNVNtWXpvSW05dWFXNktCeFRzWkRtRkR6ZERBX2NvT0VEWmNnVEIhZV93eFAyc
GlCMER4eA==
- param:
key: Content-Type
value: application/json
- param:

Bank APIs – 292

Trax – Bank Connector user guide

# client id provided by the bank. This will be the client id for the bank specified
in the uri.
key: x-client-id
value: fnpiQCmAX1XvhKAEQGulsPKcWOUmfGXS
# client secret provided by the bank.
- param:
key: x-client-secret
value: gODkoAScYEhcVCTH
# client profile provided by the bank.
- param:
key: x-client-profile
value: necto_sandbox_bnptransactions_priorday
# defines which field from the response message will be set at source reference in
Bank Connector.
referenceproperty: "iban"

Bank Connector expects to receive a JSON-formatted request message with the following structure.

{
"transaction_date": "2023-03-23",
"accounts": [
{
"iban": "FR7630004123459876543219870"
}
]
}

There might be slight variations for certain banks. A complete overview of the request messages for the
banks can be found in https://developer.necto-api.io/account-transactions/. This also contains the details of
a successful response to the request.

11.5 US Bank
11.5.1 Which APIs are currently supported by Bank Connector
• Account balances - Current day and Previous day balance inquiry API
• Transactions - Current day transaction inquiry API
The Balance Inquiry API allows you to retrieve current and historical account balance information.
In order to access the balance inquiry API, the following certificates have to be exchanged
• TLS/SSL certificate. It can be provided by your IT department or hosting?
• Follow the instruction on Add a public certificate (see page 351) to import the US Bank TLS/SSL public
certificate in a java keystore.
• Follow the instructions on Add a TLS/SSL certificate (see page 354) to import your TLS/SSL private key
and certificate in a java keystore.

Bank APIs – 293

Trax – Bank Connector user guide

11.5.2 US Bank Onboarding procedure
The onboarding procedure consists of the following steps:
• Register on the US Bank developer portal
• Create a project in the developer portal
• Go to your name and click "credentials"
• Choose a project name and select as Product "Corporate Account Information (v2)"
• Copy the API key and secret
• Click "Promote" to get access to UAT or Production environment
• you will be contacted by usbank for further instructions

11.5.3 Bank Connector configuration
11.5.3.1 Authentication
Before you start, make sure to have the following information at hand:
• Client ID and Client Secret provided to you by US Bank
Step 1 - Export and unzip the latest channel configuration from Bank Connector
Step 3 - Create an API-usbank folder
Step 4 - Open a text editor such as notepad++ and create a new file
Step 5 - Copy/paste below extract into the file and edit the data as indicated to set up the authentication flow

api:
name: "US Bank API"
connecttimeout: 6"0"
oauth:
uri: "https://sandbox.usbank.com/auth/oauth2/v1/token"
form:
- param:
key: "grant_type"
value: "client_credentials"
header:
- param:
key: "accept"
value: "application/json"
- param:
key: "Content-Type"
value: "application/x-www-form-urlencoded"
headerhandler: "{bean:AuthorizationHandler}"
map:
- param:

Bank APIs – 294

Trax – Bank Connector user guide

key: "Authorization"
# combination of API Key and Secret separated by a colon
value: "WDSBS4ISXv5ZuGp8CwNFVuaojhtsUWDf:7igowQG8H4MnoGV6"

11.5.3.2 Account balances - Current day and Previous day balance inquiry API
Add the following following targetconnection - outgoing section to the file for the current day balance inquiry

targetconnection:
- outgoing:
# Profile assigned to the API current day balance request message. The profile will
be assigned to the message by Trax or by Bank Connector
profile: "USBank_current_day_balance_inquiry"
# uri to request current day balances
uri: "https://sandbox.usbank.com/commercial-banking/account-management/v2/
accounts/current-day"
actor: "HttpProducerActor"
referenceproperty: "accountID"
header:
- param:
key: "accept"
value: "application/json"
- param:
key: "Content-Type"
value: "application/json"
- param:
key: "Correlation-ID"
value: "{uuid}"
checkduplicate: "false"

Add the following following targetconnection - outgoing section to the file for the previous day balance
inquiry

targetconnection:
- outgoing:
# Profile assigned to the API current day balance request message. The profile will
be assigned to the message by Trax or by Bank Connector
profile: "USBank_previous_day_balance_inquiry"
# uri to request previous day balances
uri: "https://sandbox.usbank.com/commercial-banking/account-management/v2/
accounts/previous-day"
actor: "HttpProducerActor"
referenceproperty: "accountID"
header:
- param:
key: "accept"
value: "application/json"
- param:

Bank APIs – 295

Trax – Bank Connector user guide

key: "Content-Type"
value: "application/json"
- param:
key: Correlation-ID"
value: "{UUID}"

Bank Connector expects to receive a json formatted request message with the following structure

{
"accountsInquiry": {
# Either accountID(s) or accountDetails can be provided for account balances.
# When both accountID and accountDetails objects are provided, accountID object will
be defaulted and respective results are returned.
"accountID": [
# Accounts Unique Identifier
"6220l3igy0003ec299sj98000tria"
],
# Adddtional account's filter parameters for retrieving balances
"accountDetails": [
{
# Account Number of the authorized customer
"accountNumber": "103676561402",
# Routing Number of the authorized customer
"routingNumber": 122105155,
# Type of Account
"accountType": "DDA"
}
]
},
# Current Page Number from query result to return
"pageNumber": 1,
# Results page size
"pageSize": 20
}

11.5.3.3 Transactions - Current day transaction inquiry API
Add the following following targetconnection - outgoing section to the file for the current day transaction
inquiry

- outgoing:
profile: "USBank_current_day_transaction_inquiry"
# the query parameter {accountID} will be provided through the request message
received from the backend application
uri: https://sandbox.usbank.com/commercial-banking/account-management/v2/
accounts/{accountID}/transactions/current-day
actor: HttpProducerActor

Bank APIs – 296

Trax – Bank Connector user guide

referenceproperty: accountID
header:
- param:
key: accept
value: application/json
- param:
key: Content-Type
value: application/json
- param:
key: Correlation-ID
value: "{uuid}"
propertyhandler: "{bean:JSONHandler}"
checkduplicate: false
ishttpget: true

Bank Connector expects to receive a JSON-formatted request message with the following structure

{
"accountID": "6lgi49ux1qmzpwtfajn0hc5v83o7d"
}

Optionally, additional query parameters pageNumber, pageSize and bankReferenceNumber can be added

- outgoing:
profile: "USBank_current_day_transaction_inquiry"
uri: https://sandbox.usbank.com/commercial-banking/account-management/v2/
accounts/{accountID}/transactions/current-day?pageNumber={pageNumber}
&pageSize={pageSize}&bankReferenceNumber={bankReferenceNumber}
actor: HttpProducerActor
referenceproperty: accountID
header:
- param:
key: accept
value: application/json
- param:
key: Content-Type
value: application/json
- param:
key: Correlation-ID
value: "{uuid}"
propertyhandler: "{bean:JSONHandler}"
checkduplicate: false
ishttpget: true

When these parameters are added to the uri, Bank Connector expects to receive the following JSONformatted request message

Bank APIs – 297

Trax – Bank Connector user guide

{
"accountID": "6lgi49ux1qmzpwtfajn0hc5v83o7d",
"pageNumber": "1",
"pageSize": "100",
"bankReferenceNumber": "893456789745"
}

11.6 Routing API response messages to the backend application
When receiving a response message, Bank Connector will update the status of the original request message
to SENT or FAILED. A "SENT" or "FAILED" response is then routed to the originating backend application. In
case of a positive response, the response message is also routed to the backend application as a new
request.

11.6.1 Bank Connector configuration
11.6.1.1 API channel configuration
A "responseprofile" property can be defined in each targetconnection - outgoing section. This
responseprofile refers to a list subscriptions that can be set up in the originating backend application. These
subscriptions will define how the response message will be processed.

api:
name: "Citi API"
connecttimeout: "60"
oauth:
uri: "https://tts.sandbox.apib2b.citi.com/citiconnect/sb/authenticationservices/
v2/oauth/token"
formpayload: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<oAuthToken xmlns=\"http://com.citi.citiconnect/services/types/
oauthtoken/v1\">
<grantType>client_credentials</grantType>
<scope>/authenticationservices/v1</scope>
</oAuthToken>"
header:
- param:
key: "Content-Type"
value: "application/xml"
headerhandler: "{bean:AuthorizationHandler?prefix=Basic }"
responseprocessor: "XmlResponseProcessor"
map:
- param:
key: "Authorization"

Bank APIs – 298

Trax – Bank Connector user guide

value:
"82884eb7-9a6d-4cb3-815d-36740e6ed6de:X6wQ7nS2aJ5cN8vH7cE7oH1sD3yC8lB6lG5cP4pW8vA1xD0
lK8"
targetconnection:
- outgoing:
profile: Citi_statement_initiation
uri: https://tts.sandbox.apib2b.citi.com/citiconnect/sb/
accountstatementservices/v1/statement/initiation?client_id=d6f42eaf-5ca9-41cc-9077ac216e1ac3c2
actor: "HttpProducerActor"
keystore: bctesttraxfisglobalcom.jks
keystorepassword: scqS2K7uTk5t
truststore: cititls.jks
truststorepassword: traxtrax
signkeyfile: bctestenctraxfisglobalcom.jks
signkeyalias: bctestenctraxfisglobalcom
signkeypassword: aztKKJDtipwP
signprivatekeypassword: aztKKJDtipwP
encryptkeyfile: citi.jks
encryptkeypassword: citiciti
encryptkeyalias: citienc
decryptkeyfile: bctestenctraxfisglobalcom.jks
decryptkeyalias: bctestenctraxfisglobalcom
decryptkeypassword: aztKKJDtipwP
decryptprivatekeypassword: aztKKJDtipwP
verifykeyfile: citi.jks
verifykeypassword: citiciti
verifykeyalias: citisig
preprocessor: "decrypt_verify_XML,remove_XML_signature"
postprocessor: "sign_encrypt_XML"
header:
- param:
key: "Content-Type"
value: "application/xml"
# response profile that corresponds to a list of subscription defined in the
originating backend channel
responseprofile: statement_initiation_response

11.6.1.2 Backend channel configuration
For Trax, the subscriptions are set up in the outgoingresponse-outgoing section in the trax-config file.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"

Bank APIs – 299

Trax – Bank Connector user guide

truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
targetconnection:
incoming:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
outgoingresponse:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
outgoingresponse:
# this section contains the subscription options for responseprofile
"statement_initiation_response"
- outgoing:
profile: "statement_initiation_response"
subscriptions:
- subscription:
# when the response has a http response code 200 the status of the request will be
updated to SENT and the response will be routed to Trax.
filter: 200
code: RESPONSE
order: true
status: SENT
- subscription:
# The same response message with http response code 200 will also be routed as a new
request to Trax with TSGTargetProfile "statement_initiation_response_request"
filter: 200
code: REQUEST
order: true
targetprofile: "statement_initiation_response_request"
# when the response has a http response which is different from 200 the status of the
request will be updated to FAILED and the response will be routed to Trax.
- subscription:
filter: 400,401,500,503
code: RESPONSE
order: true
status: "FAILED"
targetconnection:
- incoming:

Bank APIs – 300

Trax – Bank Connector user guide

profile: "statement_initiation_response_request"

For other backend applications connecting to Bank Connector through the filesystem, the subscriptions are
set up in the outgoingresponse-outgoing section of the file-system-config file.

outgoingresponse:
- outgoing:
profile: "statement_initiation_response"
uri: "sftp://default-dev-sftp:22/data/bank-connector/in?
username=trax&password=trax&binary=true"
actor: "FileResponseProducerActor"
subscriptions:
- subscription:
filter: 200
code: RESPONSE
order: true
status: SENT
- subscription:
filter: 200
code: REQUEST
order: true
targetprofile: "statement_initiation_response_request"
- subscription:
filter: 400,401,500
code: RESPONSE
order: true
status: "FAILED"
targetconnection:
- incoming:
profile: "statement_initiation_response_request"
uri: "sftp://default-dev-sftp:22/data/bank-connector/in?
username=trax&password=trax&binary=true"
actor: "FileProducerActor"

Bank APIs – 301

Trax – Bank Connector user guide

12 H2H connections
12.1 Scope
Bank Connector can connect to banks using file based channels for outgoing and incoming messages. The
connection is usually made through the Camel SFTP components.
For host-to-host connections, Bank Connector requires a correctly formatted outgoing message as specified
by the bank. Bank Connector does not perform any validations or modifications to the message.

12.2 H2H connection details
12.2.1 Defining the channel name
The channel name as it appears in the Channels tab of the GUI can be determined via the folder name
through which the H2H configuration is imported. (The -H2H suffix is not mandatory.)

12.2.2 SFTP connection details
The connection details are set up in the file-system-config.yml file

H2H connections – 302

Trax – Bank Connector user guide

12.2.2.1 Connection details from Bank Connector to bank
The targetconnection - outgoing section has to contain the following parameters:

file-system-config.yml

filesystem:
targetconnection:
outgoing:
actor: FileProducerActor
uri:sftp://hostname:port/path to emission directory?
binary=true&stepwise=false&streamDownload=true&serverHostKeys=sshrsa&disconnect=true&fileExist=fail

Property

Description

M/O

actor

Value has to be for "FileProducerActor"

M

uri - hostname

SFTP server hostname

M

this can be the DNS or IP
uri - port

port the SFTP server is listening on

M

uri - path to emission directory

relative or absolute path to the folder in which Bank
Connector will drop the files

M

uri - binary

Determines the file transfer mode

M

Value has to be "true"
uri - stepwise

Sets whether Bank Connector will stepwise change
directories while traversing file structures when
uploading a file to a directory.

M

The value has to be "false"
uri - streamDownload

Sets the download method to use when not using a
local working directory. If set to true, the remote
files are streamed to the route as they are read.

M

The value has to be "true"

H2H connections – 303

Trax – Bank Connector user guide

Property

Description

M/O

uri - serverHostKeys

Sets a comma separated list of algorithms
supported for the server host key.

M

The value has to be set to "ssh-rsa"
uri - disconnect

Determines whether the established connection
will disconnect or not to from the SFTP server right
after use.

O

The value has to be "true"
uri - fileExist

Determines the behaviour if a file with the same
name already exists in the emission directory

M

When setting the value to "Fail", the message will
fail in Bank Connector and will not be written to the
emission directory

12.2.2.2 Connection details from bank to Bank Connector
The sourceconnection - incoming section has to contain the following parameters:

file-system-config.yml

filesystem:
sourceconnection:
incoming:
actor: FileConsumerActor
uri:sftp://hostname:port/path to reception directory?
binary=true&readLock=changed&delete=true&serverHostKeys=ssh-rsa&disconnect=true

Property

Description

M/O

actor

Value has to be for "FileConsumerrActor"

M

uri - hostname

SFTP server hostname

M

this can be the DNS or IP
uri - port

port SFTP server is listening on

M

H2H connections – 304

Trax – Bank Connector user guide

Property

Description

M/O

uri - path to reception directory

relative or absolute path to the folder from which
Bank Connector will pick up the files

M

uri - binary

Determines the file transfer mode

M

Value has to be "true"
readLock

Files will only be polled if Bank Connector has
exclusive read-lock on the file

M

Value has to be "changed"
delete

f set to "true", the files will be deleted after
processing.

M

Value has to be "true"
uri - serverHostKeys

Sets a comma separated list of algorithms
supported for the server host key.

M

The value has to be set to "ssh-rsa"
uri - disconnect

Determines whether the established connection
will disconnect or not to from the SFTP server
right after use.

M

The value has to be "true"

12.2.3 Securing the H2H connection
The connection between Bank Connector and the SFTP server can be secured by username/password
authentication or SSH pubic key authentication. The use of SSH public key authentication is strongly
recommended.

12.2.3.1 SSH public key authentication
SSH relies upon the use of a private / public key pair. They are used to authenticate the identity of the user
that wants to access the SFTP server. The private key has to be set up in bank Connector, whilst the public
key needs to be stored on the SFTP server.
It is set up in Bank Connector by specifying the private key in the targetconnection-outgoing or
sourceconnection-incoming section of the connection details. The name of the key can be freely chosen, but
is is important that it corresponds to the name with which the key has been imported in bank Connector. The
name used typically is id_rsa (default name when using the windows tool ssh-keygen to generate the key).
When generating the key, it is recommended to protect the key with a passphrase.

H2H connections – 305

Trax – Bank Connector user guide

Below example shows how to generate the SSH key by running the ssh-keygen command from a command
prompt window:

> ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (C:\Users\e1083346/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):e
Enter same passphrase again:
Your identification has been saved in C:\Users\e1083346\id.rsa
Your public key has been saved in C:\Users\e1083346\id.rsa.pub
The key fingerprint is:
SHA256:u73OOrEkRZ6L9QmhXG8OZ1JWRHuQUoN+4lDkDXqClEk fnfis\e1083346@EMEABRUGQ3NGB3
The key's randomart image is:
+---[RSA 3072]----+
|
.Eo .o*B.
|
|
.+.+o*o.+
|
|
..=oOo.o . |
|
o XoB ..
|
|
+S& +
|
|
o +.=
|
|
o.o
|
|
o+
|
|
o+=.
|
+----[SHA256]-----+

The following parameters have to be added to targetconnection - outgoing or sourceconnection - incoming
section:

file-system-config.yml

filesystem:
targetconnection:
outgoing:
uri:sftp://hostname:port/directory>?privateKeyPassphrase=<passphrase of the
private key>&preferredAuthentications=publickey
privatekey: private key name

12.2.3.2 Username/password authentication
The following parameters have to be added to targetconnection - outgoing or sourceconnection - incoming
section to use username and password authentication:

file-system-config.yml

filesystem:

H2H connections – 306

Trax – Bank Connector user guide

targetconnection:
outgoing:
uri:sftp://hostname:port/directory?username=<name to use for
login>&password=<password to use for login>&preferredAuthentications=password

12.2.4 Setting the reception directory polling frequency
The frequency with which Bank Connector will poll the reception directory to check for new files can be
configured by adding the property "delay" to the uri. It is expressed in milliseconds.
By default, Bank Connector uses a polling frequency of 500.

file-system-config.yml

filesystem:
sourceconnection:
incoming:
uri:sftp://hostname:port/path to reception directory?delay=<delay expressed in
milliseconds>

12.3 H2H outgoing flow
12.3.1 Configuring outgoing profiles
In order to route the outgoing message to the correct bank, the property "profile" has to be added to the
targetconnection - outgoing section. This profile has to correspond to the profile that was assigned to the
message when entering Bank Connector from the backend application or the profile that was assigned to the
message in Trax. For each profile, a complete outgoing section with all the parameters has to be added?

file-system-config.yml

filesystem:
targetconnection:
- outgoing:
profile:
uri:
actor: FileProducerActor
- outgoing:
profile:
uri:
actor: FileProducerActor

H2H connections – 307

Trax – Bank Connector user guide

12.3.2 Defining the outgoing filename
Bank Connector generates a filename consisting of <15 character string>-<15 character string> (e.g.
82B5193F3ABCC5D-0000000000000000) if no specific filename has been configured.
The filename can be configured by adding the property "filename" in the targetconnection - outgoing section.
A fixed filename can be configured or a combination of a fixed string with a dynamic expression. It is also
possible to add a variable sequence which will add a 4-digit number to the filename.

file-system-config.yml

filesystem:
targetconnection:
- outgoing:
filename: FIN-${date:now:yyyyMMddHHmmssSSS}_${sequence}.xml

The dynamic expression can be a timestamp as in the example above or can be one of the message header
parameters. These message header parameters have to be referenced by ${paramheader:<parameter header
name>}

file-system-config.yml

filesystem:
targetconnection:
- outgoing:
filename: ${paramheader:CamelFileName}.xml

In the example above, The CamelFileName parameter is taken from an outgoing message. The parameter
header name is case sensitive.
The filename can also be configured in Trax and forwarded to Bank Connector as a JMS parameter. It can
then be referenced in the filename property as a parameter header name.

H2H connections – 308

Trax – Bank Connector user guide

In the example above, the debtor account bank code of the payment together with a timestamp will be
forwarded to Trax as JMS parameter "TSGfilename". The parameter always have to be prefixed with TSG.

file-system-config.yml

filesystem:
targetconnection:
- outgoing:
filename: ${paramheader:TSGfilename}.xml

The parameter can then be referenced as a parameter header as shown above.

12.4 H2H incoming flow
12.4.1 Setting up incoming routing
Bank Connector will assign a target profile to the incoming message based on the SFTP folder from which
the message was picked up, or on the filename. Via the target profile, Bank Connector will route the message
to the correct backend application.

12.4.1.1 Assigning a profile based on SFTP folder
For each SFTP folder, a new incoming section has to be added to the sourceconnection. The target profile
that will be assigned to the incoming messages has to be defined by adding the property "targetprofile".

H2H connections – 309

Trax – Bank Connector user guide

file-system-config.yml

filesystem:
sourceconnection:
- incoming:
targetprofile: camt53
actor: FileConsumerActor
uri: sftp://hostname:port/path to reception directory?
binary=true&readLock=changed&delete=true&serverHostKeys=ssh-rsa&disconnect=true
- incoming:
targetprofile: MT940
actor: FileConsumerActor
uri: sftp://hostname:port/path to reception directory?
binary=true&readLock=changed&delete=true&serverHostKeys=ssh-rsa&disconnect=true

12.4.1.2 Assigning a profile based on filename
It is also possible to assign a target profile based on the filename of the incoming message. In that case, the
query parameter "include" has to be added to the uri. The value will be a regex pattern.

file-system-config.yml

filesystem:
sourceconnection:
- incoming:
targetprofile: camt53
actor: FileConsumerActor
uri: sftp://hostname:port/path to reception directory?
binary=true&readLock=changed&delete=true&serverHostKeys=sshrsa&disconnect=true&include=.*camt53.*
- incoming:
targetprofile: MT940
actor: FileConsumerActor
uri: sftp://hostname:port/path to reception directory?
binary=true&readLock=changed&delete=true&serverHostKeys=sshrsa&disconnect=true&include=.*MT940.*

The target profiles that are assigned to the messages via the incoming routing have to be defined also in the
targetconnection - incoming section of the backend channel to which the messages need to be sent.

12.5 Routing H2H response messages to the backend application
When the outgoing message is successfully delivered to the SFTP server, the status of the message will be
updated from "channel sent" to "sent". If the message cannot be delivered, the status of the message will be
updated to "failed.

H2H connections – 310

Trax – Bank Connector user guide

12.5.1 Configuring the subscription
A specific subscription has to be set up for processing the response messages for H2H connections.

12.5.1.1 H2H channel configuration
A "responseprofile" property can be defined in each targetconnection - outgoing section. This
responseprofile refers to a list of subscriptions that can be set up in the originating backend application.

file-system-config.yml

filesystem:
targetconnection:
- outgoing:
responseprofile: "H2H"

12.5.1.2 Originating backend channel configuration
The following subscriptionshave to be set up in the outgoingresponse-outgoing section in the backend
channel config file.

trax:
default:
sourceconnection:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-source:trax.toTSGQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
# The default response subscriptions will be used generally.
responseprofile: "default_response"
targetconnection:
incoming:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-target:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="

H2H connections – 311

Trax – Bank Connector user guide

outgoingresponse:
outgoing:
brokerurl: "${env:TRAX_BROKER_URL}?sslEnabled=true&randomize=false"
uri: "jms-response:trax.fromTSGQueue?exchangePattern=InOnly"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
profile: "default_response"
outgoingresponse:
# this section contains the specific subscription options for responseprofile "H2H"
- outgoing:
profile: "H2H"
subscriptions:
- subscription:
filter: "FAILED"
code: "RESPONSE"
order: "true"
status: "FAILED"
- subscription:
filter: "SENT"
code: "RESPONSE"
order: "true"
status: "SENT"

H2H connections – 312

Trax – Bank Connector user guide

13 Message management
13.1 Message monitoring
In the messages screen you can track the status of the messages and find the errors that have occurred.

13.1.1 Expanding the message list
By default the message list shows the 500 most recent messages.
It is possible to list more messages via the following application properties

Application property

Description

Default value

gui.api.list.max.view

determines the maximum number of
messages that are shown when accessing
the message screen

500

gui.message.max.view

determines the maximum number of
messages that are returned with a search

500

To avoid performance issues, the maximum number of messages should not be set higher than 2000.

13.1.2 Searching the message list
13.1.2.1 Search on message data
The following message data can be used to narrow down the list of messages

search
criteria

values

direction

outgoing / out
incoming / in

source or
target
channel

Possible values are FIN, FILEACT, FILE-SYSTEM
You can also search on a custom channel name e.g. API-USbank

Message management – 313

Trax – Bank Connector user guide

search
criteria

values

message
status

final or intermediary status of the message

target profile

the profile assigned to the message when entering Bank Connector

Messages can have the following states
outgoing messages

Status

Reason

Description

IMPOR
TED

Message imported

Message has been received from the backend application. In Trax,
the status of the payment or payment file will be sending once it
has been forwarded to Bank Connector.

CHANN
EL
SENT

Technical sent

A connection has been established and the message has been
successfully transmitted.

RETRYI
NG

Auto Retry : number of
attempt

Bank Connector was not able to establish a connection and the
message is being retried. The number of retry attempts is defined
by the maxretries property.

RESPO
NSE
SENT

<Feedback type> received

Intermediate feedback has been received from the bank. Whether
a feedback is defined (intermediate or final) is configurable
through the subscription options.

SENT

Successfully sent

Final positive feedback received from bank.

FAILED

Channel timeout

No final feedback received from bank within the maximum time
defined in the channel timeout.

Duplicate of message
with source reference:

The message is a duplicate of a previously received message.

Target channel not
running for target profile
<profile name>

Message has been received from the backend application but
cannot be transmitted as the target channel is not running.

Message management – 314

Trax – Bank Connector user guide

Status

Reason

Description

Configuration missing for
target profile <profile
name>

Message has been received from the backend application but the
target profile assigned to the message has not been set up in a
target channel.

<Feedback type> received

Final negative feedback received from bank. (NAK or

RESPO
NSE
FAILED

description of connection
error

An intermediate or final feedback message could not be
transmitted to the backend application as the connection could
not be established.

CHANN
EL
TIMEO
UT

Technical failed

No final feedback has been received received from the bank
within the maximum time defined in the channel timeout settings

incoming messages

Statu
s

Reason

Description

IMPO
RTED

Message imported

Message has been received from bank.

CHAN
NEL
SENT

Technical sent

A connection to the backend application has been established and the
message has been successfully transmitted.

SENT

successfully sent

The message has been delivered to the backend application.

NOT
ROUT
ED

No match found in
routing table

Bank Connector cannot assign a targetprofile to the incoming message.
Check the routing criteria in the incoming routing (fin- or fileact-routingconfig.yml)

FAILE
D

Target channel not
running for target
profile <profile
name>

Message has been received from bank but cannot be transmitted to the
backend application as the target channel is not running.

Message management – 315

Trax – Bank Connector user guide

Statu
s

Reason

Description

Duplicate of
message with
source reference:

The message is a duplicate of a previously received message.

description of
connection error

A message could not be transmitted to the backend application as the
connection could not be established.

13.1.2.2 Search on reference
To find a message by its reference, you can use the source or target reference which is assigned by the
source or target channel.
source reference
The source reference depends on the channel through which the message enters Bank Connector.

channel

reference

Trax

Trax E2E reference

FILESYSTEM

auto-generated by Bank Connector (uuid)

FIN

Depending on the message format and the presence of the field
FIN RJE
Unique End-to-end Transaction Reference (UETR) or
Message User Reference (MUR) or
Message Input Reference (MIR)
FIN XMLv2
E2ETransactionReference
UserReference
SenderReference

FILEACT

Depending on the presence of the field in the XMLv2 PDU
message
TransferRef (SNL reference)
StoredTransferRef
SenderReference

Message management – 316

Trax – Bank Connector user guide

channel

reference

FINPLUS

Depending on the presence of the field in the XMLv2 PDU
message
E2ETransactionReference
UserReference
SenderReference

For FIN, FINplus and FileAct messages it also possible to overwrite the defaults and configure which
reference should be shown as source reference in the GUI.
target reference
For incoming messages, the target reference will be the same as the source reference
For outgoing messages, the target reference will depend on the channel

channel

reference

FIN

FIN RJE
Message User Reference (MUR)
FIN XMLv2
ReconciliationInfo

FileAct

TransferRef (SNL reference)

FINplus

ReconciliationInfo

13.1.2.3 Search on date and time
Adding a date to the search criteria will limit the results to the messages that have processed that day
The date can be entered in format YYYY-MM-DD or DD-MM-YYYY.
Adding a time will show the messages that were processed between the time entered up to the next hour.
Below search will show the outgoing FIN messages that were successfully sent on 03-06-2024 between
09:10 and 10:00

FIN out sent 03-06-2024 09:10

Message management – 317

Trax – Bank Connector user guide

13.1.3 Setting the source and target reference for incoming messages
For incoming FIN, FINplus and FileAct messages, it is possible to configure the references that will be shown
as source or target reference in the GUI.
You can do this by adding the property "sourcereferenceproperty" and "targetreferenceproperty" to the
sourceconnection - incoming section. As from version 2.30, the source reference was configurable by adding
the property "referenceproperty". Next to "sourcereferenceproperty", "referenceproperty" can still be used to
set the source reference.

fileact:
default:
sourceconnection:
incoming:
referenceproperty:

The following references can be selected

Message format

values

FIN RJE

MUR, MIR, UETR

FIN XMLv2

E2ETransactionReference, userreference, senderreference

FileAct XMLv2

senderreference, userreference, filelogicalname, snlref, reference,
transferref, storedtransferref, filename

13.1.4 Exporting the message search results
The message search result set can be downloaded to a csv formatted file by clicking the download button.

Message management – 318

Trax – Bank Connector user guide

This will download the following message data:
•
•
•
•
•
•

Status
Direction
Source reference
Target reference
Target
Creation date

13.2 Retrying failed messages
Outgoing messages that have status FAILED cannot be retried manually in Bank Connector, but instead have
to be re-sent from the backend application. For Trax, the message will move to the "sending failed" repository
based on the failed response message sent to Trax from which it can be re-scheduled. The Trax re-schedule
action will import the message again in the outgoing message flow. If the message was successful, a
sentresponse message will be forwarded to Trax and the message will move from the "sending" repository to
the "sent" repository.
Outgoing messages that have status RESPONSE FAILED because the response on the outgoing message
cannot be delivered to the backend application, can be manually retried in Bank Connector.
Incoming messages that have a status FAILED or NOT ROUTED can be manually retried in Bank Connector.
When a message can be retried, the "retry" action button is displayed in the messages screen.

Message management – 319

Trax – Bank Connector user guide

The "retry all" action button allows you to retry multiple messages at once. It will only work in combination
with a search query and will perform the retry action on the search results

.

13.3 Confidential profile and confidential messages
In order to view the message details in Bank Connector, a user requires to have the role "confidential". The
setup of this profile is managed through the Identity Provider.

Message management – 320

Trax – Bank Connector user guide

13.3.1 Outgoing messages
Users with confidential access will have access to the message details in the content section of the
Messages detail screen.

Without confidential access, users are not able to view the content section.
Next to that, outgoing messages can be also be flagged as confidential by the backend application. (This
functionality is currently only available for Trax.) When a message is flagged as confidential in Trax, an extra
jms parameter "confidential" with value "true" will be forwarded to Trax. In this case no Bank Connector user
regardless of having the "confidential" role or not, will be able to view the message details.

Message management – 321

Trax – Bank Connector user guide

13.3.2 Incoming messages
Based on the FIN, FileAct or FINplus routing criteria, you can define if the message details of a message that
matches the criteria will be visible in the GUI or not. This is done by adding the property "confidential" to the
routing criteria with value "true". The default value is "false".

fileact:
- filtering:
confidential: "true"

If set to "true", no Bank Connector user can view the contents of the messages.

13.4 Duplicate detection
13.4.1 Duplicate check in Bank Connector
The duplicate check will compare an incoming message from the backend application or the bank against a
search pool of older messages. The duplicate check can be activated or de-activated for all channels or for a
specific channel. It is also possible to determine the maximum time the duplicate check will look into the
past to find matching duplicate messages.
Duplicate messages will receive the status FAILED in Bank Connector. Duplicate incoming messages can be
manually retried in Bank Connector. In that case the duplicate check will be bypassed and the message will
be sent to the backend application.
For outgoing messages, the message cannot be manually retried in Bank Connector. Instead the message
has to be re-sent from the backend application. Trax will, in that case, pass an extra parameter to Bank
Connector indicating that the message is a possible duplicate (jms parameter TSGPossibleDuplicate =
TRUE) on the basis of which Bank Connector will bypass the duplicate check.

Message management – 322

Trax – Bank Connector user guide

The parameter TSGPossibleDuplicate will be set to TRUE by Trax in case of a re-schedule of a message that
was "sending failed" or if Trax allows the sending of duplicate messages (parameter "Allow duplicate = true"
in the outgoing routing configuration).

13.4.1.1 Application wide configuration via the application properties
The duplicate detection is configured for all channels with the following application properties

Application Property

Description

Default value

duplicate.Check.Limit

Lookup period to find matching
duplicate messages expressed in
hours

24

duplicate.check.limit.jms

Lookup period to find messages
with a same jms id (Trax
channel specific) expressed in
hours

1

duplicate.check.verify.me
ssages

Activates or deactivate
duplicate check on outgoing
messages

true

duplicate.check.verify.in
coming.messages

Activate or deactivate
duplicate check on incoming
messages

true

duplicate.check.verify.re
sponse.messages

Activate or deactivate
duplicate check on response
messages

false

13.4.1.2 Channel specific configuration
In order to have a specific setting per channel, you can add the parameter checkduplicate to the
sourceconnection-outgoing or sourceconnection-incoming section of the [channel type]-config file. This
setting will override the value defined in the application.properties file.

Example of duplicate detection in trax-config file

trax:
maxretry: "5"

Message management – 323

Trax – Bank Connector user guide

retryinterval: "2000"
default:
sourceconnection:
outgoing:
brokerurl:
uri:
truststore:
truststorepassword:
keystore:
keystorepassword:
encryptkeyfile:
encryptkeypassword:
responseprofile:
# Disables the duplicate check for messages received from Trax
checkduplicate: "false"

13.4.2 Possible duplicate flag from Trax
Trax can pass an extra parameter to Bank Connector indicating that an outgoing message is a possible
duplicate (jms parameter TSGPossibleDuplicate = TRUE) on the basis of which Bank Connector will bypass
the duplicate check.
The parameter TSGPossibleDuplicate will be set to TRUE by Trax in case of a re-schedule of a message that
was "sending failed" or if Trax allows the sending of duplicate messages (parameter "Allow duplicate = true"
in the Trax outgoing routing configuration).

13.4.3 PDE (Possible duplicate Emission) for Swift FIN, FileAct and FINplus
Possible duplicate FIN or FileAct outgoing messages are marked with a PDE indicator. The PDE indicator will
be set when a message received from Trax has its jms parameter TSGPossibleDuplicate set to TRUE.
Swift picks up these indicators and passes them on to notify the recipient that these messages are sent to
the same correspondent with an identical payload. The PDE warns the receiver that the same message may
already have been input to the service. Depending on the agreements with the counter party, actions can then
be taken to verify if the message is an actual duplicate
In XMLv2 formatted messages, the PDE is transmitted via the PDU message by setting tag
<IsPossibleDuplicate> to true. For MQ-MT formatted messages, tag [PDE:} will be added to the trailer block
of the message.

13.5 Channel timeout
With channel timeout you can set the amount of time in which a message is allowed to be processed. If the
message processing time exceeds this maximum, i.e. the message has not reached a final state within the
maximum time allowed, Bank Connector will update the status of the message to "Channel timeout". A
"Channel timeout" event will also be sent to the backend application. The message remains in "Channel
timeout" until a final feedback has been received by the bank or until Bank Connector considers this
message as unsuccessful and updates the status of the message to FAILED accordingly. This can be
configured through properties on the targetchannel - outgoing connection.

Message management – 324

Trax – Bank Connector user guide

The timer for triggering the "Channel timeout" event starts when a message is imported in Bank Connector.
In the default setup, a scheduled job will run every 5 minutes to scan for messages that have a non-final
state for 30 minutes or more. You can configure the maximum time and the job schedule via the application
properties. The maximum number of messages that are scanned per job run is configurable. as well This
configuration will be applied for all channels.
It is also possible to define a maximum time per channel. The channel-specific setting will then override the
general settings.
When a message times out in bank Connector, Trax will receive an event message with type channel timeout.
This event message will be visible in the communication history of the payment file in Trax.
As channel timeout is not a final state in Bank Connector, it is possible to determine if a message will move
from channel timeout to the final state failed and after which time. This needs to configured explicily, so by
default the message will remain in channel timeout.

13.5.1 Application wide configuration via the application properties
Application property

Description

Default value

channel.timeout.cron

Schedule for channel timeout validation
checks

0 0/5 * ?
every 5 minutes

channel.timeout.default

Time expressed in milliseconds after which
a message will time out if no final response
is received

1800000
30 minutes

channel.timeout.millis.before.ch
eck

Time expressed in milliseconds that a
message has to be pending before it will be
considered for time out

120000
2 minutes

channel.timeout.window.size

Maximum number of communications to
be validated at a scheduled time

100

13.5.2 Channel timeout channel specific configuration
In order to have a specific setting per channel, you can add the parameter replytimeout to the
targetconnection-outgoing or targetconnection-incoming section of the [channel type]-config file. This
setting will override the value defined in the application.properties file.

Example of channel timeout setting in fin-config file

fin:
default:

Message management – 325

Trax – Bank Connector user guide

targetconnection:
outgoing:
actor: "FINSOAPActor"
uri:
messagepartner:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:
autoreconnectcron:
# maximum time expressed in milliseconds. This will set the channel timeout at 15
minutes for FIN outgoing messages.
replytimeout: "900000"

13.5.3 Fail after channel timeout configuration in targetconnection - outgoing
By adding the parameters failontimeout and failafter to the targetconnection-outgoing of the [channel type]config file, you can determine if a message will move from channel timeout to the final state failed and after
which time.

Example of Fail after channel timeout setting in fin-config file

fin:
default:
targetconnection:
outgoing:
actor: "FINSOAPActor"
uri:
messagepartner:
windowsize:
proxyhost:
proxyport:
timeout:
sockettimeout:
autoreconnectcron:
# indicates if a message will move to status failed when it receives a channel
timeout event. Possible values are true or false. The default value is false
failontimeout: "true"
# time expressed in milliseconds after which the status of the message will move from
channel timeout to failed.
failafter: "3600000"

13.6 Data purging
Purging can be used to remove out-of-date or irrelevant data.

Message management – 326

Trax – Bank Connector user guide

The following data will be purged:
• messages in the database and on the filesystem : The default retention period for incoming and
outgoing messages is 60 days. Messages can be kept in the database or on the filesystem for a
maximum of 125 days. This is in line with the Swift data retention policy according to which user can
retrieve messages up to 124 days after which they are deleted.
• logs: The default retention period for logs is 7 days.
The purge action can be executed by the system with a specific interval. The retention period and the
scheduled purge job execution are configurable via the application properties.

Application Property

Description

Default value

data.scheduler.retention.peri
od

Period expressed in days after which
messages are purged from the
database and the filesystem.

60

data.scheduler.log.retention.
period

Period expressed in days after which
logs are removed from the database.

7

data.scheduler.purge.cron

Schedule for removing messages from
the database and the filesystem, and for
logs from the database

011**?
every day at 01:01 AM (server
time)

data.scheduler.cleanup.cron

Schedule for removing temporary
messages from the filesystem.

0 0/10 * * * ?
every 10 minutes

data.scheduler.purge.limit

Maximum number of purged records
during each scheduled run.

10000

13.7 Message encryption and decryption
Bank Connector supports encryption, and optionally signing and compression of outgoing messages, and
decryption and signer validation for incoming messages using PGP and CMS.

13.7.1 Configuration of PGP encryption and decryption
• Import the PGP private key and public key in Bank Connector.
• For encrypting outgoing messages, add the following parameters in the of the [channel type]-config
file for which PGP encryption has to be activated.

Message management – 327

Trax – Bank Connector user guide

example of PGP encryption in fileact-config file

fileact:
default:
targetconnection:
outgoing:
postprocessor: "encrypt_PGP"
encryptionmode: "PGP"
encryptkeyfile:
encryptpublickeyfile:
keyalgorithm:
hashalgorithm:
encoding:
compressionalgorithm:
encryptfilename:
profile:
transformpdu:
usetransformedpayload:

Property

Description

Mandato
ry /
Optional

Exampl
e

postproc
essor

value has to be encrypt_PGP

M

encrypt
_PGP

encryptio
nmode

value has to be PGP

M

PGP

encryptk
eyfile

Name of the private key used to sign the message. It has to
correspond to the name with which the key was imported.

M

pgpprivatek
ey.pgp

encryptk
eypassw
ord

password of the encryptkeyfile. Only needed if encryptkeyfile is
password protected

O

encryptp
ublickeyf
ile

Name of the public key. It has to correspond to the name with which
the key was imported. Used for encrypting the message

M

pgp.pu
blickey.
asc

keyalgori
thm

symmetric key algorithm. The Possible values are CAST5, AES_256
or TRIPLE_DES.

M

CAST5

Message management – 328

Trax – Bank Connector user guide

Property

Description

Mandato
ry /
Optional

Exampl
e

hashalgo
rithm

Possible values are SHA1or SHA256,. Only needed if signing is
required.

O

SHA1

encryptfil
ename

Filename assigned to the message before encryption. It can be a
combination of a string with parameters. When the encryptfilename is
configured, it will be used as physical filename.

O

"pain0
01_$
{date:n
ow:yyyy
MMdd
HHmm
ssSSS}
$
(seque
nce).x
ml"

encoding

Only PEM is supported for PGP.

O

PEM

compres
sionalgor
ithm

Possible values are ZIP, ZLIB and BZIP2. Only needed if compression
is required.

O

ZIP

transfor
mpdu

For outgoing FileAct XMLv2 messages, this property defines if the
XMLv2 PDU message has to be encrypted. Possible values are true or
false. The default value is true

O

true

usetrans
formedp
ayload

For outgoing FileAct XMLv2 messages, this property defines if the
Filedigestvalue in the XMLv2 PDU message has to be calculated on
the encrypted Payload message or the original unencrypted payload.
Possible values are true or false. The default value is false.

O

false

• For decrypting incoming messages, add the following parameters to the sourceconnection-incoming
section of the of the [channel type]-config file for which PGP decryption has to be activated.

fileact:
default:
sourceconnection:
incoming:
preprocessor: "decrypt_PGP"
encryptkeyfile:
encryptkeypassword:
encryptpublickeyfile:

Message management – 329

Trax – Bank Connector user guide

Property

Description

Mandatory /
Optional

Example

preprocessor

value has to be decrypt_PGP

M

decrypt_PGP

encryptkeyfile

Name of the private key used to
sign the message. It has to
correspond to the name with
which the key was imported. Used
for decrypting the message

M

pgp-privatekey.pgp

encryptkeypassword

password of the encryptkeyfile.
Only needed if encryptkeyfile is
password protected

O

encryptpublickeyfile

Name of the public key. It has to
correspond to the name with
which the key was imported. Used
for signer validation.

O

pgp.publickey.asc

13.7.2 Configuration of CMS encryption and decryption
• Import the PGP private key and public key in Bank Connector. See the section Importing certificates
and keystores in Importing and exporting channel configuration (see page 81).
• For encrypting outgoing messages, add the following parameters to the targetconnection-outgoing
section of the of the [channel type]-config file for which CMS encryption has to be activated.

fileact:
default:
targetconnection:
outgoing:
postprocessor: "encrypt_CMS"
encryptionmode: "CMS"
encryptkeyfile:
encryptkeypassword:
encryptpublickeyfile:
keyalgorithm:
hashalgorithm:
addsignercertificate:
encoding:
compressionalgorithm:
profile:
transformpdu:
usetransformedpayload:

Message management – 330

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

Examp
le

postproc
essor

Value has to be encrypt_CMS

M

encrypt
_CMS

encryptio
nmode

Value has to be CMS

M

CMS

encryptk
eyfile

Name of the private key used to sign the message. It has to
correspond to the name with which the key was imported.

M

CMS_k
eystore
.pfx

encryptk
eypassw
ord

password of the encryptkeyfile. Only needed if encryptkeyfile is
password protected

O

encryptp
ublickeyf
ile

Name of the public key of the receiver. It has to correspond to the
name with which the key was imported. Used for encrypting the
message

M

CMS_p
ublicke
y.cer

keyalgori
thm

Symmetric key algorithm. The Possible values are AES128,, AES_256
or TRIPLE_DES. or cAST5.

M

TRIPLE
_DES

hashalgo
rithm

Possible values are SHA1, SHA256,. Only needed if signing is
required.

O

SHA1

addsigne
rcertifica
te

Adds signer certificate whilst encrypting. Default value is false

O

true

encoding

Possible values are PEM or BER.

M

PEM

compres
sionalgor
ithm

Possible values are ZIP, ZLIB and BZIP2. Only needed if compression
is required.

O

ZIP

transfor
mpdu

For outgoing FileAct XMLv2 messages, this property defines if the
XMLv2 PDU message has to be encrypted. Possible values are true or
false. The default value is true

O

true

Message management – 331

Trax – Bank Connector user guide

Property

Description

Mandator
y/
Optional

Examp
le

usetrans
formedp
ayload

For outgoing FileAct XMLv2 messages, this property defines if the
Filedigestvalue in the XMLv2 PDU message has to be calculated on
the encrypted Payload message or the original unencrypted payload.
Possible values are true or false. The default value is false.

O

false

• For decrypting incoming messages, add the following parameters to the sourceconnection-incoming
section of the of the [channel type]-config file for which CMS decryption has to be activated.

fileact:
default:
sourceconnection:
incoming:
preprocessor: "decrypt_CMS"
encryptkeyfile:
encryptkeypassword:
encryptpublickeyfile:

Propert
y

Description

Mandato
ry /
Optional

Examp
le

preproc
essor

Value has to be decrypt_CMS

M

decrypt
_CMS

encrypt
keyfile

Name of the private key used to sign the message. It has to
correspond to the name with which the key was imported. Used for
decrypting the message

M

CMS_k
eystore
.pfx

encrypt
keypass
word

password of the encryptkeyfile. Only needed if encryptkeyfile is
password protected

O

encrypt
publick
eyfile

Name of the public key of the receiver. It has to correspond to the
name with which the key was imported. Used for signer validation.

O

CMS_p
ublicke
y.cer

Message management – 332

Trax – Bank Connector user guide

14 Securing Bank Connector
14.1 Network and ports overview
The following ports are used by Bank Connector in the default setup.

14.2 Password encryption
Within the WildFly Application Server, the VaultTool is used for creating/using storage for passwords which
can be later used in WildFly configuration files in masked form. References to the passwords are used in the
standalone.xml instead of putting them in plain text.

standalone.xml extract

<vault>
<vault-option name="KEYSTORE_URL" value="C:\FIS\BankConnector/wildfly/
standalone/configuration/password-vault.jks"/>
<vault-option name="KEYSTORE_PASSWORD" value="MASK-1EM6MOZMX/5Y9G988Jo08g"/>

Securing Bank Connector – 333

Trax – Bank Connector user guide

<vault-option name="KEYSTORE_ALIAS" value="password-vault"/>
<vault-option name="SALT" value="DEADBEEF"/>
<vault-option name="ITERATION_COUNT" value="128"/>
<vault-option name="ENC_FILE_DIR" value="C:\FIS\BankConnector/wildfly/
standalone/vault/"/>
</vault>
<system-properties>
<property name="http.proxyHost" value=""/>
<property name="http.proxyPort" value=""/>
<property name="saml.keystore" value="C:\FIS\BankConnector/wildfly/modules/
com/scotty/scotty-gui/main/config/https.jks"/>
<property name="saml.keystorePass" value="${VAULT::Trax::ssoKeyPass::1}"/>
<property name="saml.secretKeyAlias" value="https"/>
<property name="saml.secretKeyPass" value="${VAULT::Trax::ssoAliasPass::1}"/>
</system-properties>

Passwords in the channel configuration yml files are AES encrypted. Passwords can be encrypted by using
the encryptPassword utility. This can be found in <Bank Connector install directory>/encryption-utils.
When specifying AES encrypted passwords in the channel configuration yml files, the format is "{AES}
<encrypted password>"

AES password in trax-config yml file

trax:
default:
outgoing:
actor: "TraxConsumerActor"
brokerUrl: "tcp://10.7.139.61:61617?sslEnabled=true&randomize=false"
uri: "JMS:trax.toTSGQueue"
responseprofile: "out_response_msgQueue"
truststore: "ar-truststore.jks"
truststorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
keystore: "ar-keystore.jks"
keystorepassword: "{AES}AhORpzYcQl2vAqB6GGWvIA=="
preprocessor: "decrypt_AES,unzip_GZIP"
encryptionmode: "AES/CBC/PKCS5PADDING"
encryptkeyfile: "trax.jceks"
encryptkeypassword: "{AES}wZFCf/Red7c4WAwIlp1Esw=="
validator: "validate_hash_sha1"
payloadhashkey: "TSGPayloadHash"
checkduplicate: "false"
type: "Trax-Out"

14.3 Encryption tool
WiP

Securing Bank Connector – 334

Trax – Bank Connector user guide

14.4 Securing connections
14.4.1 A few things about passwords
14.4.1.1 Password vault
A standard WildFly password vault is used to store the following passwords in WildFly's standalone.xml file:
the SAML keystore (ssoKeyPass)
<property name="saml.keystore" value="<Bank Connector install directory>/wildfly/modules/com/
scotty/scotty-gui/main/config/https.jks"/>
<property name="saml.keystorePass" value="${VAULT::Trax::ssoKeyPass::1}"/>
the SAML alias (ssoAliasPass)
<property name="saml.secretKeyAlias" value="https"/>
<property name="saml.secretKeyPass" value="${VAULT::Trax::ssoAliasPass::1}"/>
the HTTPS keystore and alias (httpsTCGKeypass)
<keystore path="https.jks" relative-to="jboss.server.config.dir" keystore-password="$
{VAULT::Trax::httpsTCGKeypass::1}"
the database user password (TCGDBPassword)
<password>${VAULT::Trax::TCGDBPassword::1}</password>

14.4.1.2 Password encryption (configuration files)
While it is possible to enter passwords in clear text in the configuration YAML files, you probably do not want
to do that (configuration files can be viewed in the GUI by users with the configurator profile). You can
encrypt any clear-text password with the encryptPassword utility, which is installed together with Bank
Connector in <Bank Connector install directory>/encryption-utils/. Such an AES-encrypted password can only
be decrypted by the Bank Connector application.
An encrypted password has an "{AES}" prefix, for example:
truststorepassword: '{AES}AhORpzYcQl2vAqB6GGWvIA=='
The key that encryptPassword uses to encrypt the passwords (and that Bank Connector uses to decrypt
them) is defined in <Bank Connector install directory>/wildfly/modules/com/scotty/scotty-web/main/
config/application.properties:
scotty.encryption.mode=AES/CBC/PKCS5PADDING
scotty.encryption.file=<Bank Connector install directory>/wildfly/modules/com/scotty/scotty-web/
main/config/scotty.jceks
The scotty.jceks keystore cannot be modified by a client (its password is not configurable). You can only
change its name and location.

Securing Bank Connector – 335

Trax – Bank Connector user guide

14.4.2 Database and file system (data at rest)
Every message or file Bank Connector receives is compressed and encrypted before it is stored in the
database, except when they are too big. Large files are not stored in the database, but they are compressed,
encrypted and then stored on the file system. The encryption for messages and files stored in the database
and on the file system is configured in <Bank Connector install directory>/wildfly/modules/com/scotty/
scotty-web/main/config/application.properties:
scotty.data.key.file=/opt/FIS/AGTCG/wildfly/modules/com/scotty/scotty-web/main/config/trax.jceks
scotty.data.encryption.mode=AES/CBC/PKCS5PADDING
scotty.data.key.pwd={AES}wZFCf/Red7c4WAwIlp1Esw==
Since the password for the trax.jceks keystore can be configured (scotty.data.key.pwd), the encryption key
for whatever is stored on the file system can be changed. (If the password is not configured, a default/
hardcoded password will be used.)
See Managing your own JKS keystores (see page 338) if you want to replace the default keystore with your own.

14.4.3 WildFly (GUI)
The HTTPS connection to Bank Connector's web interface is secured by the TLS certificate (currently
TLSv1.2) in the https.jks keystore, configured in <Bank Connector install directory>/wildfly/standalone/
configuration/standalone.xml:

<keystore path="https.jks" relative-to="jboss.server.config.dir" keystore-password="$
{VAULT::Trax::httpsTCGKeypass::1>

By default, the https.jks is stored in the same location (jboss.server.config.dir) as the standalone.xml file.
The password for the https.jks keystore is stored as "httpsTCGKeypass" in the password vault "Trax".
See Managing your own JKS keystores (see page 338) if you want to replace the default keystore with your own.

14.4.4 IdP/Identity Provider (SAML 2.0-based SSO)
The IdP needs to verify Bank Connector's identity when it redirects a user to the IdP to log in. By default, the
same TLS certificate is also in a https.jks keystore (same name and same content, but in a different
location), also configured in <Bank Connector install directory>/wildfly/standalone/configuration/
standalone.xml:

<system-properties>
<property name="saml.keystore" value="<Bank Connector install directory>/wildfly/
modules/com/scotty/scotty-gui/main/config/https.jks"/>
<property name="saml.keystorePass" value="${VAULT::Trax::ssoKeyPass::1}"/>
<property name="saml.secretKeyAlias" value="https"/>
<property name="saml.secretKeyPass" value="${VAULT::Trax::ssoAliasPass::1}"/>
</system-properties>

The passwords for both the SAML keystore and the alias are also stored in the password vault "Trax", as
"ssoKeyPass" and "ssoAliasPass" respectively.

Securing Bank Connector – 336

Trax – Bank Connector user guide

See Managing your own JKS keystores (see page 338) if you want to replace the default keystore with your own.

14.4.5 Artemis (Trax)
The communication between Bank Connector and Trax is handled by Artemis30 (Trax posts messages on
trax.toTSGQueue and consumes those on trax.fromTSGQueue; Bank Connector does the opposite). The
connection between Bank Connector and Artemis is secured by mTLS.

14.4.5.1 Bank Connector
On the Bank Connector side this is set up with:
ar-keystore.jks
Contains Bank Connector's private key (or potentially the complete) key pair.
ar-truststore.jks
Contains Artemis' public key.
A default version of both files is stored in the <Bank Connector install directory>/tenant-template/
TEMPLATES/KEYS/ folder (Windows example) during installation. When the system starts for the first time,
these files are read from the file system, loaded into the database, and ignored afterwards.
If you want to replace the default keys, you have to put them in a truststore/keystore, add those in a KEYS
folder to a configuration .zip file, and import them in the Configuration tab of the GUI. If the name of the
keystore and/or the truststore are different from the default, you also need to update the truststore, keystore
properties in the TRAX/trax-config file accordingly (and probably also the corresponding truststorepassword,
keystorepassword).

14.4.5.2 Artemis
Similarly, on the Artemis side the two files are:
amq-keystore.jks
Contains Artemis' private key
amq-truststore.jks
Contains Bank Connector's public key (and Trax' public key, for obvious reasons)
Both files are stored in /var/opt/artemis/broker/etc/ (Windows example).

14.4.6 IBM MQ (typically Swift FIN)
The communication between Bank Connector and IBM MQ, typically used for FIN traffic, is secured by mTLS.
On the Bank Connector side this is set up with:
• ibmmq-keystore.jks
Contains Bank Connector's private key (or potentially the complete) key pair.
• ibmmq-truststore.jks
Contains the SSB's IBM MQ server public key.

30 https://activemq.apache.org/components/artemis/

Securing Bank Connector – 337

Trax – Bank Connector user guide

A default version of both files is stored in the <Bank Connector install directory>/tenant-template/
TEMPLATES/KEYS/ folder (Windows example) during installation. When the system starts for the first time,
these files are read from the file system, loaded into the database, and ignored afterwards. The default
version of these files is not usable by clients, obviously.
When you want to replace the default keys, you have to put them in a truststore/keystore, add those in a
KEYS folder to a configuration .zip file, and import them in the Configuration tab of the GUI. If the name of the
keystore and/or the truststore are different from the default, you also need to update the truststore, keystore
properties in the FIN/fin-config file accordingly (and probably also the corresponding truststorepassword,
keystorepassword).

14.4.7 SFTP (typically Swift FileAct)
An SFTP connection relies on SSH, and this is managed on the server itself. Please see the Configuring
channels→SWIFT FIN and FileAct channel→File Transfer3132 section for details about how to refer to the
keys on the server in the connection uri. (Even more details: https://camel.apache.org/components/3.19.x/
sftp-component.html)

14.4.8 SOAP
SOAPHA is based on HTTPS, so the SSB's host requires a valid certificate. The LAU key is also used to open
the connection.

14.5 Managing your own JKS keystores
Bank Connector is shipped with several default keystores and truststores, but some clients may want to
replace the default setup with their own certificates. There are a lot of different tools available to create and
manage keystores (e.g. keytool is a command-line tool available on Windows and Linux), but we suggest to
use KeyStore Explorer. It can be downloaded from the KSE website: https://keystore-explorer.org/
downloads.html.
These pages describe some basic scenarios such as importing keys into a keystore, adding a public
certificate to a keystore...etc using KeyStore Explorer.
The steps for creating creating and saving a keystore described in <add link> are applicable for all scenarios.

14.5.1 Add a keypair
The https.jks keystore is used as an example, but the process for other keystores is very similar.

31 https://wiki.fisglobal.com/display/trax/File+Transfer
32 https://wiki.fisglobal.com/display/trax/File+Transfer

Securing Bank Connector – 338

Trax – Bank Connector user guide

When you open the application, you can create a new keystore.

While it is possible to use JCEKS instead of JKS, just like it is possible to name the keystore and
alias differently, you should be aware that this will require changes to the configuration. In this
document we describe the process to replace the keys in https.jks without having to change
anything in the configuration.

Securing Bank Connector – 339

Trax – Bank Connector user guide

Select the JKS type, click OK

... and you end up with an empty, unnamed and unprotected JKS keystore.

Securing Bank Connector – 340

Trax – Bank Connector user guide

Right-click in the window, click on Tools, or directly click on the password icon in the menu bar.

Securing Bank Connector – 341

Trax – Bank Connector user guide

... and set the password for the keystore.

Securing Bank Connector – 342

Trax – Bank Connector user guide

The keystore has a password, but it is still empty. Now add something to it.
Type Ctrl-T, use the Tools menu, right-click in the window again, or click on the corresponding icon in the
menu bar directly, then browse to the location where your key pair is stored, and click Open.

Securing Bank Connector – 343

Trax – Bank Connector user guide

Securing Bank Connector – 344

Trax – Bank Connector user guide

Enter the password used to decrypt the key pair, browse to and select the key pair file, and click Import.
This password needs to be identical to the keystore password you entered earlier.

Securing Bank Connector – 345

Trax – Bank Connector user guide

Step 5 - Enter the alias name:

Securing Bank Connector – 346

Trax – Bank Connector user guide

... and set its password.

Securing Bank Connector – 347

Trax – Bank Connector user guide

The keystore now contains a key pair.

Securing Bank Connector – 348

Trax – Bank Connector user guide

You still want to save the keystore.

Securing Bank Connector – 349

Trax – Bank Connector user guide

Save the keystore, and name it https.jks so you can keep the remainder of the configuration intact.

Securing Bank Connector – 350

Trax – Bank Connector user guide

14.5.2 Add a public certificate
After downloading the TLS/SSL, encryption and signing public certificate from the bank API portal, the
certificates have to be imported into a java keystore before being used in bank Connector.
You can add more than one public certificate to a truststore. You can reference the public certificate to use
in the Bank Connector configuration via the alias property.
Repeat below steps for each certificate that you want to add to the truststore
Right-click and select "Import Trusted Certificate"

Securing Bank Connector – 351

Trax – Bank Connector user guide

Add an alias to identify the certificate in the truststore. Use an alias name which ckearly identifies the use of
the certificate, such as signing or encryption.

Take not of the alias as you will need this during the configuration of the Bank API in Bank
Connector

Securing Bank Connector – 352

Trax – Bank Connector user guide

A popup is displayed showing the cetificate was imported.

Securing Bank Connector – 353

Trax – Bank Connector user guide

14.5.3 Add a TLS/SSL certificate
The TLS/SSL certificate that you receive from your IT department has to be stored into a java keystore before
it can be imported in bank Connector.
Most probably, the certificate will be delivered to you in a file with .pem extension, which is the most
common format to exchange certificates. The file will contain the private key and the certificate chain linked
to that private key.
To prepare the pem.format for use in Bank Connector, we have to
• convert the certificate from .pem to .p12 format, which is another format to store the private key and
certificates
• import the .p12 file into a java keystore
In below procedure we use the following tools
• openssl : OpenSSL is an open-source command line tool that is commonly used to generate private
keys, create CSRs, install your SSL/TLS certificate, and identify certificate information. You can
download it the latest Win64 full version on https://slproweb.com/products/Win32OpenSSL.html.
• KeyStore explorer to import the pkcs12 file into a java keystore.
Step -1 Open a command prompt and "cd" to the folder where you have stored the certificate .pem file

Securing Bank Connector – 354

Trax – Bank Connector user guide

> cd C:\Documents\SSLcertificate

Step - 2: Run the following command to convert the certificate file from .pem to .p12

> openssl pkcs12 -export -out pkcs12certificatename.p12 -in pemcertificatename.pem

You will be requested enter the password of the .pem certificate and to enter a new password for the pkcs12
certificate that will be created

> openssl pkcs12 -export -out pkcs12certificatename.p12 -in pemcertificatename.pem
Enter pass phrase for pemcertificatename:
Enter Export Password:
Verifying - Enter Export Password:

Take note of the new password as you will need this during the configuration of the Bank API in
Bank Connector

Step-2 Open KeyStore Explorer and follow step 1 to 3 from Create a private key and generate certificate
signing request (csr)3334 to create the keystore.
Step-3: Right-click and select Import Key Pair.

33 https://wiki.fisglobal.com/pages/viewpage.action?pageId=10541020152
34 https://wiki.fisglobal.com/pages/viewpage.action?pageId=10541020152

Securing Bank Connector – 355

Trax – Bank Connector user guide

Step-4 Select as type PKCS12

Securing Bank Connector – 356

Trax – Bank Connector user guide

Step-5: Import the keypair
The Decryption Password is the password that you have given to the pkcs12 file in step-2
Browse to the location where the pkcs12 file is stored and select Import

Securing Bank Connector – 357

Trax – Bank Connector user guide

Step-6 Enter an alias for the keypair

Take note of the alias name as you will need this during the configuration of the Bank API in
Bank Connector

Securing Bank Connector – 358

Trax – Bank Connector user guide

step-7 Enter a keypair password

Make sure you use the same password as the one that you have given to the keystore in step-2

Securing Bank Connector – 359

Trax – Bank Connector user guide

A popup is displayed showing that the keypair was imported.

Securing Bank Connector – 360

Trax – Bank Connector user guide

14.5.4 Create a private key and generate certificate signing request (csr)

Securing Bank Connector – 361

Trax – Bank Connector user guide

15 System Monitoring
15.1 Logging
Bank Connector stores important system events, channel events and message events in log files in the
<Bank Connector install directory>\wildfly\standalone\log directory.
The following Bank Connector log files are available:

log name

Content

bankconnector-server-log-plain

reports Bank Connector server related information in
plain text format

bankconnector-server-log-json

reports Bank Connector server related information in
JSON format

bankconnector-integration

reports channel and message related information

bankconnector-saa-transmission

reports specific SWIFT SOAPHA connection method
related information

bankconnector-scheduler-activity

reports scheduler related information

gui-saml2

reports SAML2 authentication and authorization
information

Logs are also available via the GUI. The profile 'logs' is required to have access to the logs via the Bank
Connector GUI. Go to Logs and click on an entry in the list to have a full description of the warning or error.
From the GUI, the logs can be downloaded as well by clicking the download icon.

System Monitoring – 362

Trax – Bank Connector user guide

15.2 Event alerting
For certain channel and message related events, it is possible to receive alerts by e-mail as well. Currently,
this functionality is limited to connection related issues.
Alerts expected as per their level are:
• Error : endpoint/channel connection related errors
• Warn: soap - saa connection error
• Info: soap connection related errors
Alert mail description specifies the probable cause for the connection issue, which can be looked up in the
exported logs in detail.

15.2.1 Configuration of e-mail alerting
The e-mail alerting is set up in the SYSTEMEVENT channel.
1. Export the latest configuration
2. Unzip the downloaded archive.
3. Add a folder "SYSTEMEVENT" and create in that folder the files alert-subscriptions.yml and
targetconnection-outgoing.yml.

TEMPLATES

System Monitoring – 363

Trax – Bank Connector user guide

|
|___ FILEACT
|
|
|
| fileact-config
|
| fileact-profile
|
| fileact-route-config
|
|__ FILESYSTEM
|
|
|
| filesystem-config
|
|__ FIN
|
|
|
| fin-config
|
| fin-profile
|
| fin-route-config
|
|__ TRAX
|
|
|
| trax-config
|
|__ SYSTEMEVENT
|
|
|
| alert-subscriptions
|
| targetconnection-outgoing
|

• Set up the alert-subscriptions.yml and targetconnection-outgoing.yml file according to the examples.
• Compress the channel folder structure again, and import the configuration.

System Monitoring – 364

Trax – Bank Connector user guide

1. Go to Channels and restart the SYSTEMEVENT channel.

15.2.2 alert-subscriptions.yml
Through the alert subscriptions you determine for which level events have to sent. Possible values are : warn,
error, info or all. With the timeframe property, toy can define the amount of time expressed in milliseconds
between the sending of alert emails for the same event.

alert:
subscriptions:
- subscription:
# info, warn and error events will be sent
level: all
profile: alert_all
- subscription:
# only warn and error events will be sent
level: warn,error
profile: alert_warn_error

15.2.3 targetconnection-outgoing.yml
The targetconnection-outgoing file specifies the mailserver connection details and the TO and FROM users.

targetconnection:

System Monitoring – 365

Trax – Bank Connector user guide

- outgoing:
profile: alert_all
uri: smtp://<smtpserver>:<port>
actor: MailProducerActor
emailto: <addressees>
emailfrom: <sender>
- outgoing:
profile: alert_warn_error
uri: smtp://<smtpserver>:<port>
actor: MailProducerActor
emailto: <addressees>
emailfrom: <sender>

Property

Description

Mandatory
/ Optional

profile

Must correspond to a profile set up in the alert-subscriptions file. The
profile determines which events will be sent.

M

uri

The structure is

M

smtp://<ip address or DNS host name of mail server>:<listener
port>
actor

for sending e-mail alerts, the actor has to be MailProducerActor

M

emailto

comma separated list of e-mail addresses

M

emailfrom

Specifies the From email address to use. The SMTP server however,
decides to use it or not. Many SMTP server enforce the email address
that is associated with the user that connects to the mail server.

M

System Monitoring – 366

Trax – Bank Connector user guide

16 Audit logs
Bank Connector features an audit log that tracks users' access to the application and their actions.
The audit log is accessible via the gui via the Activity logs screen. The activity log search result set can be
downloaded to a CSV-formatted file by clicking the download button.
Combining the search criteria with a date range search is also possible.

The following data will be logged:

timestamp

date and time of the user action

IDP

Identity Provider through which the user accessed Bank Connector

User

User name

Action

Description of the action such as importing or exporting channel
configuration

Profile

The profiles assigned to the user in the IDP

Parameter

Additional action information

Audit logs – 367

Trax – Bank Connector user guide

17 Application Properties
Users with the "system" profile can access the application properties in the GUI. Via the export and choose
file buttons, the application properties can be updated and imported again. Unlike for channel configuration,
the updated application.properties file only needs to contain the modified application properties.

The export will download an application.properties file containing all properies in key-value syntax and the
date and time when the export was done.

Application Properties – 368

Trax – Bank Connector user guide

More information on the different application properties can be found in the relevant section of the user
guide.
A service restart is required to activate the new settings.
Changes to the application properties are recorded in the activity log.

Application Properties – 369

Trax – Bank Connector user guide

18 Bank Connector change log
18.1 Summary v2.52.0
2025-04-25
• The value of the filename property introduced in v2.46.0 will now also be used for
the encryptfilename property introduced in v2.36.0 for PGP encrypted files. (This should not break
existing configurations: if no filename is defined, the encrypfilename value will still be used; if both
are defined, filename overrides encryptfilename. In other words, the encryptfilename property is still
supported for compatibilty, but will be replaced by filename, )
• For complex EBICS setups, you can now search in both the bank server list and the scheduled job list.
• Another GUI improvement: instead of cutting values to narrow column sizes even when those
columns are wide enough, we now try to display as much as possible.
• We fixed a defect that prevented the FIN channel from starting automatically after a pod restart, and
even if nobody ever noticed because you had to look at the User Activity log, but some actions in the
GUI were triggered twice. No more.

18.2 Summary v2.51.0
2025-04-04
• Intermediate release to fix an issue related to the DateTime format of the BAH creation date in Swift
SCOREPlus which was based on the server's time format. A new application
property finplus.bah.timezone can set the DateTime format. The default value is CET.

18.3 Summary v2.50.0
2025-03-28
• As a first step in our evolution towards a SaaS offering, Bank Connector pods can now be deployed
with a serverrole environment variable that can have two values: worker or scheduler (the default
value). A pod with the scheduler role will behave exactly the same way as a Bank Connector pod
today, while a worker will not run the scheduled jobs related to housekeeping, etc. (Two pods running
those scheduled jobs would constantly run into conflicts.)
• From a Helm perspective, the default deployment will have bank-connector.replicas "1", and when
multiple instances of Bank Connector are needed, one instance will get the serverrole scheduler, and
any others will be workers.
• The certificateserialnumber added in v2.49.0 to support multiple certificates on the same 3SKey
token is now also displayed in the User table in the EBICS user interface.
• Also in EBICS, scheduled HAC jobs will now only download the delta instead of the data for the full
day.

Bank Connector change log – 370

Trax – Bank Connector user guide

• We upgraded to Angular v17, resulting in a few cosmetic changes.
• Bug fixed: when using PostgreSQL, sometimes responses were linked with the incoming message
instead of the outgoing one.
• There was no impact because of the Apache Camel Case vulnerability CVE-2025-27636, but we
upgraded to Camel v3.22.4 anyway.

18.4 Summary v2.49.0
2025-03-04
• Sometimes (often after the go-live or a maintenance window) incoming messages cannot be sent to
the backend system, for instance because the TRAX channel was not started. These failed messages
will have a Retry button, that allows a user with the operator profile to send that message again.
(What if there were a shipload of messages waiting when the incident occurred? Bad luck, because
you will have to select each and every one of those 179 incoming statements and click that Retry
button.) This release offers a Retry All button that will perform this action for you on all messages in
the current search result.
• The privatekey property for SFTP connections was already supported since v2.32.0, but you still had
to add the privateKeyPassphrase as a Camel parameter in the uri. From now on, you can (AESencrypt and) store it in the privatekeypassphrase property instead. (The Camel parameter still works
as well.)
• Users with the audit profile can now search for a date range in the Activity Log. (Downloading the
activity log was already possible since v.2.46.0.)
• (Almost) finalising the implementation of 3SKey signing for EBICS, we have added a
property certificateserialnumber to the EBICS user definition. (A 3SKey token can contain more than
1 certificate. The request message for exchanging the certificate with Bank Connector contains not
only the token serial number but also the certificate serial number. This will allow us to link an EBICS
user to a token/certificate combination.)
• (This was already patched in v2.48.1, but) when sending several large files (e.g. 4x 500 MB) there is a
possibility that Bank Connector has insufficient memory available. This release has two changes: the
Xmx (maximum memory allocation pool) has been increased from 2GB to 5GB (this can be set at
install time on VMs, but defaulted to 2GB in K8s), and the decompression of large files (whenever
the .zip > 1MB) occurs on disk instead of in memory.

18.5 Summary v2.48.1
2025-02-19
• Patch release to fix an issue for K8s deployments: when sending several large files (e.g. 4x 500 MB)
there is a possibility that Bank Connector has insufficient memory available. This release has two
changes: the Xmx (maximum memory allocation pool) has been increased from 2GB to 5GB (this can
be set at install time on VMs, but defaulted to 2GB in K8s), and the decompression of large files
(whenever the .zip > 1MB) occurs on disk instead of in memory.

Bank Connector change log – 371

Trax – Bank Connector user guide

18.6 Summary v2.48.0
2025-02-12
• Our EBICS 3.0 implementation now also supports the concept of a technical user (sometimes called
"transport user"), who can submit files (signed by one or more signing users) with a transport
signature. Technical users can only send files, they cannot sign payments, but they can be used both
in an unattended and attended signing setup.
• The 3SKey support for EBICS is now complete, since there are alternatives for the usual lock
keys and change keys buttons. Just delete the keys, and you can initialize the user again.
• Our bank API implementations now support passing of variables (e.g. a requestId that was the result
of an earlier API call) that can be used as a header parameter (e.g. to get a status for that earlier
request).
• Rejoice! An annoying corner case has been taken care of: from now on, in a Camel uri your
unencrypted password can contain an ampersand. Even multiple ampersands!
• An old corner case (but popular in the initial phase of a project): you can now retry a message that is
in a Channel timeout state (because the TRAX channel was inactive or incrrectly configured, or
because of a "missing route"). About that "Missing route" state, when a message cannot be sent
because the target channel is not running will now be FAILED instead.
•
There was a flaw in the refactoring of v2.45.0 (replacing Akka with Spring Boot) related to
multithreading, causing a performance issue that involved significant delays when downloading ACKs
etc. for higher volumes of outgoing payments.

18.7 Summary v2.47.0
2025-01-20
• Limited intermediate release: despite there no longer being a difference in EBICS 3.0 between DE and
FR, French banks and corporates have agreed to support an additional (non-standard) tag in a BTU
request, that allows to send messages in TEST mode in a production environment. (DE clients use
penny tests.)

18.8 Summary v2.46.0
2024-12-31
• In this release, we added more configuration options for setting the outgoing filename when having a
H2H connection with the bank. It is even possible now to have the filename determined in Trax,
similar to what we already support for the FileAct FileLogicalname.
• Again to further support the H2H connections with banks, you can choose which reference you would
like to see as source reference by adding the sourcereferenceproperty to the incoming target
connection. By default, we will show the incoming filename. This filename will also be forwarded to
Trax and is visible as E2E reference.

Bank Connector change log – 372

Trax – Bank Connector user guide

• We extended our BOFA API coverage so that you can now exchange pain.001.001.03 SEPA
payments over API.
• For audit purposes, it can be useful to have a monthly or quarterly report on the different actions that
users have performed, such as importing or exporting channel configuration or retrying messages.
So the activity log screen now has a download button that will export the search results to a CSV
file.
• Also the search results in the messages screen can be downloaded to a CSV file.
• In our previous release we added user key management in the context of EBICS 3SKey token support.
Now it is also possible to sign payments using the 3SKey token. With this, the full functionality is
covered.

18.9 Summary v2.45.0
2024-12-04
• This version contains two major technical updates:
1. We replaced the Akka framework with Spring boot.
2. For the user interface, Node.js 16 version is now replaced with Node.js 18, along with
that Angular version has been upgraded to 15 and RUF version upgraded to 5.9 with enhanced user
experience.
• We started extending our EBICS functionality so that payments can be signed using 3SKey tokens,
this version contains the EBICS user key management.
• Till now, when doing host to host connections with the banks, it was not possible to search on the
filename which made it difficult to troubleshoot the issues, now we show the outgoing filename as
targetreference and you can do a search on it as well.
• Pre-configured channel configurations templates and keys by default that were part of the
installation package are removed, so that Bank Connector starts with a clean environment and
without unnecessary error logs.
• While exporting the configuration we added a file to the zip which contains the Bank Connector
server and GUI version. This will help to keep track of which configuration was/is running in which
version, at the same time eliminating the need to specify Bank Connector version in the support
ticket, it would be by default present in the configuration zip file.
• We fixed a defect for host to host connections with the banks, so that the filename does not get
overwritten when we have to retry sending the message.
• We had to upgrade Spring to the latest version: 5.3.39 and spring-security-web to 5.7.13 because
of because of a35 security finding.

18.10 Summary v2.44.0
2024-10-30

35 https://fis.cxone.cloud/sca/#/appsec-knowledge-center/vulnerability/riskId/CVE-2024-47554

Bank Connector change log – 373

Trax – Bank Connector user guide

• Small release that adds support in EBICS for additional parameters in the BTF map (msgversion,
msgvariant, and msgformat) for the BTD order types (e.g. to fetch CAMT053 statements). Previously
these were only used in BTU outgoing messages.
• We fixed a defect for a previously unencountered situation where the client has multiple SOAP
connections for FileAct (for different BICs).
•
Another defect (a custom location for log files being overwritten by the default during an upgrade)
could only be fixed in an inconvenient way, by not overwriting the Log4j configuration files. This
means that future changes made by the development team to the Log4j configuration may have to
be taken care of manually when you are still deploying on a VM.
• We also had to upgrade Spring to v5.3.39 because of a36 security finding.

18.11 Summary v2.43.0
2024-10-15
• Intermediate release to add support for the bank API aggregator offered by Necto37.
• We also had to upgrade commons-io to v2.17.0 because of CVE-2024-4755438

18.12 Summary v2.42.0
2024-10-09
•

•

•
•
•

Exceptionally, a defect to start with: due to a regression bug introduced in v2.36.0 that went
undetected until very recently (which makes us believe that it does not seem to occur very
frequently), there is a potential deadlock issue with all Bank Connector versions since (v.36, 37, 48,
39, 40 and 41), but it is now fixed. (For the tech inclined: it could occur during the duplicate check
process, and we added an index to fix it.)
Bank Connector now supports the statement download bank API for Citi. It is a typical dual-phase
protocol: the initial request results in a response that contains a key to decrypt the actual statement
downloaded in the second phase.
Also API-related: Bank Connector supports the Swift GPI g4C API.
We refactored the response profile configuration (you can now define different response
subscriptions per targetconnection-outgoing instead of per sourceconnection-outgoing).
As usual, we fixed a few bugs and vulnerabilities.

18.13 Summary v2.41.0
2024-09-02

36 https://fis.cxone.cloud/sca/#/appsec-knowledge-center/vulnerability/riskId/CVE-2024-47554
37 https://necto-api.com/
38 https://fis.cxone.cloud/sca/#/appsec-knowledge-center/vulnerability/riskId/CVE-2024-47554

Bank Connector change log – 374

Trax – Bank Connector user guide

• With sourcereferenceproperty (or referenceproperty, if you already have that in your configuration)
and targetreferenceproperty you can determine which source and target reference you see in the GUI
for FileAct, FINPlus and FIN. The corresponding values are always sent to Trax over JMS.
• Besides FINPlus (for financial institutions) we also support SCOREPlus (for corporates: SCORE
stands for Standardised Corporate Environment).
• It is no longer possible to mess with the "version" application property by importing application
properties that were exported from another version.
• A connection to an EBICS bank server will now fail without a valid TLS certificate.
• We also extended and improved logging for EBICS.
• Two major bugs were also fixed: the state reason for a bank API is now correctly set according to the
response code we receive, and the SFTP retry mechanism for PDUs works again, in those really
unreliable network conditions.

18.14 Summary v2.40.0
2024-07-26
• Previously, when Bank Connector received a FIN message containing the FIN header, it would
automatically add a tag 108 to it, containing the Message User Reference (MUR) if this tag was not
present. From v2.31.3 on, the MUR was no longer added. As in some cases the MUR is still required
for reconciliation purposes, we have now added the option of adding a MUR explicitly with the
property generatemur.
• For FileAct it was already possible to decide which source and target reference you wanted to see in
the GUI. These values can be chosen from a list of references in the XMLv2 PDU. We have now
extended this functionality to FINPlus as well, by defining
a sourcereferenceproperty and targetreferenceproperty.
• When you have a large number of EBICS customers and users, the setup in Bank Connector can
become quite overwhelming. In order to simmplify the configuration, we have now introduced
an EBICS default profile. When Bank Connector receives the EBICS customer id and order type from
the backend application, it will deduct the profile from it and route the message to the correct bank.
This way, instead of having to create hundreds of profiles, you only need to set up a few in Bank
Connector.
• In some cases, users only need to access Bank Connector to perform a specific action, such as for
EBICS triggering a job for fetching the account statements manually. For these users we have created
a specific user profile ebicslimitedaccess that will only show the EBICS scheduled jobs in the GUI
from where manual run now actions can be triggered.
• In this release we also fixed an issue in our cloud K8S upgrades. It is now also possible to upgrade
Bank Connector Kubernetes deployments older older than 2.32.0 to the latest version.

18.15 Summary v2.39.0
2024-07-04

Bank Connector change log – 375

Trax – Bank Connector user guide

• The referenceproperty property already allowed you to specify which reference or tag (listed
in Message monitoring) from the XMLv2 PDU of an incoming FileAct message should be used as
source reference, but this has now been extended to the target reference.
Both sourcereferenceproperty and targetreferenceproperty support the same
values: senderreference, userreference, filelogicalname, snlref, reference, transferref,
storedtransferref, filename. If your configuration already sets the referenceproperty (instead of
sourcereferenceproperty), it continues to work the same way.
• Both source reference and target reference are sent to Trax as JMS parameters (in
TSGSourceReference and TSGSwiftReference, respectively).
• Keys and certificates can now be stored as secrets in HashiCorp Vault.
It is not possible yet to
combine this with the current solution: uploading them in a KEYS folder in a configuration .zip, which
will store them in the database. (In a future release, a reference to a secret will be searched first in
the vault, and subsequently in the database.)
• Some clients have hundreds of them, and now we can import EBICS user certificates (for
authentication, signature and encryption) along with their status and required details exported from
TRAX.
• We had to update Bouncy Castle to v1.78.1 because of a few vulnerabilities.
• We also ironed out quite a few imperfections related to Swift FileAct, EBICS and the GUI.

18.16 Summary v2.38.0
2024-06-06
• Improved and extended data purging: FINplus and EBICS messages, payload data will no longer be
kept forever.
• The payload of outgoing confidential payments was already obfuscated, but from now on you will no
longer be able to see incoming messages marked as "Confidential" either.
• We did this specifically for the US Bank current day transactions API, but also usable for other cases:
Bank Connector can extract metadata from a JSON request and use that as a parameter in an API
call.
• For EBICS the user key length is configurable, and the user key passwords can be encrypted.
• We also fixed a few more or less minor bugs, and one was major, no more no less: upgrading to v2.37
in K8s could wipe the database. Oops.

18.17 Summary v2.37.0
2024-05-03
• Spinning up a container will now trigger database upgrade scripts if the version of the application is
higher than the version of the database.
• Black Duck alerted us about a vulnerability, so we had to upgrade Spring to 5.3.33.

Bank Connector change log – 376

Trax – Bank Connector user guide

18.18 Summary v2.36.0
2024-04-30
• Bank Connector supports Postgres too.
• FINplus over SOAP is now fully supported: if you want, you can still send the full PDU (including the
business application header) to the backend system, but the default is includebahinmessage=false,
which only sends the <document> part.
• In EBICS the new unzip parameter (default false) in ebics-btfmap.yml now allows the unzipping of
zipped incoming messages in EBICS before they are sent to Trax.
• Activating alerts on channel connections can trigger a large number of events 'or even notification emails) in a short time period. The new timeframe parameter (default 300, or 5 minutes) in alertsubscriptions.yml allows you to configure how long we should wait before alerting you of an event of
the same type.
• When using PGP encryption in a connection to the backend system, you can now add variables (like a
timestamp and/or a sequence) to the PGP encryptfilename, and the filename before and after
encryption will be identical.

18.19 Summary v2.35.0
2024-03-21
• Patch release to correct a Black Duck vulnerability related to Spring Security
(BDSA-2024-0647, CVE-2024-22257) that suddenly appeared hours after we released v2.34.0.

18.20 Summary v2.34.0
2024-03-20
• Patch release to fix an issue with the release number written to the database (instead of to
application.properties before) during installation. Once on v2.32, always on v2.32, forever young!
• When we patch, we patch: we now also correctly convert the output from the EBICS date picker when
using the "run now" button in scheduled jobs.

18.21 Summary v2.33.0
2024-03-08
• Clients using EBICS can now change user keys, create users with the same user ID in different
customer profiles, and split incoming XML files.
• When (instead of Trax) we connect to SAP (or certain other backend systems) we can now parse the
PDU generated by that system, determine the route with it, and send the message over SOAP to the
SAA.
• We also made the payload filename configurable for incoming FileAct messages.

Bank Connector change log – 377

Trax – Bank Connector user guide

• We got rid of the ugly isproducepduforrequest parameter, and replaced it by pdutargetprofile, which
sounds nicer and is a lot more practical.
• A few bug fixes worth mentioning: skipheadergeneration no longer removes tags in FIN block 3, and
the targetprotocol parameter in the Trax subscriptions now works correctly.
• We upgraded Spring to v5.3.27.

18.22 Summary v2.32.0
2024-02-02
• This is the first release of 2024, and it is fat one. (We had 22 releases last year but skipped the end of
December.)
• EBICS users can now send payments using attended signing, lock users, and receive messages with
multiple files, splitting them before sending them to Trax.
• Managing application.properties on the file system in a container is... challenging, so we made it a
little easier. A user with the (newly created) system profile assigned in the IdP will find a new
Application Properties tab in the GUI that allows them to see all properties and their values, but also
to export all property/value pairs and import new properties or modified values. (This works similarly
to the Configuration tab, but here you can upload a .property file with only one property/value pair,
instead of having to import all of them.)
The existing application.properties file will be read at first, but whatever is in that file afterwards
(including any changes) will be overwritten by the values in the database.
All activity related to application properties is logged in the User Activity tab, including which
properties were added and which values were changed.
• Also useful in K8s installations when you need SFTP connections: a new privatekey property allows
you to refer to a previously uploaded SSH key (replacing the privatekeyfile property that expects a
path to a file on the file system). The privateKeyPassphrase Camel parameter in the URI continues to
be used, and should be AES encrypted, obviously.
• Bank Connector never handles node compression, but with the new property nodecompression you
can set a comma-separated list of requesttypes for which the payload of incoming FileAct messages
should not be decompressed before it is sent to the backend system.
• Bank API connections now also benefit from the additional timeout (mitigating a flaw in Apache
HttpClient) that we added for SOAP in v2.31.1.
• As usual, we fixed a few defects related to logging, but also several more annoying ones: using an
incorrect referenceproperty, not supporting the source parameter with a SENT filter in a TRAX
subscription for a H2H connection, and another XML parsing issue with incoming messages that
were converted by Swift from FINplus.
• Some people will be relieved now that we have finally removed that impossible space at position
40 in long values in the Header section of the GUI.
• Finally, we have gotten rid of a few ("Low" but overdue) security vulnerabilities, findings that came out
of our last penetration test.

Bank Connector change log – 378

Trax – Bank Connector user guide

18.23 Summary v2.31.2
2024-02-02
• We "never release patches" until we do it a second time...
• Patch release to fix another bug (we fixed an earlier one in v2.26.0) related to Swift's conversion of
incoming FINplus messages. (This fix is also part of v2.32.0.)

18.24 Summary v2.31.1
2023-12-22
• We "never release patches" until we do...
• Patch release to mitigate a flaw in the Apache HttpClient library (https://bugs.openjdk.org/browse/
JDK-8258397) that has been causing issues with SOAP since we upgraded that library in v2.22. We
continuously send requests to the SAA to retrieve incoming messages, and when something happens
on the network, we sometimes receive only the header of the response without the body, and things
start going awry from there. We now have our own timeout mechanism for these requests.

18.25 Summary v2.31.0
2023-12-12
• A minor release, but with many separate results.
• For FIN/FINplus in XMLv2 over SFTP, when we receive multiple PDUs in one file we split them into
separate messages, shown individually in the GUI.
• Likewise for multiple FIN messages in RJE separated by $.
• For EBICS, when we receive multiple files in one .zip we unzip them and treat them as separate
messages sent to Trax. (Make sure to set the container: "ZIP" property in ebics-btfmap.yml.)
• EBICS users are people too, and from this version on they can see a Source Reference and a Target
Reference in the GUI.
• Sometimes a message fails during reconciliation, and then an 'Internal server error' pops up (because
the message is not saved, so it cannot be opened). We do not like internal server errors, so we fixed
this.

18.26 Summary v2.30.0
2023-12-01
• We already did this for FileAct in v2.22.0, but the source reference is now configurable for FIN
messages too. Similar logic, same property referenceproperty in the sourceconnection:incoming part
of fin-config.yml. Accepted values are (case-insensitive): uetr, mur, mir, E2ETransactionReference,

Bank Connector change log – 379

Trax – Bank Connector user guide

•
•

•
•

•
•

userreference, and senderreference. (Note that E2ETransactionReference does not exist in XMLv2 rev
2.0.2.)
We now support FINplus over SOAP too (but only outgoing, incoming will be covered in a later
release).
Some banks (can only) use the filelogicalname in their processing (every payment file has the same
name), and we typically use that as the actual filename too. When using SFTP for FileAct, a payment
file can potentially overwrite a previous one to the same bank. In such a situation you can now set the
new property usefilelogicalname to false (the default is true, obviously).
We have never really had to support FIN over RJE (AFT) before, but we do now.
We have been receiving reports about a SOAP issue in TEST environments where we suddenly stop
receiving responses and incoming messages, Thanks to the additional logging in v2.28.0 we were
able to make Bank Connector more resilient. We still do not know why this issue occurs, but we will
now recover from it.
If you increased the log level in v2.28.0 or v2.29.0, now is a good time to
reduce it again.
We fixed the alert notifications we broke in v2.28.0, we got rid of an annoying endless loop triggered
by incorrect FINplus configuration, we fixed a few other defects, and our logs look a little better too.
Spring Boot was upgraded to v2.7.18.

18.27 Summary v2.29.0
2023-11-14
• Patch release to fix a bug introduced in v2.26.0 (but undetected until recently because most clients
do not use the referenceproperty property properly), but we thought it was annoying enough to fix it
immediately. When using SOAP the incoming PDU was accidentally rewritten, losing
transferref and storedtransferref in the process.
• We also fixed a bug related to incoming GZipped statements when Artemis is not running (do not try
this at home): now you can Retry them successfully afterwards.
• [Copied from v2.28.0 but still relevant] To be able to investigate a mysterious SOAP issue that only
occurs in TEST (before you ask; no, never in PROD), we added the possibility to add more details to
the relevant logs if you increase the log level for the SOAP connector (see below for details).

18.28 Summary v2.28.0
2023-11-01
We introduced a regression bug in v2.26.0 that blocks the client from using certain tags in the PDU when
using SOAP. They should use at least v2.29.0.
• We did it for FileAct a while ago, but we FINally upgraded the XMLv2 revision to 2.0.14 for FIN too.
• For a client sending and receiving FINplus messages with Quantum (which is unable to send us
metadata like senderdn, receiverdn or requesttype via JMS parameters over the filesystem) a
preprocessor can now extract even more tags from an XML payload (on top of the receiverdn added
in v2.26.039 we now also extract senderdn and requesttype), and even use those via one profile to rule
39 https://wiki.fisglobal.com/display/trax/Bank+Connector+v2-26-0

Bank Connector change log – 380

Trax – Bank Connector user guide

•

•
•
•

•

them all to generate profiles dynamically, effectively avoiding the need of maintaining many hundreds
of almost but not quite identical profiles determined by countless combinations of senderdn,
receiverdn, and requesttype.
In our GUI we improved the Channels tab: it now shows each channel's start/stop time instead of
when the last relevant configuration change occurred, and we also fixed a defect that incorrectly
displayed multiple PDU entries.
Black Duck reported and we fixed several vulnerabilities, this time in Apache ActiveMQ, Dom4j, Netty
(2x), and Apache Santuario.
We discovered two defects resulting in out-of-memory situations and managed to fix both of them in
this release.
We corrected our retry mechanism after certain failures (yes, we fixed a bug), we improved the way
we handle Channel Failed messages for FIN (MQ or AFT; they now go to FAILED when they should).
We keep struggling with the tcg.safemode setting and with the Java options in WildFly
when upgrading.
To be able to investigate a mysterious SOAP issue that only occurs in TEST (before you ask; no,
never in PROD), we added the possibility to add more details to the relevant logs if you increase the
log level for the SOAP connector (see below for details).

18.29 Summary v2.27.0
2023-10-02
We introduced a regression bug in v2.26.0 that blocks the client from using certain tags in the PDU when
using SOAP. They should use at least v2.29.0.
• Patch release to fix an exotic bug when the optional isPossibleDuplicate tag is not in the PDU. It
was always there in our experience, until today.
• In the meantime we also fixed a bug in the installer: you can no longer fool it by providing invalid
database credentials.

18.30 Summary v2.26.0
2023-09-27

We introduced a regression bug in v2.26.0 that blocks the client from using certain tags in the PDU
when using SOAP. They should use at least v2.29.0.
• From Trax v7.17 the EBICS signers will be sent to Bank Connector as JMS parameters for attended
signing. Now we have also a property linkedtraxusers on our side to link the Trax users who sign to
EBICS users, and verify them.
• We implemented a new targetconnection:incoming property targetprotocol to allow you to set up
EBICS 3.0 with versions of Trax prior to v7.12 (the value should be "Swift-FileAct").
• When receiving payments (from Quantum) over the filesystem, no metadata is passed via JMS
parameters, so we now have a preprocessor to extract tags from an XML payload and use them to
determine the target profile, starting with the receiverdn.

Bank Connector change log – 381

Trax – Bank Connector user guide

• If you send messages to the SAA over SFTP without the binary prefix for the LAU, it expects an XML
declaration ("<?xml version="1.0" encoding="UTF-8" ?>"). Bug fixed.
• Incoming FINplus messages converted by Swift sometimes (when something goes wrong) contain
a TranslationResultDetailed section that looks like XML, so Bank Connector tries to parse and
validate the information, which fails. We now ignore that section.
• When using specific names for TRAX and FILESYSTEM channels (because there are multiple, for
instance), the message details will now display the correct channel name.
• We no longer reset tcg.safemode to true in application.properties during an upgrade.
• We had to update Spring Security (now v5.7.11) because of a Low security risk reported by Black
Duck.

18.31 Summary v2.25.0
2023-09-04
• Minor version to support XMLv2 revision 14 (and higher) for a client working with Swift Alliance
Cloud (which supports revisions 9, 10, 12 and 14, but not 13). From now on --and until some change
in the XSD impacts the tags we set and read in the PDU-- the xmlv2revision property (see Local
Authentication and LAU key (see page 200)) will be either set to 2.0.2 or to something else. For instance,
if you have "2.0.13" in your configuration, we will override that with 2.0.14 (later: or higher) in the files
we generate, because those revisions are backward compatible for our application anyway.
• We corrected a few things in our upgrade process. Since we upgraded a few HTTP-related Apache
libraries in v2.22.0, the Java settings in WildFly required a parameter to be added manually. Fixed in
this version.
• Another upgrade bug, related to FINplus tables in the database was fixed too.

18.32 Summary v2.24.0
2023-08-17
• Minor version for an improvement when using a file-based connection to a backend system to send
FileAct messages. If the backend system uses the filename to pass metadata to the bank, you can
now keep the original filename instead of letting Bank Connector generate a unique one by adding
the property useoriginalfilename to true in fileact-config.yml. ( In this setup uniqueness must be
handled by the backend system.)
• We extended FINplus support with a few corner cases. With skipbahgeneration: "true" in finplusconfig.yml, Bank Connector will use the Business Application Header in the payload of outgoing
messages instead of generating it, and similarly includebahinmessage= "true" will not strip the BAH
from incoming messages, and send the full MX message to the target channel.
• A small step, but a giant leap over a functional gap: users can now find specific messages with
a search on direction (in, incoming, out, outgoing) and or on the channel name (e.g. FIN-EMEA,
FILEACT, etc.).
• We also made a change to the Trax code (TRAX-21288) to support EBICS 3.0 attended signing: from
Trax v7.17 the EBICS signers will be sent as JMS parameters to Bank Connector.
• A few minor bugs were fixed.

Bank Connector change log – 382

Trax – Bank Connector user guide

• WARNING: after the upgrade of the JSch library, some SFTP connections will no longer work without
an additional Camel parameter:
→ add "&serverHostKeys=ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2nistp521,rsa-sha2-512,rsa-sha2-256,ssh-rsa" to the uri.

18.33 Summary v2.23.0
2023-10-02
• Bank Connector now supports Swift FINplus (over SFTP for now; SOAP will be supported in the next
release).
• We already had a retry mechanism on SFTP for incoming messages and for the delivery of the PDU.
This version adds a retry mechanism for the actual payload when using SFTP. (See Retrying failed
messages (see page 319).)
• Noise canceling: we got rid of a series of warnings in the logs after a clean install.
• Since the LAU is embedded in the XML itself in recent XMLv2 revisions, the binary prefix is no longer
required, so now we turn it off by default. If your SSB wants the prefix, set generatelauprefix to true
(see Local Authentication and LAU key (see page 200)).
• You no longer have to specify the notificationresponderdn and notificationrequesttype when
using isnotificationrequested in a specific profile; the default will be used.
• SFTP connections now allow encrypted passwords in the Camel parameters.
• Vulnerabilities reported by Black Duck made us upgrade to Apache Camel v3.21.0 (CVE-2023-34442)
and Spring Security v5.7.10.

18.34 Summary v2.22.0
2023-07-07
• We released the first iteration of our EBICS 3.0 implementation, covering unattended signing.
• WARNING: SOAP 40connections now require a truststore to secure the HTTPS connection.
• The source reference is now configurable for incoming FileAct messages: an optional parameter
"referenceproperty" allows you to specify which value to use. (See SOAP41 or File Transfer42 for the
full list of supported fields.)
• There is a little less noise in the logs.
• Because of a recent policy change, a few Black Duck OWASP vulnerabilities needed to be addressed
(e.g. we had to upgrade Spring Boot to 2.7.12), and we also fixed a few APT Moderate findings.
• It took us a while to fix this, but a service restart to reflect changes done in the routing table for SOAP
channels is no longer required.
• Another annoying bug we fixed: if the client uses SOAP with a single message partner for FIN and
FileAct, and the FIN channel was started first, an incoming zipped FileAct message fails.

40 https://wiki.fisglobal.com/display/trax/SOAP
41 https://wiki.fisglobal.com/display/trax/SOAP
42 https://wiki.fisglobal.com/display/trax/File+Transfer

Bank Connector change log – 383

Trax – Bank Connector user guide

18.35 Summary v2.21.0
2023-05-25
We included a few performance improvements (faster duplicate check, increased the database connection
pool from 100 to 300).
• The parameter with the lovely descriptive name usepayloadfilenameforpdu is now added to the
sample configuration (with the value "false").
• We improved the way we handle a FIN corner case where the MUR is generated in a backend
application, a message fails, and is then rescheduled in Trax (with the same MUR). When the
response comes in, we will no longer reconcile with the first message, but with the new one.
• Another improvement for clients using SOAP: we will now 'fail fast' when sending fails for some
reason (SAA down, network glitch, etc.), instead of having to wait for the 30' timeout to kick in.

18.36 Summary v2.20.0
2023-05-03
• We gave the b-suffix in our build name a big bump, and went from 518 in v2.19.0 to 230,502,143,731!
(Not really; instead of an unreliable build sequence number, that suffix is now a datetime. This build
was created on May 2nd 2023, at 14:37:31 CEST.)
• Black Duck reported a high risk vulnerability, so we had to upgrade Spring Security to v5.7.8.
• The Messages tab in the GUI should be a lot faster now, especially for clients with high volumes who
like to scroll through a lot of messages.
• Another bug fix, especially needed in production environments: we can now also validate the SAML
signatures in a multiple IdP setup.

18.37 Summary v2.19.0
2023-04-05
• We (finally) found the time to give some TLC to our upgrade process. You no longer have to uninstall
and reinstall a new version, from this version on (and starting from at least v2.11.0) you can upgrade
Bank Connector safely.
• We upgraded Spring in the GUI code now as well.

18.38 Summary v2.18.0
2023-03-30
• We added support for the specific requirements of equensWorldline in previous releases, this one
adds support for Euro-Information (e.g. a strict naming convention for payload and PDU, and the two
files are combined in a specifically named .zip file again).
• You can now use multiple message partners in SOAP channels.

Bank Connector change log – 384

Trax – Bank Connector user guide

• If you insist on using spaces in profile names, we have you covered now.
• Nobody knows how we have been missing this for years, but some banks do not use the available
parameters to distinguish between different request types, and rely on metadata in file names. In the
course of only a week, three clients found out that they needed this. You can now configure
and use filelogicalname as a filter parameter for incoming messages. (And filename as well.)
• Camel was upgraded to v3.20.2, Spring to 5.3.26.
• A few minor bug fixes.

18.39 Summary v2.17.0
2023-03-14
• Patch release to fix a FIN issue, and especially to support FileAct SwCompression for SFTP/
AFT (also for incoming SOAP)
• Two minor GUI bug fixes

18.40 Summary v2.16.0
2023-03-02
• Patch release to cater specific requirements from the equensWorldline SSB and minor bugs that
came up during tests with them

18.41 Summary v2.15.0
2023-02-23
• Mainly a patch release for a defect related to using SOAPHA for both FIN and FileAct.
• In this version we have completely refactored the way we handle a channel timeout: instead of
deciding an outgoing message failed definitively because feedback was not received within the
expected period, and sending a response to Trax, setting the status to a final FAILED state (and
ignoring feedback that may come in later), we now have a Channel timeout status, and we also send
a "Channel timeout" event to Trax, which does nothing, really. In case you miss the old behaviour, you
can also revert to that. (See Channel timeout (see page 324) for all more details.)
• SFTP connections sometimes failed (e.g. in AKS) because of "algorithm negotiation fail": fixed.
• You thought we stopped logging altogether, but it was only the reload button in the Logs tab that no
longer reloaded. Moar logs!

18.42 Summary v2.14.0
2023-02-14
• Mainly patch release for a defect related to dual SSB support: targetprotocol was not sent to Trax for
incoming messages on channels with a "FIN-" or FILEACT-" prefix in the name.

Bank Connector change log – 385

Trax – Bank Connector user guide

• Minor GUI feature: the environment (set during installation) is now displayed next to the user icon.

18.43 Summary v2.13.0
2023-02-03
• XMLv2 now defaults to revision 13.
→ This can be downgraded (“xmlv2revision: 2.0.2” in the channel configuration) and must be
downgraded for ECHOS.
→ Clients using Swift g4C with SOAP need this, because XMLv2.0.2 has no support for the UETR in
the PDU.
• As soon as Trax sends us this JMS parameter, the payload of payments marked as Confidential in
Trax will no longer be displayed in the GUI, even for users with the ‘confidential’ profile assigned.
→ There are now three access levels: users without the profile cannot see any payload, with the
profile they can see the payload, but not if the payment itself was marked confidential (e.g. payroll) in
Trax.
• Anyone (with the ‘logs’ profile assigned) can now download log files from the GUI; you no longer need
to access the server’s file system.
• The installer now installs Artemis v2.27.1 to get rid of CVE-2022-42889 (no risk, but it pops up in
security scans).
• The retry mechanism for incoming messages has been improved.
• The custom attribute /assertion property ‘profiles’ is now case insensitive (in the SAML response
from the IdP).

18.44 Summary v2.12.1
2023-01-06
• Patch release to fix medium OWASP vulnerabilities.

18.45 Summary v2.12.0
2022-12-29
• A new bank API allows us to start with the pilot: Citi real-time balance inquiry (in addition to JPMC
and US Bank).
• We now support multiple channels of the same type (e.g. FIN, FileAct).
→ multiple SSBs can now be configured, with different connection methods.
• The installer now installs Artemis v2.24.0 (default listener port 61617).
• When the custom attribute ‘profiles’ is missing from the SAML response (IdP not completely/
correctly configured yet), instead of an error messages this now has the same result as no profiles
assigned: only the Messages tab can be used.
• Defects related to (large) incoming FileAct/XMLv2 messages were fixed.
• Database initialization improvements: header sent by Trax can be >255; non-Latin characters
(Chinese, Cyrillic, …) displayed correctly.

Bank Connector change log – 386

Trax – Bank Connector user guide

• Configuration improvement: fileinfo is no longer mandatory in FileAct profiles.
• GUI improvement: correct calculation of Data Size (kibibytes, mebibytes, …)

18.46 Summary v2.11.2
2022-11-30
• (Note: There is no v2.11.1, because of a technical glitch.)
• Patch release to fix an issue with incoming FileAct/XMLv2 messages.

18.47 Summary v2.11.0
2022-11-10
• Added SOAP-related alert events (typically used with e-mail notifications).
• Corrected behaviour of the SYSTEMEVENT channel and the scheduler.
• Fixed another bug related to sendNumberOfTransactions when used in FileAct/SOAPHA.

18.48 Summary v2.10.0
2022-10-27
• Improvement of profile routing sequence
• GUI improvement: better processing of Azure AD’s metadata.xml.
• Fixed a bug related to sendNumberOfTransactions in FileAct.

18.49 Summary v2.9.0
2022-09-19
• Added versioning to the configuration schema.
• Default keys (e.g. for the connection to Artemis) are imported during installation.

18.50 Summary v2.8.0
2022-08-19
• The result of several months of seemingly reduced progress: we completely refactored the logic and
structure of the configuration.
• Two bank APIs can be configured (as flexibly as possible) for real-time balance inquiries: JPMC and
US Bank.

Bank Connector change log – 387

Trax – Bank Connector user guide

18.51 Summary v2.7.0
2022-08-16
• Installing Artemis is now optional (when it is already available).
• GUI improvement (for cloud deployments together with Trax): URL now has a …/bankconnector/
context.

18.52 Summary v2.6.1
2022-07-18
• Patch version for a LAU-related defect when using SOAPHA.

18.53 Summary v2.6.0
2022-06-08
• We now accept SWIFT gpi UETR as a routing parameter.
• Who did what when? You can search in the User Activity logs.
• Spring was upgraded to v5.3.20 because of a security risk.

18.54 Summary v2.5.0
2022-05-12
• User Activity logs are available in the GUI for users with the audit profile.

18.55 Summary v2.4.0
2022-04-06
• We introduced a fail fast mechanism to avoid having to wait for a timeout.
• You can activate or deactivate the duplicate check on the application level.

18.56 Summary v2.3.1
2022-03-11
• Patch release to allow IdP-initiated authentication.

Bank Connector change log – 388

Trax – Bank Connector user guide

18.57 Summary v2.3.0
2022-03-03
• Channel stop/start is now cluster-safe: no matter which node's GUI you are on, stopping or starting a
channel there will also stop it on the other nodes.
• Manual retry was not working for RESPONSE FAILED messages, so we fixed that.
• We fixed multiple Black Duck medium vulnerabilities.

18.58 Summary v2.2.0
2022-01-28
• We can handle unexpected messages, and we have duplicate detection for outgoing messages
(coming from Trax).

18.59 Summary v2.1.0
2022-01-11
• Log4j came and conquered the world. We submitted like everyone else.
• Our installer can now also install Artemis ActiveMQ.

18.60 Summary v2.0.0
2021-12-15
• The application formerly known as Trax Communication Gateway or TCG is dead. Long live Bank
Connector and its new GUI (RUF-based, SSO only).

Bank Connector change log – 389

